<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link rel="icon" href="/assets/images/logo.png">

<title>Linux Command Basic | Dalong's personal blog</title>

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Linux Command Basic | Dalong’s personal blog</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Linux Command Basic" />
<meta name="author" content="Dalong" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Linux®是一个开源操作系统（OS）。操作系统是直接管理系统硬件和资源（如 CPU、内存和存储）的软件。操作系统位于应用程序和硬件之间，并在所有软件和执行工作的物理资源之间建立连接。 本文我将详细介绍常用的 Linux 命令行, 帮助大家快速掌握 Linux 的基本服务命令和用法." />
<meta property="og:description" content="Linux®是一个开源操作系统（OS）。操作系统是直接管理系统硬件和资源（如 CPU、内存和存储）的软件。操作系统位于应用程序和硬件之间，并在所有软件和执行工作的物理资源之间建立连接。 本文我将详细介绍常用的 Linux 命令行, 帮助大家快速掌握 Linux 的基本服务命令和用法." />
<link rel="canonical" href="http://localhost:4000/Linux-Command-Basic/" />
<meta property="og:url" content="http://localhost:4000/Linux-Command-Basic/" />
<meta property="og:site_name" content="Dalong’s personal blog" />
<meta property="og:image" content="http://localhost:4000/assets/images/linux.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2015-06-20T00:00:00+08:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Linux Command Basic","dateModified":"2015-06-20T00:00:00+08:00","datePublished":"2015-06-20T00:00:00+08:00","description":"Linux®是一个开源操作系统（OS）。操作系统是直接管理系统硬件和资源（如 CPU、内存和存储）的软件。操作系统位于应用程序和硬件之间，并在所有软件和执行工作的物理资源之间建立连接。 本文我将详细介绍常用的 Linux 命令行, 帮助大家快速掌握 Linux 的基本服务命令和用法.","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/logo.png"},"name":"Dalong"},"image":"http://localhost:4000/assets/images/linux.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/Linux-Command-Basic/"},"url":"http://localhost:4000/Linux-Command-Basic/","author":{"@type":"Person","name":"Dalong"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    
<link href="/assets/css/screen.css" rel="stylesheet">

<link href="/assets/css/main.css" rel="stylesheet">

<script src="/assets/js/jquery.min.js"></script>

</head>




<body class="layout-post">
	<!-- defer loading of font and font awesome -->
	<noscript id="deferred-styles">
		<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
        <link rel="preconnect" href="https://fonts.googleapis.com"> 
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
        <link href="https://fonts.googleapis.com/css2?family=Carter+One&display=swap" rel="stylesheet">
    </noscript>


<!-- Begin Menu Navigation
================================================== -->
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">

    <div class="container pr-0">

    <!-- Begin Logo -->
    <a class="navbar-brand" href="/">
    <img src="/assets/images/logo.png" alt="Dalong's personal blog">
    </a>
    <!-- End Logo -->

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarMediumish">

        <!-- Begin Menu -->

            <ul class="navbar-nav ml-auto">

                
                <li class="nav-item">
                
                <a class="nav-link" href="/index.html">Blog</a>
                </li>

                <li class="nav-item">
                <a class="nav-link" href="/about">About</a>
                </li>

<!-- 以后再加上相关链接

                <li class="nav-item">
                <a target="_blank" class="nav-link" href="https://bootstrapstarter.com/bootstrap-templates/template-mediumish-bootstrap-jekyll/"> Docs</a>
                </li>

                <li class="nav-item">
                <a target="_blank" class="nav-link" href="https://www.wowthemes.net/themes/mediumish-wordpress/"><i class="fab fa-wordpress-simple"></i> WP Version</a>
                </li>

                <li class="nav-item">
                <a target="_blank" class="nav-link" href="https://www.wowthemes.net/themes/mediumish-ghost/"><i class="fab fa-snapchat-ghost"></i> Ghost Version</a>
                </li>
-->
                <li class="nav-item">
                <a target="_blank" class="nav-link" href="https://github.com/dalongli"><i class="fab fa-github"></i> Fork on Github</a>
                </li>

                <script src="/assets/js/lunr.js"></script>


<style>
    .lunrsearchresult .title {color: #d9230f;}
    .lunrsearchresult .url {color: silver;}
    .lunrsearchresult a {display: block; color: #777;}
    .lunrsearchresult a:hover, .lunrsearchresult a:focus {text-decoration: none;}
    .lunrsearchresult a:hover .title {text-decoration: underline;}
</style>


<form class="bd-search" onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
    <input type="text" class="form-control text-small launch-modal-search" id="lunrsearch" name="q" maxlength="255" value="" placeholder="Type and enter..."/>
</form>

<div id="lunrsearchresults">
    <ul></ul>
</div>

<script src="/assets/js/lunrsearchengine.js"></script>

            </ul>

        <!-- End Menu -->

    </div>

    </div>
</nav>
<!-- End Navigation
================================================== -->

<div class="site-content">

<div class="container">

<!-- Site Title
================================================== -->
<div class="mainheading">
    <h1 class="sitetitle">Dalong's personal blog</h1>
    <p class="lead">
        Record the bits and pieces of the technology big bang.
    </p>
</div>

<!-- Content
================================================== -->
<div class="main-content">
    <!-- Begin Article
================================================== -->
<div class="container">
    <div class="row">

        <!-- Post Share -->
        <div class="col-md-2 pl-0">
            <div class="share sticky-top sticky-top-offset">
    <p>
        Share
    </p>
    <ul>
        <li class="ml-1 mr-1">
            <a target="_blank" href="https://twitter.com/intent/tweet?text=Linux Command Basic&url=http://localhost:4000/Linux-Command-Basic/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fab fa-twitter"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://facebook.com/sharer.php?u=http://localhost:4000/Linux-Command-Basic/" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
                <i class="fab fa-facebook-f"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/Linux-Command-Basic/" onclick="window.open(this.href, 'width=550,height=435');return false;">
                <i class="fab fa-linkedin-in"></i>
            </a>
        </li>

    </ul>
    
    <div class="sep">
    </div>
    <ul>
        <li>
        <a class="small smoothscroll" href="#disqus_thread"></a>
        </li>
    </ul>
    
</div>

        </div>

        <!-- Post -->
        

        <div class="col-md-9 flex-first flex-md-unordered">
            <div class="mainheading">

                <!-- Author Box -->
                
                <div class="row post-top-meta">
                    <div class="col-xs-12 col-md-3 col-lg-2 text-center text-md-left mb-4 mb-md-0">
                        
                        <img class="author-thumb" src="/assets/images/avatar_dl.png" alt="Dalong">
                        
                    </div>
                    <div class="col-xs-12 col-md-9 col-lg-10 text-center text-md-left">
                        <a target="_blank" class="link-dark" href="https://dalongli.github.io/about">Dalong</a><a target="_blank" href="https://dalongli.github.io." class="btn follow">Follow</a>
                        <span class="author-description">A profesional technical consultant and blogger.</span>
                    </div>
                </div>
                

                <!-- Post Title -->
                <h1 class="posttitle">Linux Command Basic</h1>

            </div>

            <!-- Adsense if enabled from _config.yml (change your pub id and slot) -->
            
            <!-- End Adsense -->

            <!-- Post Featured Image -->
            

            
            <img class="featured-image img-fluid" src="/assets/images/linux.png" alt="Linux Command Basic">
            

            
            <!-- End Featured Image -->

            <!-- Post Content -->
            <div class="article-post">
                <!-- Toc if any -->
                
                    
                    <div class="toc mt-4 mb-4 lead">
                        <h3 class="font-weight-bold">Summary</h3>
                        <ul>
  <li><a href="#11-linux-基础">11 Linux 基础</a>
    <ul>
      <li><a href="#linux环境安装">linux环境安装</a></li>
      <li><a href="#技巧">技巧</a>
        <ul>
          <li><a href="#快速向文件中追加一行信息">快速向文件中追加一行信息</a></li>
          <li><a href="#快速替换文件中的字符串">快速替换文件中的字符串</a></li>
        </ul>
      </li>
      <li><a href="#常用命令">常用命令</a>
        <ul>
          <li><a href="#info-命令"><code class="language-plaintext highlighter-rouge">info</code> 命令</a></li>
          <li><a href="#whatis-命令"><code class="language-plaintext highlighter-rouge">whatis</code> 命令</a></li>
          <li><a href="#help---help命令"><code class="language-plaintext highlighter-rouge">help</code> <code class="language-plaintext highlighter-rouge">--help</code>命令</a></li>
          <li><a href="#man-命令详解"><code class="language-plaintext highlighter-rouge">man</code> 命令详解</a></li>
          <li><a href="#history-命令"><code class="language-plaintext highlighter-rouge">history</code> 命令</a></li>
        </ul>
      </li>
      <li><a href="#linux-系统介绍">Linux 系统介绍</a>
        <ul>
          <li><a href="#系统启动流程">系统启动流程</a></li>
        </ul>
      </li>
      <li><a href="#目录结构">目录结构</a>
        <ul>
          <li><a href="#文件系统介绍"><strong>文件系统介绍</strong></a></li>
          <li><a href="#linux-文件类型"><strong>linux 文件类型</strong></a></li>
          <li><a href="#目录结构-1"><strong>目录结构</strong></a></li>
          <li><a href="#ls-命令"><code class="language-plaintext highlighter-rouge">ls</code> 命令</a></li>
          <li><a href="#mv-模糊批量移动改名"><code class="language-plaintext highlighter-rouge">mv</code> 模糊批量移动/改名</a></li>
          <li><a href="#其他-命令-touch-rm-cp-mkdir-rmdir">其他 命令 <code class="language-plaintext highlighter-rouge">touch, rm, cp, mkdir, rmdir</code></a></li>
        </ul>
      </li>
      <li><a href="#文件管理">文件管理</a>
        <ul>
          <li><a href="#相关命令-cat-tac-head-tail-nl-wc-more-less">相关命令 <code class="language-plaintext highlighter-rouge">cat, tac, head, tail, nl, wc, more, less</code></a></li>
          <li><a href="#more-和-less使用说明"><code class="language-plaintext highlighter-rouge">more</code> 和 <code class="language-plaintext highlighter-rouge">less</code>使用说明</a></li>
          <li><a href="#vim-命令详解"><code class="language-plaintext highlighter-rouge">vim</code> 命令详解</a></li>
          <li><a href="#链接文件-ln">链接文件 <code class="language-plaintext highlighter-rouge">ln</code></a></li>
          <li><a href="#find-文件查找"><code class="language-plaintext highlighter-rouge">find</code> 文件查找</a></li>
          <li><a href="#which-whereis--命令查找"><code class="language-plaintext highlighter-rouge">which whereis</code>  命令查找</a></li>
          <li><a href="#grep-egrep-正则查找"><code class="language-plaintext highlighter-rouge">grep, egrep</code> 正则查找</a></li>
          <li><a href="#locate-命令"><code class="language-plaintext highlighter-rouge">locate</code> 命令</a></li>
          <li><a href="#文件目录的拥有者-chown">文件/目录的拥有者 <code class="language-plaintext highlighter-rouge">chown</code></a></li>
          <li><a href="#改变文件目录的权限-chown-chmod">改变文件/目录的权限 <code class="language-plaintext highlighter-rouge">chown chmod</code></a></li>
        </ul>
      </li>
      <li><a href="#用户-用户组--用户权限管理">用户, 用户组 , 用户权限管理</a>
        <ul>
          <li><a href="#相关命令-whoami-useradd-userdel-passwd-su----sudo-visudo-groupadd-groupdel-gpasswd-groups-chsh-chown-chgrp-chage-usermod">相关命令 <code class="language-plaintext highlighter-rouge">whoami, useradd, userdel, passwd, su - , sudo, visudo, groupadd, groupdel, gpasswd, groups, chsh, chown, chgrp, chage, usermod</code></a></li>
          <li><a href="#usermod-命令-修改用户信息的最常用命令-包括主目录-所属组-登录shell"><code class="language-plaintext highlighter-rouge">usermod</code> 命令 修改用户信息的最常用命令. 包括主目录, 所属组, 登录shell</a></li>
          <li><a href="#passwd-命令">passwd 命令</a></li>
          <li><a href="#etcpasswd-文件"><code class="language-plaintext highlighter-rouge">/etc/passwd</code> 文件</a></li>
          <li><a href="#设置密码-有效期-和-密码长度-etclogindefs">设置密码 <em>有效期</em> 和 <em>密码长度</em> <code class="language-plaintext highlighter-rouge">/etc/login.defs</code></a></li>
          <li><a href="#设置密码-复杂度-和-密码重设要求-etcpamdsystem-auth">设置密码 <em>复杂度</em> 和 <em>密码重设要求</em> <code class="language-plaintext highlighter-rouge">/etc/pam.d/system-auth</code></a></li>
          <li><a href="#密码输入错误的相关设置-etcpamdpassword-auth--etcpamdlogin">密码输入错误的相关设置 <code class="language-plaintext highlighter-rouge">/etc/pam.d/password-auth</code>  <code class="language-plaintext highlighter-rouge">/etc/pam.d/login</code></a></li>
          <li><a href="#etcshadow-文件"><code class="language-plaintext highlighter-rouge">/etc/shadow</code> 文件</a></li>
        </ul>
      </li>
      <li><a href="#磁盘文件系统管理服务">磁盘/文件系统管理服务</a>
        <ul>
          <li><a href="#fdisk--l--查看系统磁盘分布"><code class="language-plaintext highlighter-rouge">fdisk -l</code> # 查看系统磁盘分布</a></li>
          <li><a href="#mount-挂载的查看和设置命令-用命令"><code class="language-plaintext highlighter-rouge">mount</code> 挂载的查看和设置命令 用命令</a></li>
          <li><a href="#分区-对一个已有的磁盘进行分区-比如-fdisk-devsdb">分区: 对一个已有的磁盘进行分区, 比如 <code class="language-plaintext highlighter-rouge">fdisk /dev/sdb</code></a></li>
          <li><a href="#格式化-mkfs">格式化 <code class="language-plaintext highlighter-rouge">mkfs</code></a></li>
          <li><a href="#查看磁盘使用情况的命令-df--th--du">查看磁盘使用情况的命令 <code class="language-plaintext highlighter-rouge">df -Th</code>  <code class="language-plaintext highlighter-rouge">du</code></a></li>
          <li><a href="#实验-为virtual-box-虚拟机-dalongcentos7-添加新磁盘分区挂载并格式化">实验: 为virtual box 虚拟机 dalongCentOS7 添加新磁盘,分区,挂载并格式化</a></li>
          <li><a href="#磁盘配额-qutas">磁盘配额 qutas</a></li>
          <li><a href="#创建磁盘镜像文件-virtual-block-device-dd-losetup">创建磁盘镜像文件 virtual block device <code class="language-plaintext highlighter-rouge">dd</code> <code class="language-plaintext highlighter-rouge">losetup</code></a></li>
        </ul>
      </li>
      <li><a href="#网络服务">网络服务</a>
        <ul>
          <li><a href="#相关命令-ip-addr--ping-ifup-ifdown-systemctl">相关命令: <code class="language-plaintext highlighter-rouge">ip addr , ping, ifup, ifdown, systemctl</code></a></li>
          <li><a href="#网卡配置文件-etcsysconfignetwork-scriptsifcfg-enp0s3">网卡配置文件: <code class="language-plaintext highlighter-rouge">/etc/sysconfig/network-scripts/ifcfg-enp0s3</code></a></li>
        </ul>
      </li>
      <li><a href="#系统监控">系统监控</a>
        <ul>
          <li><a href="#free"><code class="language-plaintext highlighter-rouge">free</code></a></li>
          <li><a href="#top"><code class="language-plaintext highlighter-rouge">top</code></a></li>
        </ul>
      </li>
      <li><a href="#进程管理">进程管理</a>
        <ul>
          <li><a href="#ps-aux--ps--ef"><code class="language-plaintext highlighter-rouge">ps aux , ps -ef</code></a></li>
        </ul>
      </li>
      <li><a href="#服务管理">服务管理</a>
        <ul>
          <li><a href="#systemctl-命令--老版本是-service-命令"><code class="language-plaintext highlighter-rouge">systemctl</code> 命令 , 老版本是 <code class="language-plaintext highlighter-rouge">service</code> 命令</a></li>
          <li><a href="#centos6的-chkconfig-配置服务启动项">centos6的 <code class="language-plaintext highlighter-rouge">chkconfig</code> 配置服务启动项,</a></li>
        </ul>
      </li>
      <li><a href="#系统安全">系统安全</a>
        <ul>
          <li><a href="#selinux-的使用">selinux 的使用</a></li>
          <li><a href="#防火墙命令--firewall-cmd-firewall-config">防火墙命令  <code class="language-plaintext highlighter-rouge">firewall-cmd</code> <code class="language-plaintext highlighter-rouge">firewall-config</code></a></li>
          <li><a href="#富规则">富规则</a></li>
          <li><a href="#iptables-是防火墙centos6中使用"><code class="language-plaintext highlighter-rouge">iptables</code> 是防火墙(centos6中使用)</a></li>
        </ul>
      </li>
      <li><a href="#远程会话-screen">远程会话 <code class="language-plaintext highlighter-rouge">screen</code></a></li>
      <li><a href="#服务配置软件安装">服务配置/软件安装</a>
        <ul>
          <li><a href="#yum-基本命令-list-installedgrep--check-update-update-search-kw-info-包名-install-remove-clean-all-makecache"><code class="language-plaintext highlighter-rouge">yum</code> 基本命令 <code class="language-plaintext highlighter-rouge">list installed|grep , check-update, update, search kw, info 包名, install, remove, clean all, makecache</code></a></li>
          <li><a href="#为-yum-添加阿里云镜像">为 yum 添加阿里云镜像</a></li>
          <li><a href="#为-yum-添加-网易-镜像">为 yum 添加 网易 镜像</a></li>
          <li><a href="#为-yum-添加-epel-源-ius-源">为 <code class="language-plaintext highlighter-rouge">yum</code> 添加 epel 源 IUS 源</a></li>
          <li><a href="#为-yum-下载加速">为 yum 下载加速</a></li>
          <li><a href="#用yum-安装基础开发环境">用yum 安装基础开发环境</a></li>
          <li><a href="#rpm-包的安装和使用---ivh--uvh--qlp--qip--ql--qf--qagrep"><code class="language-plaintext highlighter-rouge">RPM</code> 包的安装和使用  <code class="language-plaintext highlighter-rouge">-ivh, -Uvh, -qlp, -qip, -ql, -qf, -qa|grep</code></a></li>
          <li><a href="#原码安装-configure--make--make-install--php72-python37安装为例子">原码安装 <code class="language-plaintext highlighter-rouge">.configure,  make,  make install</code>  <code class="language-plaintext highlighter-rouge">PHP7.2 Python3.7安装为例子</code></a></li>
          <li><a href="#压缩解压缩软件-zip-unzip">压缩解压缩软件 <code class="language-plaintext highlighter-rouge">zip unzip</code></a></li>
          <li><a href="#压缩解压缩软件gzipgunzip">压缩解压缩软件<code class="language-plaintext highlighter-rouge">gzip/gunzip</code></a></li>
          <li><a href="#压缩解压缩软件bzip2bunzip2">压缩解压缩软件<code class="language-plaintext highlighter-rouge">bzip2/bunzip2</code></a></li>
          <li><a href="#打包解包-tar--zxvf--zcvf">打包解包 <code class="language-plaintext highlighter-rouge">tar</code> <code class="language-plaintext highlighter-rouge">-zxvf -zcvf</code></a></li>
          <li><a href="#安装桌面环境">安装桌面环境</a></li>
          <li><a href="#mariadb-安装">MariaDB 安装</a></li>
          <li><a href="#mysql-安装--安装了-mariadb-就不需要装-mysql-了">mysql 安装 ( 安装了 MariaDB 就不需要装 mysql 了)</a></li>
          <li><a href="#mongodb-安装">mongodb 安装</a></li>
          <li><a href="#redis-安装">redis 安装</a></li>
          <li><a href="#python36-和-pip36-安装">python3.6 和 pip3.6 安装</a></li>
          <li><a href="#apache-服务安装">Apache 服务安装</a></li>
          <li><a href="#ntp-网络时间同步-chrony">NTP 网络时间同步 <code class="language-plaintext highlighter-rouge">chrony</code></a></li>
          <li><a href="#dns-服务设置-和自己的host">DNS 服务设置 和自己的host</a></li>
          <li><a href="#ssh-登录欢迎信息">ssh 登录欢迎信息</a></li>
          <li><a href="#日志管理及服务-journald">日志管理及服务 journald</a></li>
          <li><a href="#用户管理-useradd-groupadd">用户管理 useradd groupadd</a></li>
          <li><a href="#设置定时任务-cron">设置定时任务 cron</a></li>
          <li><a href="#让系统界面支持中文">让系统界面支持中文</a></li>
          <li><a href="#git-服务配置">git 服务配置</a></li>
          <li><a href="#文件同步-rsync">文件同步 rsync</a></li>
          <li><a href="#nginx-安装">Nginx 安装</a></li>
          <li><a href="#机器学习环境安装">机器学习环境安装</a></li>
        </ul>
      </li>
      <li><a href="#shell-脚本编写">shell 脚本编写</a>
        <ul>
          <li><a href="#升级-bash44">升级 bash4.4</a></li>
          <li><a href="#多个命令写在一行的技巧">多个命令写在一行的技巧</a></li>
          <li><a href="#不要用test-作为文件名">不要用test 作为文件名</a></li>
          <li><a href="#-sha-bang-符号"><code class="language-plaintext highlighter-rouge">#!</code> sha-bang 符号</a></li>
          <li><a href="#注释-">注释 <code class="language-plaintext highlighter-rouge">#</code></a></li>
          <li><a href="#执行-shell-脚本两种方式">执行 Shell 脚本两种方式</a>
            <ul>
              <li><a href="#cd到目录中执行">cd到目录中执行</a></li>
            </ul>
          </li>
          <li><a href="#为脚本创建软链接">为脚本创建软链接</a></li>
          <li><a href="#path-将脚本所在目录添加到环境变量中"><code class="language-plaintext highlighter-rouge">$PATH</code> 将脚本所在目录添加到环境变量中</a></li>
        </ul>
      </li>
      <li><a href="#变量">变量</a>
        <ul>
          <li><a href="#预定义变量-------0-n">预定义变量 <code class="language-plaintext highlighter-rouge">$#, $*, $@, $?, $$, $!, $0, $N</code></a></li>
          <li><a href="#位置变量">位置变量</a></li>
          <li><a href="#环境变量">环境变量</a></li>
          <li><a href="#引号对变量的作用">引号对变量的作用</a></li>
          <li><a href="#用户自定义变量">用户自定义变量</a></li>
          <li><a href="#unset-删除一个变量"><code class="language-plaintext highlighter-rouge">unset</code> 删除一个变量</a></li>
          <li><a href="#read-命令获取用户输入变量值"><code class="language-plaintext highlighter-rouge">read</code> 命令获取用户输入变量值</a></li>
          <li><a href="#alias-定义别名变量"><code class="language-plaintext highlighter-rouge">alias</code> 定义别名变量</a></li>
        </ul>
      </li>
      <li><a href="#文件的描述符和重定向---2--tee">文件的描述符和重定向 <code class="language-plaintext highlighter-rouge">&gt;, &gt;&gt;, 2&gt;, &amp;&gt;, tee</code></a>
        <ul>
          <li><a href="#文件描述符">文件描述符</a></li>
          <li><a href="#输出重定向--">输出重定向 <code class="language-plaintext highlighter-rouge">&gt;</code> <code class="language-plaintext highlighter-rouge">&gt;&gt;</code></a></li>
          <li><a href="#tee-命令-和重定向">tee 命令 和重定向</a></li>
          <li><a href="#多行文本重定向-cat-eof-文件名">多行文本重定向 <code class="language-plaintext highlighter-rouge">cat &lt;&lt;EOF&gt; 文件名</code></a></li>
        </ul>
      </li>
      <li><a href="#下标数组关联数组">下标数组,关联数组</a>
        <ul>
          <li><a href="#下标数组">下标数组:</a></li>
          <li><a href="#关联数组">关联数组:</a></li>
        </ul>
      </li>
      <li><a href="#函数定义执行传参数">函数定义,执行,传参数</a>
        <ul>
          <li><a href="#定义和调用函数"><em>定义和调用函数</em></a></li>
          <li><a href="#定义全局变量-局部变量-并获得返回值"><em>定义全局变量, 局部变量, 并获得返回值</em></a></li>
          <li><a href="#为函数传递参数"><em>为函数传递参数</em></a></li>
        </ul>
      </li>
      <li><a href="#条件测试-test-与-流程控制-if-else">条件测试 <code class="language-plaintext highlighter-rouge">test</code> 与 流程控制 <code class="language-plaintext highlighter-rouge">if else</code></a>
        <ul>
          <li><a href="#关于真值-true-false">关于真值 <code class="language-plaintext highlighter-rouge">true false</code></a></li>
          <li><a href="#常用测试操作-test--条件表达式-">常用测试操作 <code class="language-plaintext highlighter-rouge">test</code> <code class="language-plaintext highlighter-rouge">[ 条件表达式 ]</code></a></li>
          <li><a href="#测试文件状态">测试文件状态</a></li>
          <li><a href="#字符串的比较">字符串的比较</a></li>
          <li><a href="#整数值的比较">整数值的比较</a></li>
        </ul>
      </li>
      <li><a href="#逻辑运算符--a---o--">逻辑运算符 <code class="language-plaintext highlighter-rouge">-a, &amp;&amp;, -o, ||, !</code></a>
        <ul>
          <li><a href="#if-条件语句">if 条件语句</a></li>
          <li><a href="#for-循环">for 循环</a></li>
          <li><a href="#while-循环">while 循环</a></li>
          <li><a href="#until循环语句">until循环语句</a></li>
          <li><a href="#循环控制语句--break-continue">循环控制语句  <code class="language-plaintext highlighter-rouge">break, continue</code></a></li>
          <li><a href="#case-多重分支">case 多重分支</a></li>
          <li><a href="#shift-命令弹出第一个脚本参数"><code class="language-plaintext highlighter-rouge">shift</code> 命令弹出第一个脚本参数</a></li>
          <li><a href="#exit-无条件终止退出脚本">exit 无条件终止(退出)脚本</a></li>
        </ul>
      </li>
      <li><a href="#初始化-centos7-的shell-脚本实例20">初始化 Centos7 的SHELL 脚本实例2.0</a></li>
    </ul>
  </li>
</ul>
                    </div>
                
                <!-- End Toc -->
                <p>Linux®是一个开源操作系统（OS）。操作系统是直接管理系统硬件和资源（如 CPU、内存和存储）的软件。操作系统位于应用程序和硬件之间，并在所有软件和执行工作的物理资源之间建立连接。 本文我将详细介绍常用的 Linux 命令行, 帮助大家快速掌握 Linux 的基本服务命令和用法.</p>

<h1 id="11-linux-基础">11 Linux 基础</h1>

<p>[TOC]</p>

<p><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/index">redhat7 系统管理员手册</a></p>

<h2 id="linux环境安装">linux环境安装</h2>

<p><a href="https://www.centos.org/docs/">官方文档</a></p>

<p>(1)安装 VirtualBox 虚拟环境 5.1.18</p>

<p>(2)安装 CentOS mini发行版 <code class="language-plaintext highlighter-rouge">CentOS-6.8-x86_64-minimal.iso</code></p>

<ul>
  <li>用户名:root</li>
  <li>密码:@moyu<em>**</em>I</li>
</ul>

<p>(3)配置VirtualBox 网络:</p>

<ul>
  <li>进入 setting-&gt;Network</li>
  <li>Attached to: 设置Bridge Adapter</li>
  <li>Name : en5 (这里面要看你现在用的电脑选的是哪个网络上网, 这里就选哪个网络)</li>
</ul>

<p>(4)配置 CentOS 网络并重启</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">vi /etc/sysconfig/network-scripts/ifcfg-enp0s3</code></p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="nv">ONBOOT</span><span class="o">=</span>yes
</pre></td></tr></tbody></table>
</div>
    </div>
  </li>
  <li>
    <p>systemctl restart network</p>
  </li>
  <li>
    <p>ping www.baidu.com</p>
  </li>
</ul>

<p>(5)ssh 从 Mac 远程连接CentOS</p>

<ul>
  <li>
    <p>先查看 CentOS 服务器的内网 IP地址</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>ip addr
</pre></td></tr></tbody></table>
</div>
    </div>

    <p>可以看到 enp0s3 的 inet 是 10.11.56.71</p>
  </li>
  <li>
    <p>Mac 上运行 ssh 命令连接</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>ssh root@10.11.56.71
</pre></td></tr></tbody></table>
</div>
    </div>
  </li>
</ul>

<h2 id="技巧">技巧</h2>

<h3 id="快速向文件中追加一行信息">快速向文件中追加一行信息</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="nb">echo</span> <span class="s2">"This_is_an_errorline"</span> &gt;&gt; /root/tmp/test.vim
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="快速替换文件中的字符串">快速替换文件中的字符串</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>sed -i <span class="s1">'s/This_is_an_errorline//g'</span> /root/tmp/test.vim
</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="常用命令">常用命令</h2>

<p><a href="https://access.redhat.com/articles/1189123">redhat 7,6,5 常用命令对比</a></p>

<p><img src="/Users/dalong/Library/Mobile Documents/com~apple~CloudDocs/python1702笔记/rhel_5_6_7_commands.jpg" alt="rhel_5_6_7_commands" /></p>

<h3 id="info-命令"><code class="language-plaintext highlighter-rouge">info</code> 命令</h3>

<p><a href="http://man.linuxde.net/info">用法</a></p>

<p>就内容来说，info页面比<a href="http://man.linuxde.net/man">man</a> page编写得要更好、更容易理解，也更友好，但man page使用起来确实要更容易得多。一个man page只有一页，而info页面几乎总是将它们的内容组织成多个区段（称为节点），每个区段也可能包含子区段（称为子节点）。</p>

<p>快捷键:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10</pre></td><td class="code"><pre>?键：它就会显示info的常用快捷键。
N键：显示（相对于本节点的）下一节点的文档内容。
P键：显示（相对于本节点的）前一节点的文档内容。
U键：进入当前命令所在的主题。
M键：敲M键后输入命令的名称就可以查看该命令的帮助文档了。
G键：敲G键后输入主题名称，进入该主题。
L键：回到上一个访问的页面。
SPACE键：向前滚动一页。
BACKUP或DEL键：向后滚动一页。
Q：退出info。
</pre></td></tr></tbody></table>
</div>
</div>

<p>命令:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></td><td class="code"><pre>？     显示帮助窗口

在帮助窗口中：
Ctrl-x 0          关闭帮助窗口
Ctrl-x Ctrl-c    关闭整个 Info
        
q      退出 info
n      打开与本 Node 关联的下一个 Node
p      打开与本 Node 关联的前一个 Node
u      打开与本 Node 关联的上一个 Node
l      回到上一次访问的 Node
m或g   选择一个菜单项（Node 的名字）
       输入指定菜单的名字后按回车，打开指定菜单项关联的 Node
空格键 下一页（PageDown 也可以，下一页从当前页的最后两行开始算起）
       下一个 Node （若当前页在 Node 文档的末尾）
Del 键 上一页（PageUp 也可以，上一页从当前页的开始两行开始算起）
       上一个 Node （若当前页 Node 文档的开始）

b 或 t 或 Home   文档的开始（b 是 begining 的意思）
e 或 End         文档的末尾（b 是 ending 的意思）
Ctrl-l    刷新当前页，若当前文档显示情况有问题时
Ctrl-g    取消所键入的指令
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="whatis-命令"><code class="language-plaintext highlighter-rouge">whatis</code> 命令</h3>

<p>可以用于处理任何不懂的命令, 配置文件等. 会返回简单的描述和常看详细解释的途径.</p>

<p>在 man 一个命令之前, 最好先 whatis 一下</p>

<p>相当于 <code class="language-plaintext highlighter-rouge">man -f 搜索关键字</code></p>

<p><em>查看什么是 systemctl</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>whatis systemctl
<span class="c"># systemctl (1)        - Control the systemd system and service manager</span>
<span class="c"># 然后就可以用 man 1 syxtemctl 去查看更详细信息了</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="help---help命令"><code class="language-plaintext highlighter-rouge">help</code> <code class="language-plaintext highlighter-rouge">--help</code>命令</h3>

<p><code class="language-plaintext highlighter-rouge">help</code>命令用于显示shell内部命令(就是 shell 编程语言中用的命令)的帮助信息。</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">help</code> 不加参数可以查看所有shell 内部命令</p>
  </li>
  <li>
    <p>而对于外部命令的帮助信息只能使用<a href="http://man.linuxde.net/man">man</a>或者<a href="http://man.linuxde.net/info">info</a>命令查看。</p>

    <p>​</p>
  </li>
</ul>

<p><code class="language-plaintext highlighter-rouge">--help</code></p>

<ul>
  <li>任何命令后面接 –help 可以获得该命令的基本使用方法的帮助信息</li>
</ul>

<h3 id="man-命令详解"><code class="language-plaintext highlighter-rouge">man</code> 命令详解</h3>

<p><a href="https://www.cnblogs.com/ls0823/p/7010366.html">man命令详解</a></p>

<p><em>因为centos 7 的 man 命令补全, 很多 man 5 都没有, 需要先安装扩展包</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>yum install man-pages
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>man 最有用的两个参数</em></p>

<blockquote>
  <p>-a: 在所有手册中查找相关内容</p>

  <p>-k: 模糊查找想要找的内容</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>man -a system.cong <span class="c"># 在所有帮助文档中查找这个关键字</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>man [数字] 目标内容</em> 数字的含义</p>

<table>
  <thead>
    <tr>
      <th><strong>章节</strong></th>
      <th><strong>功能</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>标准用户命令（Executable programs or shell commands）</td>
    </tr>
    <tr>
      <td>2</td>
      <td>系统调用（System calls）functions provided by the kernel</td>
    </tr>
    <tr>
      <td>3</td>
      <td>库调用（Library call）functions within program libraries</td>
    </tr>
    <tr>
      <td>4</td>
      <td>特殊文件（设备文件）的访问入口（/dev）Special files (usually found in /dev)</td>
    </tr>
    <tr>
      <td>5</td>
      <td>文件格式（配置文件的语法），指定程序的运行特性 File formats and conventions</td>
    </tr>
    <tr>
      <td>6</td>
      <td>游戏（Games）</td>
    </tr>
    <tr>
      <td>7</td>
      <td>杂项（Miscellaneous）including macro packages and conventions</td>
    </tr>
    <tr>
      <td>8</td>
      <td>管理命令 System administration commands</td>
    </tr>
    <tr>
      <td>9</td>
      <td>跟kernel有关的文件 Kernel routines</td>
    </tr>
  </tbody>
</table>

<h3 id="history-命令"><code class="language-plaintext highlighter-rouge">history</code> 命令</h3>

<p><a href="http://www.linuxidc.com/Linux/2015-05/117774.htm">详细的说明</a></p>

<p><code class="language-plaintext highlighter-rouge">history</code> 查看历史命令</p>

<p><code class="language-plaintext highlighter-rouge">!745</code> 执行历史的第745条命令</p>

<p><code class="language-plaintext highlighter-rouge">!-1</code>  执行上一条命令 , 数字可以是更多</p>

<p><code class="language-plaintext highlighter-rouge">!$</code> 上条命令的参数 . <code class="language-plaintext highlighter-rouge">!$</code> 符号可以将上一条命令的参数传递给下一条命令参数：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>mkdir /home/test
<span class="nb">cd</span> !<span class="nv">$ </span> <span class="c"># 进入/home/test 目录</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><code class="language-plaintext highlighter-rouge">!cp:1</code> 可以获取上一个 cp 命令的第一个参数 , 2 就是第二个参数了</p>

<h2 id="linux-系统介绍">Linux 系统介绍</h2>

<h3 id="系统启动流程">系统启动流程</h3>

<ul>
  <li>(1)基本输入输出系统(BIOS)
    <ul>
      <li>上电之后系统基本硬件自检</li>
    </ul>
  </li>
  <li>(2)主引导分区(MBR)
    <ul>
      <li>启动引导分区, 系统从哪里驱动的代码(boot loader)</li>
    </ul>
  </li>
  <li>(3)启动引导代码(boot loader)
    <ul>
      <li>在操作系统运行之前执行的一段代码</li>
      <li>负责将系统的软硬件带入到合适的运行环境中.</li>
      <li>因为操作系统是运行在内存中的, 这段代码就是为了将早做系统放入内存之前做准备的.</li>
    </ul>
  </li>
  <li>(4)操作系统(OS)
    <ul>
      <li>操作系统启动后执行的第一个进程-守护进程  <code class="language-plaintext highlighter-rouge">/sbin/init</code></li>
      <li>这个文件做了很多初始化的工作
        <ul>
          <li><code class="language-plaintext highlighter-rouge">/etc/inittab</code>  该文件标识了系统启动运行的级别. 根据运行级别完成后续相关初始化操作.</li>
          <li>centOS7 只有两个运行级别
            <ul>
              <li>multi-user.target : 相当于 runlevel 3</li>
              <li>graphical.target: 向东与 runlevel 5</li>
              <li><code class="language-plaintext highlighter-rouge">systemctl get-default</code> 是获取当前运行级别</li>
              <li><code class="language-plaintext highlighter-rouge">systemctl set-default graphical.target</code> 设置当前默认运行级别为 图形化.</li>
            </ul>
          </li>
          <li>centOS6运行级别如下:
            <ul>
              <li>#   0 - halt (Do NOT set initdefault to this) 关机</li>
              <li>#   1 - Single user mode</li>
              <li>#   2 - Multiuser, without NFS (The same as 3, if you do not have networking)</li>
              <li>#   3 - Full multiuser mode</li>
              <li>#   4 - unused</li>
              <li>#   5 - X11</li>
              <li>#   6 - reboot (Do NOT set initdefault to this)</li>
              <li>id:3:initdefault:  默认</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>(5)执行系统执行初始化脚本
    <ul>
      <li><code class="language-plaintext highlighter-rouge">/etc/rc.d/</code> 有多个脚本文件, rc0.d ~ rc6.d 分别代表了不同即启动级别的运行脚本. 默认执行 <code class="language-plaintext highlighter-rouge">rc.sysinit</code></li>
      <li><code class="language-plaintext highlighter-rouge">/etc/rc.d/rc.sysinit</code> 系统初始化脚本文件</li>
      <li><code class="language-plaintext highlighter-rouge">/etc/rc.d/rc.local</code> 是最后留给用户的自定义初始化脚本. 用户可以在文件中编辑自己要执行的初始化操作</li>
    </ul>
  </li>
  <li>(6)用户登录界面
    <ul>
      <li>桌面环境: GNOME, KDE</li>
      <li>终端: bash</li>
    </ul>
  </li>
</ul>

<h2 id="目录结构">目录结构</h2>

<h3 id="文件系统介绍"><strong>文件系统介绍</strong></h3>

<blockquote>
  <p>文件系统是操作系统用来管理存储设备或分区上的文件的方法和数据结构</p>

  <p>操作系统中管理和存储文件信息的阮籍机构叫做文件管理系统. 简称文件系统</p>
</blockquote>

<ul>
  <li>fat16(MS-DOS 6.x) 分区最大2G</li>
  <li>fat32(windows 95) 分区最大4G, 性能弱,容易产生碎片.</li>
  <li>ntfs(windows NT) 提升 fat 32稳定性, 最大单个文件无限制</li>
  <li>ext4(linux) 扩展型日志文件系统</li>
  <li>hfs+(Mac) 苹果文件系统</li>
  <li>exfat(win/mac). 可以支持4G 以上的单个文件, 适合闪存.</li>
  <li>xfs (linux) centOS 7 采用 xfs 文件系统.
    <ul>
      <li>Ext4受限制于磁盘结构和兼容问题，可扩展性和scalability确实不如XFS，另外XFS经过很多年发展，各种锁的细化做的也比较好.</li>
      <li>XFS使用64位管理空间，文件系统规模可以达到EB级别，可以说未来几年XFS彻底取代Ext4是早晚的事情！</li>
    </ul>
  </li>
</ul>

<h3 id="linux-文件类型"><strong>linux 文件类型</strong></h3>

<blockquote>
  <p>LINUX有四种基本文件系统类型：普通文件、目录文件、连接文件和特殊文件，可用<code class="language-plaintext highlighter-rouge">file</code>命令来识别。</p>
</blockquote>

<ul>
  <li><em>普通文件(-)</em>：如文本文件、C语言元代码、SHELL脚本、二进制的可执行文件等，可用cat、less、more、vi、emacs来察看内容，用mv来改名。</li>
  <li><em>目录文件(d)</em>：包括文件名、子目录名及其指针。它是LINUX储存文件名的唯一地方，可用ls列出目录文件。</li>
  <li><em>连接文件(l)</em>：是指向同一索引节点的那些目录条目。用ls来查看是，连接文件的标志用l开头，而文件面后以”-&gt;”指向所连接的文件。</li>
  <li><em>特殊文件(d,c,)</em>：LINUX的一些设备如磁盘、终端、打印机等都在文件系统中表示出来，则一类文件就是特殊文件，常放在/dev目录内。例如，软驱A称为/dev/fd0。LINUX无C：的概念，而是用/dev/had来自第一硬盘。</li>
</ul>

<h3 id="目录结构-1"><strong>目录结构</strong></h3>

<blockquote>
  <p><a href="http://blog.csdn.net/longxu0872/article/details/71168340">详细介绍</a></p>
</blockquote>

<p><code class="language-plaintext highlighter-rouge">cd / &amp;&amp; ls -lo</code></p>

<table>
  <thead>
    <tr>
      <th>目录</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>/</td>
      <td>根目录。对你的电脑来说，有且只有一个根目录。所有的东西，我是说所有的东西都是从这里开始。举个例子：当你在终端里输入“/home”，你其实是在告诉电脑，先从/(根目录)开始，再进入到home目录。</td>
    </tr>
    <tr>
      <td>/bin</td>
      <td>这里存放了标准的(或者说是缺省的)linux的工具，比如像“ls”、“vi”还有“more”等等。通常来说，这个目录已经包含在你的“path”系 统变量里面了。什么意思呢?就是：当你在终端里输入ls，系统就会去/bin目录下面查找是不是有ls这个程序。</td>
    </tr>
    <tr>
      <td>/sbin</td>
      <td>大多是涉及系统管理的命令的存放，是超级权限用户root的可执行命令存放地，普通用户无权限执行这个目录下的命令，这个目录和/usr/sbin; /usr/X11R6/sbin或/usr/local/sbin目录是相似的；我们记住就行了，凡是目录sbin中包含的都是root权限才能执行的。</td>
    </tr>
    <tr>
      <td>/boot</td>
      <td>Linux的内核及引导系统程序所需要的文件目录，比如 vmlinuz initrd.img 文件都位于这个目录中。在一般情况下，GRUB或LILO系统引导管理器也位于这个目录</td>
    </tr>
    <tr>
      <td>/dev</td>
      <td>这里主要存放与设备(包括外设)有关的文件(unix和linux系统均把设备当成文件)。想连线打印机吗?系统就是从这个目录开始工作的。另外还有一些包括磁盘驱动、USB驱动等都放在这个目录</td>
    </tr>
    <tr>
      <td>/etc</td>
      <td>这里主要存放了系统配置方面的文件。举个例子：你安装了samba这个套件，当你想要修改samba配置文件的时候，你会发现它们(配置文件)就在/etc/samba目录下。</td>
    </tr>
    <tr>
      <td>/home</td>
      <td>这里主要存放你的个人数据。具体每个用户的设置文件，用户的桌面文件夹，还有用户的数据都放在这里。每个用户都有自己的用户目录，位置为：/home/用户名。当然，root用户除外。</td>
    </tr>
    <tr>
      <td>/root</td>
      <td>这是系统管理员(root user)的目录。对于系统来说，系统管理员就好比是上帝，它能对系统做任何事情，甚至包括删除你的文件。因此，请小心使用root帐号。</td>
    </tr>
    <tr>
      <td>/run</td>
      <td>运行时应用使用的临时目录</td>
    </tr>
    <tr>
      <td>/lib</td>
      <td>库文件</td>
    </tr>
    <tr>
      <td>/lib64</td>
      <td>64位库文件</td>
    </tr>
    <tr>
      <td>/lost+found</td>
      <td>出现异常时保存信息,以便恢复时使用</td>
    </tr>
    <tr>
      <td>/media</td>
      <td>有些linux的发行版使用这个目录来挂载那些usb接口的移动硬盘(包括U盘)、CD/DVD驱动器等等。</td>
    </tr>
    <tr>
      <td>/mnt</td>
      <td>mount.  这个目录一般是用于存放挂载储存设备的挂载目录的，比如有cdrom 等目录。可以参看/etc/fstab的定义。有时我们可以把让系统开机自动挂载文件系统，把挂载点放在这里也是可以的。主要看/etc/fstab中怎 么定义了；比如光驱可以挂载到/mnt/cdrom 。</td>
    </tr>
    <tr>
      <td>/opt</td>
      <td>option.  这里主要存放那些可选的程序。你想尝试最新的firefox测试版吗?那就装到/opt目录下吧，这样，当你尝试完，想删掉firefox的时候，你就可 以直接删除它，而不影响系统其他任何设置。安装到/opt目录下的程序，它所有的数据、库文件等等都是放在同个目录下面。</td>
    </tr>
    <tr>
      <td>/proc</td>
      <td>进程信息, 是一个虚拟的文件系统.  操作系统运行时，进程信息及内核信息（比如cpu、硬盘分区、内存信息等）存放在这里。/proc目录伪装的文件系统proc的挂载目录，proc并不是真正的文件系统</td>
    </tr>
    <tr>
      <td>/srv</td>
      <td>service  srv代表服务。包含服务器特定服务相关的数据。例如，/srv/cvs包含cvs相关的数据。</td>
    </tr>
    <tr>
      <td>/sys</td>
      <td>system 类似 proc, 也是虚拟文件系统, 用于映射内核信息</td>
    </tr>
    <tr>
      <td>/tmp</td>
      <td>这是临时目录。对于某些程序来说，有些文件被用了一次两次之后，就不会再被用到，像这样的文件就放在这里。有些linux系统会定期自动对这个目录进行清理，因此，千万不要把重要的数据放在这里</td>
    </tr>
    <tr>
      <td>/usr</td>
      <td>unix system resource 的缩写.  在这个目录下，你可以找到那些不适合放在/bin或/etc目录下的额外的工具。比如像游戏阿，一些打印工具拉等等。/usr目录包含了许多子目录： /usr/bin目录用于存放程序;/usr/share用于存放一些共享的数据，比如音乐文件或者图标等等;/usr/lib目录用于存放那些不能直接 运行的，但却是许多程序运行所必需的一些函数库文件。</td>
    </tr>
    <tr>
      <td>/usr/local</td>
      <td>这里主要存放那些手动安装的软件，即不是通过“新立得”或apt-get安装的软件。它和/usr目录具有相类似的目录结构。让软件包管理器来管理/usr目录，而把自定义的脚本(scripts)放到/usr/local目录下面，我想这应该是个不错的主意。</td>
    </tr>
    <tr>
      <td>/var</td>
      <td>系统自动产生的,不会自动销毁的文件, 比如日志, 邮件等.  这个目录的内容是经常变动的，看名字就知道，我们可以理解为vary的缩写，/var下有/var/log 这是用来存放系统日志的目录。/var/www目录是定义Apache服务器站点存放目录；/var/lib 用来存放一些库文件，比如MySQL的，以及MySQL数据库的的存放地</td>
    </tr>
  </tbody>
</table>

<h3 id="ls-命令"><code class="language-plaintext highlighter-rouge">ls</code> 命令</h3>

<p><code class="language-plaintext highlighter-rouge">-lah</code> 列表形式显示所有文件, 文件大小显示单位</p>

<p>文件类型:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13</pre></td><td class="code"><pre>-: 普通文件

d: 目录

l: 软链接

c: 字符设备

b: 块设备

s: socket 套接字文件

p: 管道文件
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="mv-模糊批量移动改名"><code class="language-plaintext highlighter-rouge">mv</code> 模糊批量移动/改名</h3>

<p>批量将当前目录下的以file 开头,一位数字,结尾是.py .sh .pl 的文件移动到 subdir中</p>

<ul>
  <li>注意 要用 egrep 才好用.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>mv <span class="sb">`</span>ls |egrep <span class="s1">'^file[0-9]\.(py|sh|pl)'</span><span class="sb">`</span> ./subdir/
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="其他-命令-touch-rm-cp-mkdir-rmdir">其他 命令 <code class="language-plaintext highlighter-rouge">touch, rm, cp, mkdir, rmdir</code></h3>

<ul>
  <li>
    <p>相关命令</p>

    <table>
      <thead>
        <tr>
          <th>命令</th>
          <th>说明</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>touch</td>
          <td>创建新文件(可以一次性创建多个)</td>
        </tr>
        <tr>
          <td>rm</td>
          <td>删除文件或目录(目录需要添加’-r’)</td>
        </tr>
        <tr>
          <td>cp</td>
          <td>拷贝文件或目录(目录需要添加’-r’)</td>
        </tr>
        <tr>
          <td>mkdir</td>
          <td>创建目录(可以一次性创建多个)</td>
        </tr>
        <tr>
          <td>rmdir</td>
          <td>删除空目录,</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>选项说明</p>

    <ul>
      <li>-f：表示强制操作</li>
      <li>-r：表示递归操作</li>
      <li>*：表示模糊匹配，如：rm -f *.c，删除所有的.c文件</li>
      <li>-p：创建中间目录时需要添加</li>
    </ul>
  </li>
</ul>

<h2 id="文件管理">文件管理</h2>

<h3 id="相关命令-cat-tac-head-tail-nl-wc-more-less">相关命令 <code class="language-plaintext highlighter-rouge">cat, tac, head, tail, nl, wc, more, less</code></h3>

<table>
  <thead>
    <tr>
      <th>命令</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cat</td>
      <td>从上到下，将文件所有内容全部展示出来</td>
    </tr>
    <tr>
      <td>tac</td>
      <td>从下到上，将文件所有内容全部展示出来</td>
    </tr>
    <tr>
      <td>head</td>
      <td>显示文件开头的几行内容，默认10行，可以指定，如：head -3 1.txt</td>
    </tr>
    <tr>
      <td>tail</td>
      <td>显示文件末尾的几行内容，默认10行，可以指定，如：tail -3 1.txt</td>
    </tr>
    <tr>
      <td>nl</td>
      <td>功能同cat，多显示了行号</td>
    </tr>
    <tr>
      <td>wc</td>
      <td>统计显示，内容：行数 单词数 字符数 文件名</td>
    </tr>
    <tr>
      <td>more</td>
      <td>一点一点查看内容</td>
    </tr>
    <tr>
      <td>less</td>
      <td>一点一点查看内容</td>
    </tr>
  </tbody>
</table>

<h3 id="more-和-less使用说明"><code class="language-plaintext highlighter-rouge">more</code> 和 <code class="language-plaintext highlighter-rouge">less</code>使用说明</h3>

<ul>
  <li>内容显示一屏就会停止</li>
  <li>q可以退出查看</li>
  <li>enter向下翻一行</li>
  <li>空格向下翻一页</li>
  <li>more查看到末尾会自动退出，less不会</li>
  <li>less可以上下按钮上下翻看，more不可以</li>
  <li>经常结合管道使用，如：<code class="language-plaintext highlighter-rouge">ls /etc | more</code></li>
</ul>

<h3 id="vim-命令详解"><code class="language-plaintext highlighter-rouge">vim</code> 命令详解</h3>

<p>简介: vi 是默认终端编辑器, 后来有了vim, 是加强版的vi.</p>

<p><code class="language-plaintext highlighter-rouge">yum install vim</code> 先安装 vim</p>

<p><code class="language-plaintext highlighter-rouge">vimtutor</code> 查看 vim 手册</p>

<p><code class="language-plaintext highlighter-rouge">vim ~/.vimrc</code>  按喜好配置</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>:set nu
:set <span class="nv">tabstop</span><span class="o">=</span>4
:set <span class="nv">mouse</span><span class="o">=</span>a
</pre></td></tr></tbody></table>
</div>
</div>

<p><code class="language-plaintext highlighter-rouge">resource ~/vimrc</code> 让编辑的配置立即生效</p>

<p><img src="/Users/dalong/Library/Mobile Documents/com~apple~CloudDocs/python1702笔记/20160907133419436.gif" alt="20160907133419436" /></p>

<p><strong>分屏模式</strong></p>

<blockquote>
  <p><a href="https://www.cnblogs.com/manziluo/p/5789700.html">更详细的解释</a></p>

  <p><code class="language-plaintext highlighter-rouge">:vsp</code> 左右分屏</p>

  <p><code class="language-plaintext highlighter-rouge">:sp</code> 上下分屏</p>

  <p><code class="language-plaintext highlighter-rouge">:vsp 文件名</code> 在现有文件基础上增加一个文件的分屏</p>

  <p><code class="language-plaintext highlighter-rouge">control + w + w</code> 在分屏间切换</p>

  <p><code class="language-plaintext highlighter-rouge">:only</code> 关闭其他分屏</p>
</blockquote>

<p>编辑模式</p>

<table>
  <thead>
    <tr>
      <th>操作__<strong>__</strong><strong>__</strong>__</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>h j k l</td>
      <td>移动光标 <code class="language-plaintext highlighter-rouge">h j k l</code></td>
    </tr>
    <tr>
      <td>fn + 上/下  或者 control + f/b</td>
      <td>翻页</td>
    </tr>
    <tr>
      <td>ESC</td>
      <td>结束编辑 <code class="language-plaintext highlighter-rouge">ESC</code></td>
    </tr>
    <tr>
      <td>x  X  5x 5X</td>
      <td>向左/向右删除字符 , 设定删除n个字符</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>i a A</td>
      <td>光标处插入字符 <code class="language-plaintext highlighter-rouge">i</code> , 光标下一个位置插入字符 <code class="language-plaintext highlighter-rouge">a</code> , 行尾插入 <code class="language-plaintext highlighter-rouge">A</code></td>
    </tr>
    <tr>
      <td>O o</td>
      <td>光标上面插入空行 <code class="language-plaintext highlighter-rouge">O</code>, 光标下面插入空行 <code class="language-plaintext highlighter-rouge">o</code></td>
    </tr>
    <tr>
      <td>dw d2w de</td>
      <td>删除单词 <code class="language-plaintext highlighter-rouge">dw</code>  删除两个单词 <code class="language-plaintext highlighter-rouge">d2w</code> 删除到当前单词末尾 <code class="language-plaintext highlighter-rouge">de</code></td>
    </tr>
    <tr>
      <td>d^ d$ dd 10dd</td>
      <td>删除到行位 <code class="language-plaintext highlighter-rouge">d$</code>  删除到行头 <code class="language-plaintext highlighter-rouge">d^</code>  删除整行 <code class="language-plaintext highlighter-rouge">dd</code>  删除多行 <code class="language-plaintext highlighter-rouge">2dd</code></td>
    </tr>
    <tr>
      <td>u U control+r</td>
      <td>取消修改 <code class="language-plaintext highlighter-rouge">u</code> , 回复本行原始状态 <code class="language-plaintext highlighter-rouge">U</code> .  重做撤销 <code class="language-plaintext highlighter-rouge">control + r</code></td>
    </tr>
    <tr>
      <td>w e</td>
      <td>向后移动到下一个单词 <code class="language-plaintext highlighter-rouge">w</code> 向后移动到单词尾部 <code class="language-plaintext highlighter-rouge">e</code></td>
    </tr>
    <tr>
      <td>0 ^ $</td>
      <td>移动到行头 <code class="language-plaintext highlighter-rouge">0</code> <code class="language-plaintext highlighter-rouge">^</code>, 移动到行尾 <code class="language-plaintext highlighter-rouge">$</code></td>
    </tr>
    <tr>
      <td>y yw yy 10yy p</td>
      <td>复制字母或赋值高亮选中<code class="language-plaintext highlighter-rouge">y</code> ,复制到单词尾<code class="language-plaintext highlighter-rouge">yw</code> , 复制整行<code class="language-plaintext highlighter-rouge">yy</code>,  复制10行<code class="language-plaintext highlighter-rouge">10yy</code>,  黏贴 <code class="language-plaintext highlighter-rouge">p</code></td>
    </tr>
    <tr>
      <td>p P dd</td>
      <td>粘贴 <code class="language-plaintext highlighter-rouge">p</code> 将最后一次删除的内容黏贴到当前光标的下一行; <code class="language-plaintext highlighter-rouge">P</code> 是放在光标上一行 <code class="language-plaintext highlighter-rouge">p</code> 和 <code class="language-plaintext highlighter-rouge">dd</code> 经常联合使用</td>
    </tr>
    <tr>
      <td>r</td>
      <td>替换字母 <code class="language-plaintext highlighter-rouge">r</code> 然后输入想要替换的字母;  只能替换英文字母,而且一次 <code class="language-plaintext highlighter-rouge">r</code> 只能替换一次字母.</td>
    </tr>
    <tr>
      <td>R</td>
      <td>进入替换模式 <code class="language-plaintext highlighter-rouge">R</code> , 直到 ESC 位置</td>
    </tr>
    <tr>
      <td>ce c$ de</td>
      <td>更改到当前单词末尾 <code class="language-plaintext highlighter-rouge">ce</code>  更改到行尾 <code class="language-plaintext highlighter-rouge">c$</code> ; <code class="language-plaintext highlighter-rouge">ce</code> 比 <code class="language-plaintext highlighter-rouge">de</code> 多了一个 插入模式</td>
    </tr>
    <tr>
      <td>gg 100gg G</td>
      <td>跳到文章头 <code class="language-plaintext highlighter-rouge">gg</code> , 跳到文章尾 <code class="language-plaintext highlighter-rouge">G</code> ,  跳到指定行 <code class="language-plaintext highlighter-rouge">数字+G</code></td>
    </tr>
    <tr>
      <td>/key ?key n N</td>
      <td>搜索 <code class="language-plaintext highlighter-rouge">/字符串</code>  逆向搜索 <code class="language-plaintext highlighter-rouge">?字符串</code>  下一个 <code class="language-plaintext highlighter-rouge">n</code> , 上一个 <code class="language-plaintext highlighter-rouge">N</code></td>
    </tr>
    <tr>
      <td>/\cmysql</td>
      <td>找mysql , 忽略大小写</td>
    </tr>
    <tr>
      <td>\Cmysql</td>
      <td>找mysql , 大小写敏感</td>
    </tr>
    <tr>
      <td>shift + 3</td>
      <td>快速查找, 把焦点对应到要找的单词上, 按下 shift + 3 就可以在全文中找对应的单词.</td>
    </tr>
    <tr>
      <td>control+o control+i</td>
      <td>回到上一个操作的位置 <code class="language-plaintext highlighter-rouge">control + o</code>,  回到新的位置 <code class="language-plaintext highlighter-rouge">control + i</code></td>
    </tr>
    <tr>
      <td>%</td>
      <td>移动光标到配对括号 <code class="language-plaintext highlighter-rouge">%</code> , 可以是(){}[]</td>
    </tr>
    <tr>
      <td>v</td>
      <td>高亮选取部分文本  <code class="language-plaintext highlighter-rouge">v</code> 然后进行删除 <code class="language-plaintext highlighter-rouge">d</code> 或者另存 <code class="language-plaintext highlighter-rouge">:w</code>  , 或者复制 <code class="language-plaintext highlighter-rouge">y</code> 在黏贴 <code class="language-plaintext highlighter-rouge">p</code> ; 按 <code class="language-plaintext highlighter-rouge">v</code> 键使 Vim 进入可视模式进行选取。您可以四处移动光标使选取区域变大或变小。接着您可以使用一个操作符对选中文本进行操作。例如，按 d 键会删除选中的文本内容</td>
    </tr>
  </tbody>
</table>

<p>命令模式</p>

<table>
  <thead>
    <tr>
      <th>命令</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>:x</td>
      <td>保存退出.   <code class="language-plaintext highlighter-rouge">shift + zz</code> 快捷保存退出</td>
    </tr>
    <tr>
      <td>:q! :w :wq :wq!</td>
      <td>退出, 保存, 保存退出<code class="language-plaintext highlighter-rouge">q! w wq wq!</code>;</td>
    </tr>
    <tr>
      <td>:w</td>
      <td>另存为 <code class="language-plaintext highlighter-rouge">:w</code>+文件名</td>
    </tr>
    <tr>
      <td>:!</td>
      <td>执行系统命令 <code class="language-plaintext highlighter-rouge">:!</code>+命令 ,  比如 <code class="language-plaintext highlighter-rouge">:!ls</code> <code class="language-plaintext highlighter-rouge">:!pwd</code></td>
    </tr>
    <tr>
      <td>:set nu[mber]</td>
      <td>显示行号 <code class="language-plaintext highlighter-rouge">:set number</code></td>
    </tr>
    <tr>
      <td>:set nonu[mber]</td>
      <td>取消行号 <code class="language-plaintext highlighter-rouge">:set nonu</code></td>
    </tr>
    <tr>
      <td>:e!</td>
      <td>恢复到文件刚打开时的状态(恢复到修改之前的状态).</td>
    </tr>
    <tr>
      <td>:set tabstop=4</td>
      <td>设置一个tab 可以有4个空格</td>
    </tr>
    <tr>
      <td>:s/old/new/g :%s/old/new/g</td>
      <td>一行中替换单词 <code class="language-plaintext highlighter-rouge">:s/old/new/g</code> , 全文中替换单词 <code class="language-plaintext highlighter-rouge">:%s/old/new/g</code></td>
    </tr>
    <tr>
      <td>:set mouse=a</td>
      <td>启动光标可以点击. 是高级的 <code class="language-plaintext highlighter-rouge">v</code>  启动后可以配合 <code class="language-plaintext highlighter-rouge">d</code>, <code class="language-plaintext highlighter-rouge">y</code>, <code class="language-plaintext highlighter-rouge">p</code> 命令使用 . 更多<a href="http://blog.csdn.net/clevercode/article/details/51416854">鼠标操作</a></td>
    </tr>
    <tr>
      <td>:set ignorecase  :set noignorecase</td>
      <td>忽略大小写, 取消忽略大小写</td>
    </tr>
    <tr>
      <td>:100</td>
      <td>到第100行.  和  100gg一样</td>
    </tr>
  </tbody>
</table>

<p>命令行模式(在shell 模式下)</p>

<table>
  <thead>
    <tr>
      <th>命令</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>!v</td>
      <td>打开最近vim 编辑的最后一个文件</td>
    </tr>
    <tr>
      <td>vim filename + 5</td>
      <td>直接进入第5行</td>
    </tr>
    <tr>
      <td>vim filename +</td>
      <td>进入到文件最后一行</td>
    </tr>
  </tbody>
</table>

<h3 id="链接文件-ln">链接文件 <code class="language-plaintext highlighter-rouge">ln</code></h3>

<p>命令: ln</p>

<p><code class="language-plaintext highlighter-rouge">ln [-s] oldfile newfile</code></p>

<p>硬链: 使用ln 创建时不加-s 选项, 相当于给一个文件又起了一个名字. 极少用到</p>

<ul>
  <li>不能给目录创建硬链接</li>
  <li>不能跨文件系统</li>
</ul>

<p>软链接: 使用 -s 参数的ln, 相当于一个快捷方式. 可以给目录创建软链接, 也可以跨操作系统</p>

<ul>
  <li>创建软链接, 源文件和新文件的引用数不变.</li>
  <li>软链接的文件属性变成 l <code class="language-plaintext highlighter-rouge">lrwxrwxrwx.</code></li>
  <li>软链接既可以对文件,也可以对目录创建</li>
</ul>

<p><em>硬链接创建. 创建后引用数由1 变成了 2.</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre>ln city.html city2.html
ll
<span class="c">#-rw-r--r--. 2 root root 1443 12月 25 22:05 city2.html</span>
<span class="c">#-rw-r--r--. 2 root root 1443 12月 25 22:05 city.html</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>软链接的例子</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre>ll /etc/rc.d/rc1.d/
ln -s tcpClient.py tcpClient2.py 
ll
<span class="c"># lrwxrwxrwx. 1 root root   12 12月 27 16:03 tcpClient2.py -&gt; tcpClient.py</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="find-文件查找"><code class="language-plaintext highlighter-rouge">find</code> 文件查找</h3>

<p><a href="http://smilejay.com/2011/12/find_regular_expression/">find正则使用方法</a></p>

<p>作用: 功能非常强大, 可搜索任意类型. 默认递归目标目录</p>

<p>前提: 必须知道文件名全名</p>

<p>格式: find [目录] 条件</p>

<table>
  <thead>
    <tr>
      <th>参数__<strong>__</strong><strong>__</strong><em>__</em></th>
      <th>标书</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>-name</td>
      <td>文件名关键字</td>
    </tr>
    <tr>
      <td>-type</td>
      <td>指定类型 (d/l/s/p/c/b) (目录/连接/)</td>
    </tr>
    <tr>
      <td>-size</td>
      <td>指定大小, 单位 k/m/g. +表示大于 - 表示小于</td>
    </tr>
    <tr>
      <td>-mtime/atime/ctime</td>
      <td>指定 修改/访问/创建 的文件的天数 +表示几天前 -表示几天内</td>
    </tr>
    <tr>
      <td>-mmin/amin/cmin</td>
      <td>指定 修改/访问/创建 的文件的分钟 +表示几分钟前 -表示几分钟内</td>
    </tr>
    <tr>
      <td>-user</td>
      <td>指定用户</td>
    </tr>
    <tr>
      <td>-group</td>
      <td>指定组</td>
    </tr>
    <tr>
      <td>-maxdepth</td>
      <td>因为find 默认无限递归目录进行搜索, 该参数指定搜索目录最大深度.</td>
    </tr>
    <tr>
      <td>-mindepth</td>
      <td>最小深度</td>
    </tr>
  </tbody>
</table>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>find / -name passwd
find /root/ -5k
find / -maxdepth 2 -name passwd
</pre></td></tr></tbody></table>
</div>
</div>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre>find /home/test/ -regextype <span class="s2">"posix-egrep"</span> -regex <span class="s2">"/home/test/.*</span><span class="se">\.</span><span class="s2">(sh|pl|py)$"</span> 
<span class="c"># 查找/home/test/目录下的所有.sh, .pl, .py结尾的文件（脚本）。</span>
<span class="c">#/home/test/file1.py</span>
<span class="c">#/home/test/file2.py</span>
<span class="c">#/home/test/file3.sh</span>
<span class="c">#/home/test/file4.pl</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="which-whereis--命令查找"><code class="language-plaintext highlighter-rouge">which whereis</code>  命令查找</h3>

<p>用于查找命令.</p>

<p>该命令必须是在 $PATH 对应目录下的命令</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre>which ls
<span class="c">#alias ll='ls -l --color=auto'</span>
<span class="c">#	/bin/ls</span>

whereis ls 
<span class="c">#ls: /usr/bin/ls /usr/share/man/man1/ls.1.gz</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="grep-egrep-正则查找"><code class="language-plaintext highlighter-rouge">grep, egrep</code> 正则查找</h3>

<p><a href="https://linux.cn/article-6941-1.html">详细文章</a></p>

<blockquote>
  <p>作用: 正则搜索</p>

  <p>格式: grep [选项] pattern [文件名]</p>

  <p>选项:</p>

  <ul>
    <li>i:忽略大小写</li>
    <li>n:显示行号</li>
  </ul>
</blockquote>

<p>实例:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre>grep -n /bin/bash /etc/passwd  <span class="c"># 搜索可以登录的用户</span>
grep -i abc 1.py <span class="c"># 忽略大小写找abc</span>
ls /bin/ |grep <span class="s1">'^m'</span> <span class="c">#查找bin 下面以 m 开头的文件</span>
tree /etc |grep <span class="s1">'um'</span>  <span class="c">#模糊查找 /etc 目录下包含'um' 文件的所有文件</span>
rm -f <span class="sb">`</span>ls |grep <span class="s1">'[0-9]'</span><span class="sb">`</span>  <span class="c"># 正则删除文件</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><strong>注意</strong>:</p>

<ul>
  <li>普通的文字匹配用<code class="language-plaintext highlighter-rouge">grep</code>, 如果需要用正则来匹配复杂内容, 用 <code class="language-plaintext highlighter-rouge">egrep</code> .</li>
</ul>

<p><em>grep 过滤多个条件</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>cp --help |grep -E <span class="s2">"</span><span class="se">\-</span><span class="s2">a,|</span><span class="se">\-</span><span class="s2">d,|</span><span class="se">\-</span><span class="s2">f,|</span><span class="se">\-</span><span class="s2">i,|^</span><span class="se">\-</span><span class="s2">p,|</span><span class="se">\-</span><span class="s2">r,"</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="locate-命令"><code class="language-plaintext highlighter-rouge">locate</code> 命令</h3>

<p>是centos7默认没有安装该命令，在联网状态运行“yum install mlocate”命令即可安装”locate”命令。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>yum install mlocate
updatedb <span class="c"># 更新文件索引</span>
locate inittab <span class="c"># 初始化</span>
</pre></td></tr></tbody></table>
</div>
</div>

<ul>
  <li>locate 1.html # 恭喜, 可以开始查找文件了.</li>
</ul>

<h3 id="文件目录的拥有者-chown">文件/目录的拥有者 <code class="language-plaintext highlighter-rouge">chown</code></h3>

<p>-v 输出每个操作的情况</p>

<p>-R 递归子目录和文件</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>  chown root /u			<span class="c"># 将 /u 的属主更改为"root"。</span>
  chown root:staff /u	<span class="c"># 和上面类似，但同时也将其属组更改为"staff"。</span>
  chown -R root /u		<span class="c"># 将 /u 及其子目录下所有文件的属主更改为"root"。</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="改变文件目录的权限-chown-chmod">改变文件/目录的权限 <code class="language-plaintext highlighter-rouge">chown chmod</code></h3>

<p>说明: 在linux中所有文件都会涉及权限. 分为拥有者(u),所属组(g), 其他人(o). 三组总成all (a)</p>

<p>权限: 所有文件分为 可读(r) 可写(w) 可执行(x)</p>

<p>用户标识: # 标识超级用户 $ 表示普通用户</p>

<p>操作: 添加权限(+) , 去掉权限(-) , 设置权限(=)</p>

<p>ls 显示: ls -l 的结果<code class="language-plaintext highlighter-rouge">-rw-r--r--</code> 分为三组, 除了第一个<code class="language-plaintext highlighter-rouge">-</code>之外还有九个<code class="language-plaintext highlighter-rouge">-</code></p>

<ul>
  <li>
    <p>前三个 对应 拥有者权限</p>
  </li>
  <li>
    <p>中间三个 对应 所属组权限</p>
  </li>
  <li>
    <p>后面三个 对应 其他人权限</p>
  </li>
  <li>
    <p>第一个表示文件类型</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13</pre></td><td class="code"><pre>-: 普通文件

d: 目录

l: 软链接

c: 字符设备

b: 块设备

s: socket 套接字文件

p: 管道文件
</pre></td></tr></tbody></table>
</div>
    </div>

    <p>​</p>
  </li>
</ul>

<p>权限本质: 是一组3位八进制的数字表示的权限. 如: 0755 解析如下</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre>0755转成二进制: 111 101 101  <span class="c"># 每一位最大是7 , 是由4+2+1 组成, 既二进制的 100+10+1 </span>
对应三个身份:   u   g   o
每组三个权限:   rwx rwx rwx

</pre></td></tr></tbody></table>
</div>
</div>

<p>实例</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>chmod a+w 1.py  <span class="c"># 为所有用于 添加可写权限</span>
chmod g+x 1.py  <span class="c"># 为所属组用户添加可执行权限.</span>
chmod 777 1.py 
</pre></td></tr></tbody></table>
</div>
</div>

<p><code class="language-plaintext highlighter-rouge">umask</code></p>

<blockquote>
  <p>作用: 限定新建文件的默认权限. 权限与该值相反</p>

  <p>当用户登录时, 会读取 <code class="language-plaintext highlighter-rouge">/etc/profile</code> 中的配置信息获取该用户的 umask 值, 然后给出该用户默认的文件读取权限</p>
</blockquote>

<p>root 用户</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>umask 输出 : 022 =&gt; 000 010 010
新建文件权限: 644 =&gt; 110 100 100
新建目录权限: 755 =&gt; 111 101 101
</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="用户-用户组--用户权限管理">用户, 用户组 , 用户权限管理</h2>

<p>Linux 分为三类用户</p>

<ul>
  <li>root 用户(超级用户):有最高权限,可操作任何文件和命令</li>
  <li>虚拟用户: 这类用户不具有系统登录能力, 但是系统运行需要. 比如 bin, daemon, adm, ftp ,mail</li>
  <li>普通真实用户: 能登录系统, 但只能操作其根目录的内容, 权限受到限制. 这类用户都是系统管理员添加的.</li>
</ul>

<h3 id="相关命令-whoami-useradd-userdel-passwd-su----sudo-visudo-groupadd-groupdel-gpasswd-groups-chsh-chown-chgrp-chage-usermod">相关命令 <code class="language-plaintext highlighter-rouge">whoami, useradd, userdel, passwd, su - , sudo, visudo, groupadd, groupdel, gpasswd, groups, chsh, chown, chgrp, chage, usermod</code></h3>

<table>
  <thead>
    <tr>
      <th>命令__<strong>__</strong><strong>__</strong>_</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>whoami</td>
      <td>查看当前登录的用户名</td>
    </tr>
    <tr>
      <td>useradd</td>
      <td>添加用户，会在/home下创建一个同名的目录. 常用参数 -G 组, -e 过期时间, 更多解释看表格下面的解释.</td>
    </tr>
    <tr>
      <td>userdel</td>
      <td>删除用户，’-r’参数可以一并删除用户相关目录.</td>
    </tr>
    <tr>
      <td>passwd</td>
      <td>设置指定用户的密码，不指定时设置当前用户</td>
    </tr>
    <tr>
      <td>su -</td>
      <td>切换用户，一定要加’-‘，若不指定用户，切换到root用户</td>
    </tr>
    <tr>
      <td>sudo</td>
      <td>临时切换到指定用户(root)执行命令，如：sudo service iptables stop</td>
    </tr>
    <tr>
      <td>visudo</td>
      <td>修改配置文件/etc/sudoers，如给dalong sudo 权限：<code class="language-plaintext highlighter-rouge">dalong ALL=(ALL) ALL</code> 不要直接编辑这个文件;  如果是给一个用户组sudo 权限,: <code class="language-plaintext highlighter-rouge">%tgroup ALL=(ALL) ALL</code></td>
    </tr>
    <tr>
      <td>groupadd</td>
      <td>添加用户组</td>
    </tr>
    <tr>
      <td>groupdel</td>
      <td>删除用户组</td>
    </tr>
    <tr>
      <td>gpasswd</td>
      <td>将指定的用户组添加/删除指定组，gpasswd -a/-d 用户 用户组.  比如将dalong 放到</td>
    </tr>
    <tr>
      <td>groups</td>
      <td>查看用户属于哪个组.</td>
    </tr>
    <tr>
      <td>chsh</td>
      <td>修改指定用户的shell . 比如: <code class="language-plaintext highlighter-rouge">chsh xiaoming -s /sbin/nologin</code> 让某用户无法</td>
    </tr>
    <tr>
      <td>chown</td>
      <td>改变文件的拥有者[:组] <code class="language-plaintext highlighter-rouge">chown xiaoming ./myFile.txt</code>  <code class="language-plaintext highlighter-rouge">chown root:root ./myfile.txt</code> 常用参数 -R 递归更改</td>
    </tr>
    <tr>
      <td>chgrp</td>
      <td>改变文件的拥有组  <code class="language-plaintext highlighter-rouge">chgrp xiaoming ./myfile.txt</code></td>
    </tr>
    <tr>
      <td>chage -l dalong</td>
      <td>查看用户的账号有效期限, 去掉 -l 就是修改过期时间.</td>
    </tr>
    <tr>
      <td>usermod</td>
      <td>修改用户信息 , 比如修改用户账号的到期时间  <code class="language-plaintext highlighter-rouge">usermod -e "Dec 28,2017" t1</code> 修改t1用户的到期日期. 修改后/etc/shadow最后</td>
    </tr>
  </tbody>
</table>

<p>涉及文件 <code class="language-plaintext highlighter-rouge">/etc/passwd</code>  <code class="language-plaintext highlighter-rouge">/etc/shadow</code>  <code class="language-plaintext highlighter-rouge">/etc/group</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>/etc/passwd：系统中的所有用户信息
/etc/shadow：用户的密码
/etc/group：系统中的所有用户组信息
</pre></td></tr></tbody></table>
</div>
</div>

<p><code class="language-plaintext highlighter-rouge">创建用户的注意事项</code></p>

<ul>
  <li>-u: 创建用户时指定的UID , 但必须这个id不存在,并且必须要大于499, 因为小于500的已经被系统占用.</li>
  <li>-g/G: g 创建用的的同时,只为用户分配指定的组. G 除了用户本身的组, 同时添加到指定的组</li>
  <li>-c: 给用户增加一些注释.</li>
</ul>

<h3 id="usermod-命令-修改用户信息的最常用命令-包括主目录-所属组-登录shell"><code class="language-plaintext highlighter-rouge">usermod</code> 命令 修改用户信息的最常用命令. 包括主目录, 所属组, 登录shell</h3>

<p>参数</p>

<ul>
  <li>-d: 登录目录</li>
  <li>-e: 账号有效期, 单位为天</li>
  <li>-g: 所属组</li>
  <li>-l: 修改登录名</li>
  <li>-p: 修改密码.</li>
  <li>-s: 修改默认shell.</li>
</ul>

<p>注意:</p>

<ul>
  <li>不要用 usermod 修改密码,因为这样修改的密码是明文显示在 shadow文件中.</li>
  <li>不能用usermod 修改已登录用户的用户名</li>
</ul>

<h3 id="passwd-命令">passwd 命令</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre>passwd -l: This option is to lock the password <span class="k">for </span>the user<span class="s1">'s account
passwd -u: This option is to unlock the password for the user'</span>s account
passwd -e: This option is to expire the password <span class="k">for </span>the user
passwd -x: This option is to define the maximum days <span class="k">for </span>the password lifetime
passwd -n: This option is to define the minimum days <span class="k">for </span>the password lifetime
</pre></td></tr></tbody></table>
</div>
</div>

<p>可以用 <code class="language-plaintext highlighter-rouge">chage</code> 做更多用户过期相关的命令操作.</p>

<h3 id="etcpasswd-文件"><code class="language-plaintext highlighter-rouge">/etc/passwd</code> 文件</h3>

<p><a href="http://blog.csdn.net/gaopeiliang/article/details/40422447">详细解释</a></p>

<p>格式如下:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>注册名：口令<span class="o">(</span>x<span class="o">)</span>：用户标识号：组标识号：用户注释：用户主目录：命令行解释程序<span class="o">(</span>shell<span class="o">)</span> 
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="设置密码-有效期-和-密码长度-etclogindefs">设置密码 <em>有效期</em> 和 <em>密码长度</em> <code class="language-plaintext highlighter-rouge">/etc/login.defs</code></h3>

<p>密码有效期和密码长度在 <code class="language-plaintext highlighter-rouge">/etc/login.defs</code> 文件中设置</p>

<p>对该文件的修改不会影响现有用户, 只会影响修改后创建的新用户</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre>#   PASS_MAX_DAYS   Maximum number of days a password may be used.
#   PASS_MIN_DAYS   Minimum number of days allowed between password changes.
#   PASS_MIN_LEN    Minimum acceptable password length.
#   PASS_WARN_AGE   Number of days warning given before a password expires.
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="设置密码-复杂度-和-密码重设要求-etcpamdsystem-auth">设置密码 <em>复杂度</em> 和 <em>密码重设要求</em> <code class="language-plaintext highlighter-rouge">/etc/pam.d/system-auth</code></h3>

<p>设置密码复杂度和重设要求的配置文件在 <code class="language-plaintext highlighter-rouge">/etc/pam.d/system-auth</code> 文件中设置</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8</pre></td><td class="code"><pre>password requisite pam_cracklib.so try_first_pass <span class="nv">retry</span><span class="o">=</span>3 <span class="nb">type</span><span class="o">=</span> <span class="nv">ucredit</span><span class="o">=</span>-2 <span class="nv">lcredit</span><span class="o">=</span>-2 <span class="nv">dcredit</span><span class="o">=</span>-2 <span class="nv">ocredit</span><span class="o">=</span>-2 
<span class="c">#ucredit=-2 大写字母最少2个 </span>
<span class="c">#lcredit=-2 小写字母最少2个</span>
<span class="c">#dcredit=-2 数字最少2个</span>
<span class="c">#ocredit=-2 字符最少2个 </span>
password sufficient pam_unix.so sha512 shadow nullok try_first_pass use_authtok <span class="nv">remember</span><span class="o">=</span>5
<span class="c">#remember=5 重设密码不能使用过去5次内使用过的密码</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="密码输入错误的相关设置-etcpamdpassword-auth--etcpamdlogin">密码输入错误的相关设置 <code class="language-plaintext highlighter-rouge">/etc/pam.d/password-auth</code>  <code class="language-plaintext highlighter-rouge">/etc/pam.d/login</code></h3>

<p>设置密码如果连续输错3次,那么需要等5分钟后再输入.</p>

<p>相关的3个配置文件:</p>

<ul>
  <li>/etc/pam.d/password-auth</li>
  <li>/etc/pam.d/system-auth</li>
  <li>/etc/pam.d/login</li>
  <li>下面代码分别放入password-auth 和 system-auth ; 只有第一行放入 login</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>auth        required    pam_tally2.so <span class="nv">file</span><span class="o">=</span>/var/log/tallylog <span class="nv">deny</span><span class="o">=</span>3 no_magic_root <span class="nv">unlock_time</span><span class="o">=</span>300
account     required    pam_tally2.so
</pre></td></tr></tbody></table>
</div>
</div>

<p>让用户登录失败的命令</p>

<p><code class="language-plaintext highlighter-rouge">pam_tally2 --user user1</code></p>

<p>重置用户,让用户可以继续登录的命令</p>

<p><code class="language-plaintext highlighter-rouge">pam_tally2 --user user1 --reset</code></p>

<h3 id="etcshadow-文件"><code class="language-plaintext highlighter-rouge">/etc/shadow</code> 文件</h3>

<p><a href="http://blog.csdn.net/u011641885/article/details/46681697">详细解释</a></p>

<p>修改密码和有效性等信息:</p>

<ul>
  <li>passwd t1</li>
  <li>chage t1</li>
</ul>

<p>格式如下:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre></td><td class="code"><pre>登录名:加密口令<span class="o">(</span>!!<span class="o">)</span>:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志

1）“登录名”是与/etc/passwd文件中的登录名相一致的用户账号
2）“口令”字段存放的是加密后的用户口令字，如果为空，则对应用户没有口令，登录时不需要口令；   
<span class="k">*</span>星号代表帐号被锁定；
!!双叹号表示这个密码已经过期了。
<span class="nv">$6$开</span>头的，表明是用SHA-512加密的，
<span class="gp">$1$ </span>表明是用MD5加密的
<span class="gp">$2$ </span>是用Blowfish加密的
<span class="gp">$5$ </span>是用 SHA-256加密的。 

3）“最后一次修改时间”表示的是从某个时刻起，到用户最后一次修改口令时的天数。时间起点对不同的系统可能不一样。例如在SCOLinux中，这个时间起点是1970年1月1日。
4）“最小时间间隔”指的是两次修改口令之间所需的最小天数。
5）“最大时间间隔”指的是口令保持有效的最大天数。
6）“警告时间”字段表示的是从系统开始警告用户到用户密码正式失效之间的天数。
7）“不活动时间”表示的是用户没有登录活动但账号仍能保持有效的最大天数。
8）“失效时间”字段给出的是一个绝对的天数，如果使用了这个字段，那么就给出相应账号的生存期。期满后，该账号就不再是一个合法的账号，也就不能再用来登录了。
</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="磁盘文件系统管理服务">磁盘/文件系统管理服务</h2>

<p>磁盘使用步骤: 分区 =&gt; 格式化 =&gt; 挂载 <code class="language-plaintext highlighter-rouge">/dev/sda</code></p>

<p>相关配置文件:</p>

<ul>
  <li>
    <p>/etc/fstab</p>

    <ul>
      <li>记录了计算机上硬盘分区的相关信息，启动 Linux 的时候，检查分区的 fsck 命令，和挂载分区的 mount 命令，都需要 fstab 中的信息，来正确的检查和挂载硬盘。</li>
    </ul>
  </li>
  <li>
    <p>/etc/mtab</p>

    <ul>
      <li>记载的是现在系统已经装载的文件系统，包括操作系统建立的虚拟文件等；而/etc/fstab是系统准备装载的。</li>
      <li>每当 mount 挂载分区、umount 卸载分区，都会动态更新 mtab，mtab 总是保持着当前系统中已挂载的分区信息，fdisk、df 这类程序，必须要读取 mtab 文件，才能获得当前系统中的分区挂载情况。当然我们自己还可以通过读取/proc/mount也可以来获取当前挂载信息</li>
    </ul>

    <p>​</p>
  </li>
</ul>

<h3 id="fdisk--l--查看系统磁盘分布"><code class="language-plaintext highlighter-rouge">fdisk -l</code> # 查看系统磁盘分布</h3>

<ul>
  <li>多个磁盘命名: sda, sdb, sdc</li>
  <li>分区命名: sda1, sda2 表示这块磁盘的第一个分区和第二个分区
    <ul>
      <li>一个磁盘最多分4个主分区. 其中一个可以是扩展分区.</li>
      <li>主分区可以安装操作系统, 扩展分区不能直接使用(可以分多个逻辑分区)</li>
    </ul>
  </li>
</ul>

<h3 id="mount-挂载的查看和设置命令-用命令"><code class="language-plaintext highlighter-rouge">mount</code> 挂载的查看和设置命令 用命令</h3>

<ul>
  <li>mount 配置文件决定了开机需要自动挂载的磁盘.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">/etc/fstab</code> 格式如下:
        <ul>
          <li><em>磁盘分区名 挂载点 文件系统类型 选项(iocharset=utf8) 备份 检查</em></li>
          <li>选项的内容:
            <ul>
              <li>rw 可读可写</li>
              <li>auto ?</li>
              <li>async 异步?</li>
              <li>iocharset=utf8</li>
              <li>default 包含上面几个?</li>
            </ul>
          </li>
        </ul>
      </li>
      <li><code class="language-plaintext highlighter-rouge">mount -a</code> # 重新解析/etc/fstab 文件, 完成挂载. 用于在修改完配置信息后, 再按照配置文件重新挂一遍</li>
    </ul>
  </li>
  <li>mount #不带参数查看当前挂载情况</li>
  <li>语法: mount [选项] 磁盘分区 挂载点
    <ul>
      <li>-o 指定字符集: iocharset=utf8</li>
      <li>-t 指定文件系统类型:
        <ul>
          <li>msdos(fat16),</li>
          <li>vfat(fat32),</li>
          <li>auto(自动识别)</li>
          <li>ntfs-3g*(ntfs). linux默认不支持, 需要安装一个扩展</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>mount -o <span class="nv">iocharset</span><span class="o">=</span>utf8 /dev/sdc1 /mnt/
umount /dev/sdc1 
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="分区-对一个已有的磁盘进行分区-比如-fdisk-devsdb">分区: 对一个已有的磁盘进行分区, 比如 <code class="language-plaintext highlighter-rouge">fdisk /dev/sdb</code></h3>

<p>一块磁盘可以最多有四个分区(Linux), 最多三个主分区,剩下一个是扩展分区.</p>

<p>一块磁盘只能有一个扩展分区</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">fdisk /dev/sdb</code> # 对磁盘进行分区, m for help</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></td><td class="code"><pre>命令<span class="o">(</span>输入 m 获取帮助<span class="o">)</span>：m       

命令操作

   a   toggle a bootable flag

   b   edit bsd disklabel

   c   toggle the dos compatibility flag

   d   delete a partition 删除分区

   g   create a new empty GPT partition table

   G   create an IRIX <span class="o">(</span>SGI<span class="o">)</span> partition table

   l   list known partition types

   m   print this menu

   n   add a new partition 新建分区

   o   create a new empty DOS partition table

   p   print the partition table 打印分区信息

   q   quit without saving changes 不保存退出

   s   create a new empty Sun disklabel

   t   change a partition<span class="s1">'s system id

   u   change display/entry units

   v   verify the partition table

   w   write table to disk and exit  保存分区修改,退出

   x   extra functionality (experts only)

</span></pre></td></tr></tbody></table>
</div>
</div>

<h3 id="格式化-mkfs">格式化 <code class="language-plaintext highlighter-rouge">mkfs</code></h3>

<p>centos 7 不带 vfat 格式的格式化, 需要安装 mkfs.vfat</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>yum install dosfstools
</pre></td></tr></tbody></table>
</div>
</div>

<p>命令:</p>

<ul>
  <li>mkfs #查看可可视化的分区</li>
  <li>mkfs.ext2</li>
  <li>mkfs.ext3</li>
  <li>mkfs.ext4</li>
  <li>mke2fs</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>mkfs.ext4 /dev/sdb1 <span class="c"># 用 ext4格式化sdb1</span>
mke2fs -t ext3 /dev/sdb5 <span class="c"># 这个命令需要指定文件系统类型</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="查看磁盘使用情况的命令-df--th--du">查看磁盘使用情况的命令 <code class="language-plaintext highlighter-rouge">df -Th</code>  <code class="language-plaintext highlighter-rouge">du</code></h3>

<p><code class="language-plaintext highlighter-rouge">df</code>  查看磁盘分区使用情况, 包括已用空间, mount点, 文件系统类型</p>

<ul>
  <li>-T:  print file system type</li>
  <li>-h: 人能看懂的单位格式</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">du</code>  递归统计指定目录的使用情况</p>

<ul>
  <li>-h: 人能看懂的单位格式</li>
  <li>-d: 递归最大深度</li>
</ul>

<h3 id="实验-为virtual-box-虚拟机-dalongcentos7-添加新磁盘分区挂载并格式化">实验: 为virtual box 虚拟机 dalongCentOS7 添加新磁盘,分区,挂载并格式化</h3>

<p><em>进入vbox中的配置-&gt;storage-&gt;controller 创建一个新的虚拟硬盘</em></p>

<ul>
  <li>add hard disk</li>
</ul>

<p><em>重新启动dalongCentOS7 虚拟机</em></p>

<p><em>为新硬盘分区</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>fdisk -l <span class="c"># 查看是否找到/dev/sdb</span>

fdisk /dev/sdb <span class="c"># 开始分区</span>
</pre></td></tr></tbody></table>
</div>
</div>

<ul>
  <li>p # 查看现有分区情况, 这是还是什么都没有</li>
  <li>n # 创建主分区(Linux), 分配空间+200M; 创建扩展分区(Extended) 分配所有空间. 创建3个逻辑分区(Linux) , 分配剩下所有空间.</li>
  <li>w # 保存退出</li>
</ul>

<p><em>格式化新建的分区为</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>mkfs.ext4 /dev/sdb1 <span class="c"># 格式化新建的分区为 xfs格式. 同时把sdb1 ~ sdb 7 都格式化掉</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>为新格式化的分区建立挂载点</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>mkdir /mnt/1 <span class="c"># 为新格式化的分区建立挂载点. 同时把 1~7 的目录都创建出来</span>
mnt /dev/sdb1 /mnt/1 <span class="c"># 将每个分区挂载到对应的目录挂载点上.</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>为了让系统重启后制动挂载, 需要编辑 /etc/fatab 文件</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>/dev/sdb1 /mnt/b1                               xfs     defaults 0 0
/dev/sdc5 /mnt/c5                               ext4    defaults 0 0
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="磁盘配额-qutas">磁盘配额 qutas</h3>

<p>简单的说就是限制用户对磁盘空间的使用量。</p>

<blockquote>
  <p>因为Linux是多用户多任务的操作系统，许多人共用磁盘空间，为了合理的分配磁盘空间，于是就有了quota的出现。</p>
</blockquote>

<p>用途:</p>

<ol>
  <li>针对WWW server</li>
  <li>针对mail server</li>
  <li>针对file server</li>
</ol>

<h3 id="创建磁盘镜像文件-virtual-block-device-dd-losetup">创建磁盘镜像文件 virtual block device <code class="language-plaintext highlighter-rouge">dd</code> <code class="language-plaintext highlighter-rouge">losetup</code></h3>

<p>设想一个场景：你要用U盘在两台Linux主机之间移动文件，如果U盘是exfat格式的，那么这个文件移动到U盘之后，文件的所有者以及权限信息将会全部丢失，移动到新的主机上又要重新设置一遍。在文件多而且权限复杂的时候真的非常令人崩溃！假设U盘不能格式化，那有什么方法解决这个问题呢？那就是磁盘映像啦～</p>

<p>macOS上的磁盘工具可以轻松地创建磁盘映像(dmg文件)，而且功能非常丰富。Linux当然也可以啦～只要你是真的喜欢Linux！</p>

<p><em>用 <code class="language-plaintext highlighter-rouge">dd</code> 创建一个1G 的空磁盘镜像文件 /tmp/test.img</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre><span class="c"># 创建一个1G 的空虚拟文件 /tmp/test.img</span>
dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>/tmp/test.img <span class="nv">bs</span><span class="o">=</span>1M <span class="nv">count</span><span class="o">=</span>100  <span class="c"># 如果存在 /dev/zero 就创建/tmp/test.img</span>
<span class="c">#1048576000字节(1.0 GB)已复制，1.62677 秒，645 MB/秒</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><em><code class="language-plaintext highlighter-rouge">losetup</code>将镜像文件模拟成一个回环磁盘</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6</pre></td><td class="code"><pre>losetup -fP /tmp/test.img <span class="c"># 创建磁盘</span>
<span class="c">#  -f, --find                    查找第一个未使用的设</span>
<span class="c">#  -P, --partscan                创建分区的回环设备</span>
losetup -a  <span class="c"># 查看已经生成的磁盘</span>
<span class="c"># /dev/loop0: [64768]:6123119 (/tmp/test.img)  默认会将磁盘放在 dev/loopN的地方</span>

</pre></td></tr></tbody></table>
</div>
</div>

<p><em>对磁盘进行分区, 并进行格式化</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8</pre></td><td class="code"><pre><span class="c"># 为这个磁盘创建一个扩展分区, 为扩展分区再创建一个逻辑分区</span>
fdisk /dev/loop0
<span class="c">#      设备 Boot      Start         End      Blocks   Id  System</span>
<span class="c">#/dev/loop0p1            2048      204799      101376    5  Extended</span>
<span class="c">#/dev/loop0p5            4096      204799      100352   83  Linux</span>

<span class="c">#格式化成功 xfs 格式</span>
mkfs.xfs /dev/loop0p5
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>mount 到创建的挂载点上</em></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>mkdir /mnt/myImg
mount /dev/loop0p5 /mnt/myImg/
df -Th
</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="网络服务">网络服务</h2>

<h3 id="相关命令-ip-addr--ping-ifup-ifdown-systemctl">相关命令: <code class="language-plaintext highlighter-rouge">ip addr , ping, ifup, ifdown, systemctl</code></h3>

<table>
  <thead>
    <tr>
      <th>命令</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ip addr</td>
      <td>查看网卡信息</td>
    </tr>
    <tr>
      <td>ping</td>
      <td>检查网络连通性</td>
    </tr>
    <tr>
      <td>ifup</td>
      <td>启动网卡</td>
    </tr>
    <tr>
      <td>ifdown</td>
      <td>关闭网卡</td>
    </tr>
    <tr>
      <td>systemctl start/stop/status network.service</td>
      <td>开启关闭,查看网络服务</td>
    </tr>
  </tbody>
</table>

<h3 id="网卡配置文件-etcsysconfignetwork-scriptsifcfg-enp0s3">网卡配置文件: <code class="language-plaintext highlighter-rouge">/etc/sysconfig/network-scripts/ifcfg-enp0s3</code></h3>

<p>服务监测:</p>

<ul>
  <li>netstat (centos7没有了)
    <ul>
      <li>centos7中用 ss 代替了. <a href="http://www.linuxidc.com/Linux/2014-09/107375p4.htm">查看补充信息</a></li>
      <li>说明: 查看网络端口使用说明</li>
      <li>参数:
        <ul>
          <li>-l 监听</li>
          <li>-p 显示pid</li>
          <li>-t</li>
          <li>-u</li>
          <li>-n</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ip -s link
    <ul>
      <li>说明: 网络接口统计信息</li>
    </ul>
  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>ip route</td>
          <td>column -t</td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>说明: 显示路由表</li>
      <li>添加静态路由
        <ul>
          <li><code class="language-plaintext highlighter-rouge">ip route add 10.15.150.0/24 via 192.168.150.253 dev enp0s3</code></li>
        </ul>
      </li>
      <li>删除静态旅游
        <ul>
          <li><code class="language-plaintext highlighter-rouge">ip route del 10.15.150.0/24</code></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="系统监控">系统监控</h2>

<h3 id="free"><code class="language-plaintext highlighter-rouge">free</code></h3>

<ul>
  <li>说明:-h 查看内存使用情况</li>
  <li>w
    <ul>
      <li>说明: 当前用户正在做的事情,包含了用户,终端, 从哪里连接, 登录时间, 空闲时间, 占用cpu情况, 正在做什么.</li>
    </ul>
  </li>
</ul>

<h3 id="top"><code class="language-plaintext highlighter-rouge">top</code></h3>

<ul>
  <li>说明: 查看本机正在运行的系统服务的详细信息. 相当于 详细版本的<code class="language-plaintext highlighter-rouge">w</code>. 每三秒刷新一次.</li>
  <li>第一行字段包含: 登录时间, 登录人数  负载情况.</li>
  <li>第二行字段 - 进程汇总: 运行中的进程, 睡眠中的进程</li>
  <li>第三行字段 - CPU 使用情况: 用户占比, 系统占比, …,</li>
  <li>第四行字段 - 内存使用情况:</li>
  <li>第五行字段 - 交换分区:</li>
  <li>动态部分 - 系统进程信息:</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">q</code> 退出</p>
  </li>
  <li>vmstat
    <ul>
      <li>说明: 虚拟内存使用情况</li>
      <li>字段说明: 进程, 内存, 交换分区, io, 系统, cpu</li>
    </ul>
  </li>
</ul>

<h2 id="进程管理">进程管理</h2>

<h3 id="ps-aux--ps--ef"><code class="language-plaintext highlighter-rouge">ps aux , ps -ef</code></h3>

<ul>
  <li>说明: 查看进程情况</li>
  <li>-e all processes</li>
  <li>-f full</li>
  <li>a 所有</li>
  <li>u 显示用户信息</li>
  <li>
    <p>x 显示没有终端的进程</p>
  </li>
  <li>
    <p>kill</p>

    <ul>
      <li>说明: 杀掉进程</li>
      <li>选项: -9 强制杀死 一个进程ID</li>
    </ul>

    <p>​</p>
  </li>
</ul>

<h2 id="服务管理">服务管理</h2>

<p>老版本的是 service</p>

<p>Linux Systemctl是一个系统管理守护进程(后台运行程序)的管理命令，初始进程主要负责控制systemd系统和服务管理器。</p>

<p>所有开启自动启动的服务都会Created symlink from /etc/systemd/system/multi-user.target.wants/服务名 to /usr/lib/systemd/system/服务名.</p>

<h3 id="systemctl-命令--老版本是-service-命令"><code class="language-plaintext highlighter-rouge">systemctl</code> 命令 , 老版本是 <code class="language-plaintext highlighter-rouge">service</code> 命令</h3>

<ul>
  <li>
    <p>列出所有已安装的可用单元</p>

    <ul>
      <li>systemctl list-unit-files</li>
    </ul>
  </li>
  <li>
    <p>列出所有运行中单元</p>

    <ul>
      <li>systemctl list-units</li>
    </ul>
  </li>
  <li>
    <p>检查某个单元（如 crond.service）是否启用</p>

    <ul>
      <li>systemctl is-enabled crond.service</li>
    </ul>
  </li>
  <li>
    <p><strong>列出所有服务 / 查找某项服务是否启动</strong></p>

    <ul>
      <li>
        <table>
          <tbody>
            <tr>
              <td>systemctl -t service -a –state running</td>
              <td>grep chrony</td>
            </tr>
          </tbody>
        </table>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>Linux中如何启动、重启、停止、重载服务以及检查服务（如 httpd.service）状态</strong></p>

    <ul>
      <li>
        <p>systemctl start httpd.service</p>
      </li>
      <li>
        <p>systemctl restart httpd.service</p>
      </li>
      <li>
        <p>systemctl stop httpd.service</p>
      </li>
      <li>
        <p>systemctl reload httpd.service</p>
      </li>
      <li>
        <p>systemctl status httpd.service</p>

        <p>注意：当我们使用systemctl的start，restart，stop和reload命令时，终端不会输出任何内容，只有status命令可以打印输出。</p>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>如何激活服务并在开机时启用或禁用服务（即系统启动时自动启动mysql.service服务）</strong></p>

    <ul>
      <li>systemctl is-active mysql.service</li>
      <li>systemctl enable mysql.service</li>
      <li>systemctl disable mysql.service</li>
    </ul>
  </li>
  <li>
    <p>使用systemctl命令杀死服务</p>

    <ul>
      <li>systemctl kill crond</li>
    </ul>
  </li>
  <li>
    <p>列出所有系统挂载点</p>

    <ul>
      <li>systemctl list-unit-files –type=mount</li>
    </ul>
  </li>
  <li>
    <p>挂载、卸载、重新挂载、重载系统挂载点并检查系统中挂载点状态</p>

    <ul>
      <li>systemctl start tmp.mount</li>
      <li>systemctl stop tmp.mount</li>
      <li>systemctl restart tmp.mount</li>
      <li>systemctl reload tmp.mount</li>
      <li>systemctl status tmp.mount</li>
    </ul>
  </li>
  <li>
    <p>在启动时激活、启用或禁用挂载点（系统启动时自动挂载）</p>

    <p># systemctl is-active tmp.mount</p>

    <p># systemctl enable tmp.mount</p>

    <p># systemctl disable tmp.mount</p>

    <p>\13. 在Linux中屏蔽（让它不能启用）或可见挂载点</p>

    <p># systemctl mask tmp.mount</p>

    <p>ln -s ‘/dev/null”/etc/systemd/system/tmp.mount’</p>

    <p># systemctl unmask tmp.mount</p>

    <p>rm ‘/etc/systemd/system/tmp.mount’</p>

    <p>\14. 列出所有可用系统套接口</p>

    <p># systemctl list-unit-files –type=socket</p>

    <p>\15. 检查某个服务的所有配置细节</p>

    <p># systemctl showmysql</p>

    <p>\16. 获取某个服务（httpd）的依赖性列表</p>

    <p># systemctl list-dependencies httpd.service</p>

    <p>\17. 启动救援模式</p>

    <p># systemctl rescue</p>

    <p>\18. 进入紧急模式</p>

    <p># systemctl emergency</p>

    <p>\19. 列出当前使用的运行等级</p>

    <p># systemctl get-default</p>

    <p>\20. 启动运行等级5，即图形模式</p>

    <p># systemctl isolate runlevel5.target</p>

    <p>或</p>

    <p># systemctl isolate graphical.target</p>

    <p>\21. 启动运行等级3，即多用户模式（命令行）</p>

    <p># systemctl isolate runlevel3.target</p>

    <p>或</p>

    <p># systemctl isolate multiuser.target</p>

    <p>\22. 设置多用户模式或图形模式为默认运行等级</p>

    <p># systemctl set-default runlevel3.target</p>

    <p># systemctl set-default runlevel5.target</p>

    <p>\23. 重启、停止、挂起、休眠系统或使系统进入混合睡眠</p>

    <p># systemctl reboot</p>

    <p># systemctl halt</p>

    <p># systemctl suspend</p>

    <p># systemctl hibernate</p>

    <p># systemctl hybrid-sleep</p>

    <p>对于不知运行等级为何物的人，说明如下。</p>

    <p>Runlevel 0 : 关闭系统</p>

    <p>Runlevel 1 : 救援，维护模式</p>

    <p>Runlevel 3 : 多用户，无图形系统</p>

    <p>Runlevel 4 : 多用户，无图形系统</p>

    <p>Runlevel 5 : 多用户，图形化系统</p>

    <p>Runlevel 6 : 关闭并重启机器</p>
  </li>
</ul>

<h3 id="centos6的-chkconfig-配置服务启动项">centos6的 <code class="language-plaintext highlighter-rouge">chkconfig</code> 配置服务启动项,</h3>

<p>作用: 查看/设置一个服务在不同的运行级别的状态, 修改后不会立即生效.</p>

<p>格式: chkconfig [选项][操作][参数]</p>

<p>选项</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre>--list: 查看service中的信息
--add : 新添加服务到service
--del : 从service中删除服务
--level: 指定级别. 默认是2345
</pre></td></tr></tbody></table>
</div>
</div>

<p>操作</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>on: 开启
off: 关闭
</pre></td></tr></tbody></table>
</div>
</div>

<p>举例</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre>chkconfig iptables off <span class="c"># 关闭防火墙, 修改后重启才能生效.</span>
chkconfig --list <span class="c"># 查看修改结果</span>
service iptables status <span class="c"># 查看修改后对iptables 的影响</span>
chkconfig --del iptables
chkconfig --add iptables
</pre></td></tr></tbody></table>
</div>
</div>

<p>添加服务到启动项中</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre>1. 创建一个服务控制脚本, 放在/etc/rc.d/init.d 目录下
2. 给该脚本添加可执行权限 , 比如 755
3. /etc/rc.d/rc3.d 下面有很多文件. 每当使用 chkconfig --add 某服务, 就会在该目录下生成一个新的软链接文件. 该文件下开启的服务是 S 开头, 关闭的服务时 K 开头

</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="系统安全">系统安全</h2>

<p><a href="https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/7/html/security_guide/">redhat7 安全指南</a></p>

<h3 id="selinux-的使用">selinux 的使用</h3>

<p><code class="language-plaintext highlighter-rouge">selinux</code> 是一套linux 安全管理方案, 比较复杂, 一般都要关掉</p>

<ul>
  <li>getenforce
    <ul>
      <li>说明: 查看selinux 状态, Enabled 是开启, Disabled 是关闭</li>
    </ul>
  </li>
  <li>setenforce 0
    <ul>
      <li>说明: 设置selinux 关闭(Disabled)</li>
    </ul>
  </li>
  <li>vi /etc/selinux/config
    <ul>
      <li>设置 <code class="language-plaintext highlighter-rouge">SELINUX=disabled</code> 将selinux 永久关闭.</li>
    </ul>
  </li>
</ul>

<h3 id="防火墙命令--firewall-cmd-firewall-config">防火墙命令  <code class="language-plaintext highlighter-rouge">firewall-cmd</code> <code class="language-plaintext highlighter-rouge">firewall-config</code></h3>

<p><a href="https://www.5yun.org/10074.html">网上教程</a></p>

<p><a href="https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/7/html/security_guide/sec-using_firewalls">redhat 官方说明</a></p>

<blockquote>
  <p>墙后台程序 <code class="language-plaintext highlighter-rouge">firewalld</code> 提供了一个 动态管理的防火墙，用以支持网络 “zones” ，以分配对一个网络及其相关链接和界面一定程度的信任。它具备对 <code class="language-plaintext highlighter-rouge">IPv4</code> 和 <code class="language-plaintext highlighter-rouge">IPv6</code> 防火墙设置的支持。它支持以太网桥，并有分离运行时间和永久性配置选择。它还具备一个通向服务或者应用程序以直接增加防火墙规则的接口。</p>
</blockquote>

<p>zone 区域</p>

<ul>
  <li>默认区配置文件都放在  <code class="language-plaintext highlighter-rouge">/usr/lib/firewalld/zones/</code> 目录下, 该目录的文件不能直接编辑, 需要拷贝到 <code class="language-plaintext highlighter-rouge">/etc/firewalld/zones/</code> 才能开始编辑</li>
  <li>两个目录是覆盖关系, 既如果etc 下面的文件存在,则优先使用, 否则使用 usr 目录下的.</li>
  <li>比如: <code class="language-plaintext highlighter-rouge">cp /usr/lib/firewalld/zones/work.xml /etc/firewalld/zones/</code></li>
</ul>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">drop</code>（丢弃）</p>

  <p>任何接收的网络数据包都被丢弃，没有任何回复。仅能有发送出去的网络连接。</p>

  <p><code class="language-plaintext highlighter-rouge">block</code>（限制）</p>

  <p>任何接收的网络连接都被 <code class="language-plaintext highlighter-rouge">IPv4</code> 的 icmp-host-prohibited 信息和 <code class="language-plaintext highlighter-rouge">IPv6</code> 的 icmp6-adm-prohibited 信息所拒绝。</p>

  <p><code class="language-plaintext highlighter-rouge">public</code>（公共）</p>

  <p>在公共区域内使用，不能相信网络内的其他计算机不会对您的计算机造成危害，只能接收经过选取的连接。</p>

  <p><code class="language-plaintext highlighter-rouge">external</code>（外部）</p>

  <p>特别是为路由器启用了伪装功能的外部网。您不能信任来自网络的其他计算，不能相信它们不会对您的计算机造成危害，只能接收经过选择的连接。</p>

  <p><code class="language-plaintext highlighter-rouge">dmz</code>（非军事区）</p>

  <p>用于您的非军事区内的电脑，此区域内可公开访问，可以有限地进入您的内部网络，仅仅接收经过选择的连接。</p>

  <p><code class="language-plaintext highlighter-rouge">work</code>（工作）</p>

  <p>用于工作区。您可以基本相信网络内的其他电脑不会危害您的电脑。仅仅接收经过选择的连接。</p>

  <p><code class="language-plaintext highlighter-rouge">home</code>（家庭）</p>

  <p>用于家庭网络。您可以基本信任网络内的其他计算机不会危害您的计算机。仅仅接收经过选择的连接。</p>

  <p><code class="language-plaintext highlighter-rouge">internal</code>（内部）</p>

  <p>用于内部网络。您可以基本上信任网络内的其他计算机不会威胁您的计算机。仅仅接受经过选择的连接。</p>

  <p><code class="language-plaintext highlighter-rouge">trusted</code>（信任）</p>

  <p>可接受所有的网络连接。</p>
</blockquote>

<p>命令行工具 firewall-cmd 是默认安装的应用程序 firewalld 的一部分。</p>

<ul>
  <li>firewall-cmd 是 firewalld 服务的命令行工具.</li>
</ul>

<p>注意:</p>

<ul>
  <li>为了设置一个永久或者可执行命令，除了 –direct 命令（它们本质上是暂时的）之外，要向所有命令添加 –permanent 选择。注意，这不只是意味着永久更改，而且更改将仅仅在防火墙重新加载、服务器重启或者系统重启之后生效</li>
  <li>缺少 –permanent 选项的设定能立即生效，但是它仅仅在下次防火墙重新加载、系统启动或者 firewalld 服务重启之前可用</li>
</ul>

<p>启用/禁用防火墙:</p>

<ul>
  <li>注: iptable 和 firewall  不能同时使用</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre>systemctl disable firewalld
systemctl stop firewalld
systemctl <span class="nb">enable </span>firewalld
systemctl start firewalld
</pre></td></tr></tbody></table>
</div>
</div>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74</pre></td><td class="code"><pre>
<span class="c">#=====================基本状态查看</span>

<span class="c"># 查看防火墙运行情况</span>
firewall-cmd --state  <span class="c"># running</span>
<span class="c"># 查看本机活跃的网卡</span>
firewall-cmd --get-active-zones  <span class="c"># public interfaces: enp0s9 enp0s3</span>
<span class="c"># 获取public zone 的 内容列表 , public 意思是所有公共可以访问本机的内容.</span>
firewall-cmd --zone<span class="o">=</span>public --list-all  <span class="c"># </span>
<span class="c"># 查看public zone 的网卡</span>
firewall-cmd --zone<span class="o">=</span>public --list-interfaces <span class="c"># enp0s9 enp0s3</span>
<span class="c"># 查看所有public 下的开放端口</span>
firewall-cmd --zone<span class="o">=</span>public --list-ports <span class="c"># 8081/tcp , 这个是之前安装nginx时打开的端口</span>
<span class="c"># 查看某张网卡的区域</span>
firewall-cmd --get-zone-of-interface<span class="o">=</span>enp0s3 <span class="c"># public </span>
<span class="c"># 查看所有活跃的网络区域</span>
firewall-cmd --get-service

<span class="c">#=====================网络开关</span>

<span class="c"># 终止所有数据包的输入和输出的数据包, 终止后一段时间, 所有连接将断掉</span>
firewall-cmd --panic-on
<span class="c"># 恢复/启动 数据传输的输入和输出, </span>
firewall-cmd --panic-off
<span class="c"># 查看panic 模式的状态, no 是关闭, yes 是开启. no 表示不禁止. yes 表示禁止</span>
firewall-cmd --query-panic


<span class="c">#=====================重新加载防火墙</span>

<span class="c"># 不中断的重新加载防火墙</span>
firewall-cmd --reload
<span class="c"># 中断的重新加载防火墙, 通常在防火墙出现严重问题的时候才会用到这个命令</span>
firewall-cmd -complete-reload


<span class="c">#=====================添加网卡接口</span>
firewall-cmd --zone<span class="o">=</span>public --add-interface<span class="o">=</span>em1
firewall-cmd --zone<span class="o">=</span>public --list-interface

<span class="c">#======================设置默认zone 区域</span>
vim /etc/firewalld/firewalld.conf 设置 <span class="nv">DefaultZone</span><span class="o">=</span>home
<span class="c">#或者</span>
firewall-cmd --set-default-zone<span class="o">=</span>public

<span class="c">#====================开放一个端口</span>
<span class="c">#增加 --permanent 选项并重新加载防火墙，使之成为永久性设置</span>
firewall-cmd --zone<span class="o">=</span>public --add-port<span class="o">=</span>8080/tcp 
firewall-cmd --zone<span class="o">=</span>public --add-port<span class="o">=</span>5060-5061/udp  <span class="c"># 增加一系列端口, 用 -</span>
firewall-cmd --zone<span class="o">=</span>public --list-ports <span class="c"># 8081/tcp 8080/tcp 5060-5061/udp , 加进去了.</span>
firewall-cmd --reload

<span class="c">#====================将一个服务添加/删除 zone 区</span>
firewall-cmd --zone<span class="o">=</span>work --add-service<span class="o">=</span>smtp
firewall-cmd --zone<span class="o">=</span>work --remove-service<span class="o">=</span>smtp
firewall-cmd --reload

<span class="c">#====================配置端口转发</span>
<span class="c"># 要将进入网络的程序包从一个端口转发到一个替代端口或者地址, 首先, 在external zong 允许伪装IP</span>
firewall-cmd --zone<span class="o">=</span>external --add-masquerade  
<span class="c"># 将本来要送到 22 端口的程序包转发到 3753 端口。源目的端口用 port 选项指定。这个选项可以是一个端口，或者一组端口范围并加上协议。如果指定协议的话，这个协议必须是 tcp 或 udp。这个新的本地端口，即流量被转发过去的端口或者端口范围，需用 toport 选项指定。增加 --permanent 选项并重新加载防火墙，可以使设置永久保存。</span>
firewall-cmd --zone<span class="o">=</span>external --add-forward-port<span class="o">=</span><span class="nv">port</span><span class="o">=</span>22:proto<span class="o">=</span>tcp:toport<span class="o">=</span>3753 
<span class="c"># 原本发往22端口的程序包现在被转发到相同的端口，地址则由 toaddr 提供。</span>
firewall-cmd --zone<span class="o">=</span>external --add-forward-port<span class="o">=</span><span class="nv">port</span><span class="o">=</span>22:proto<span class="o">=</span>tcp:toaddr<span class="o">=</span>192.0.2.55
<span class="c"># 转发既改变端口号, 也指定IP</span>
firewall-cmd --zone<span class="o">=</span>external --add-forward-port<span class="o">=</span><span class="nv">port</span><span class="o">=</span>22:proto<span class="o">=</span>tcp:toport<span class="o">=</span>2055:toaddr<span class="o">=</span>192.0.2.55


<span class="c">#====================增加/删除一个自定义规则  </span>
<span class="c"># 使用 --direct 选项在运行时间里增加或者移除 规则</span>
<span class="c"># 创建一个叫做 IN_public_allow 的规则: </span>
firewall-cmd --direct --add-rule ipv4 filter IN_public_allow 0 -m tcp -p tcp --dport 666 -j ACCEPT
<span class="c"># 删除一个叫做 IN_public_allow 的规则: </span>
firewall-cmd --direct --remove-rule ipv4 filter IN_public_allow 0 -m tcp -p tcp --dport 666 -j ACCEPT
</pre></td></tr></tbody></table>
</div>
</div>

<p>限制某IP 禁止访问ssh 服务</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>firewall-cmd --permanent --add-rich-rule<span class="o">=</span><span class="s1">'rule family=ipv4 source address="123.44.55.66" drop'</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="富规则">富规则</h3>

<p>概念</p>

<blockquote>
  <p>通过 “rich language” 语法，可以用比直接接口方式更易理解的方法建立复杂防火墙规则。此外，还能永久保留设置。这种语言使用关键词值，是 iptables 工具的抽象表示。这种语言可以用来配置分区，也仍然支持现行的配置方式。</p>
</blockquote>

<p>语法:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre>rule <span class="o">[</span><span class="nv">family</span><span class="o">=</span><span class="s2">"&lt;rule family&gt;"</span><span class="o">]</span>  <span class="c"># {ipv4|ipv6|}</span>
    <span class="o">[</span> <span class="nb">source </span><span class="nv">address</span><span class="o">=</span><span class="s2">"&lt;address&gt;"</span> <span class="o">[</span><span class="nv">invert</span><span class="o">=</span><span class="s2">"True"</span><span class="o">]</span> <span class="o">]</span> <span class="c"># ip 地址可以用 /线 来指定区间</span>
    <span class="o">[</span> destination <span class="nv">address</span><span class="o">=</span><span class="s2">"&lt;address&gt;"</span> <span class="o">[</span><span class="nv">invert</span><span class="o">=</span><span class="s2">"True"</span><span class="o">]</span> <span class="o">]</span> <span class="c"># ip 地址可以用 /线 来指定区间</span>
    <span class="o">[</span> &lt;element&gt; <span class="o">]</span> <span class="c"># 规则元素只能是 service ， port ， protocol ， masquerade ， icmp-block 和 forward-port  中的一个 </span>
    <span class="o">[</span> log <span class="o">[</span><span class="nv">prefix</span><span class="o">=</span><span class="s2">"&lt;prefix text&gt;"</span><span class="o">]</span> <span class="o">[</span><span class="nv">level</span><span class="o">=</span><span class="s2">"&lt;log level&gt;"</span><span class="o">]</span> <span class="o">[</span>limit <span class="nv">value</span><span class="o">=</span><span class="s2">"rate/duration"</span><span class="o">]</span> <span class="o">]</span>
    <span class="o">[</span> audit <span class="o">]</span>
    <span class="o">[</span> accept|reject|drop <span class="o">]</span> <span class="c">#只能是其中一个</span>
</pre></td></tr></tbody></table>
</div>
</div>

<ul>
  <li>上面的规则元素只能是 service ， port ， protocol ， masquerade ， icmp-block 和 forward-port  中的一个
    <ul>
      <li>firewall-cmd –get-services 获得所有被预定义的 service.</li>
      <li>firewall-cmd –list-services 获得所有已经添加到zone 中的 services</li>
      <li>vim /etc/protocols 可以查看所有支持的protocol</li>
    </ul>
  </li>
</ul>

<p>对特定ip 禁止访问shh服务  （ip  shh可以自己改别的  最后面的reject是禁止的意思也可以换成允许的英文，）</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>firewall-cmd --permanent --zone<span class="o">=</span>public --add-rich-rule<span class="o">=</span><span class="s2">"rule family="</span>ipv4<span class="s2">" source address="</span>192.168.10.0/24<span class="s2">" service name="</span>ssh<span class="s2">" reject"</span> 
firewall-cmd --reload <span class="c"># 让规则生效</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>下面的是对特定ip允许访问8080端口（你也可以自己改）</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>firewall-cmd --permanent --zone<span class="o">=</span>public --add-rich-rule<span class="o">=</span><span class="s2">"rule family="</span>ipv4<span class="s2">" source address="</span>192.168.0.4/24<span class="s2">" port protocol="</span>tcp<span class="s2">" port="</span>8080<span class="s2">" accept"</span>
firewall-cmd --reload <span class="c"># 让规则生效</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>列出已经添加的富规则</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>firewall-cmd  --list-rich-rules  <span class="c"># 如果之前没有 firewall-cmd --reload, 那么这里可能看不到</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>讲一个IP地址加入白名单</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>rule <span class="nv">family</span><span class="o">=</span><span class="s2">"ipv4"</span> <span class="nb">source </span><span class="nv">address</span><span class="o">=</span><span class="s2">"192.168.2.2"</span> accept
</pre></td></tr></tbody></table>
</div>
</div>

<p>删除已经添加的富规则</p>

<blockquote>
  <p>方法就是先 <code class="language-plaintext highlighter-rouge">firewall-cmd  --list-rich-rules</code> 看输出的规则列表, 然后想删哪个就把这条拷贝出来黏贴到 –remove-rich-rule 的参数中</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre>firewall-cmd --remove-rich-rule<span class="o">=</span><span class="s2">"rule family="</span>ipv4<span class="s2">" source address="</span>192.168.10.0/24<span class="s2">" service name="</span>ssh<span class="s2">" reject"</span>

firewall-cmd --remove-rich-rule<span class="o">=</span><span class="s2">"rule family="</span>ipv4<span class="s2">" source address="</span>192.168.0.4/24<span class="s2">" port port="</span>8080<span class="s2">" protocol="</span>tcp<span class="s2">" accept"</span>

firewall-cmd  --list-rich-rules

firewall-cmd --reload
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="iptables-是防火墙centos6中使用"><code class="language-plaintext highlighter-rouge">iptables</code> 是防火墙(centos6中使用)</h3>

<ul>
  <li>操作: <code class="language-plaintext highlighter-rouge">service iptables start|stop|restart|status</code></li>
  <li>永久关闭: chkconfig iptables off</li>
  <li>配置文件: /etc/sysconfig/iptables-config</li>
  <li>规则管理:
    <ul>
      <li>单次生效: iptables 命令</li>
      <li>永久生效: 修改配置文件 vim /etc/sysconfig/iptables-config</li>
    </ul>
  </li>
</ul>

<p>举例, 限制某IP ssh 登录本机</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6</pre></td><td class="code"><pre>iptables -A INPUT -s 10.11.56.93 -p tcp --dport 22 -j REJECT
<span class="c"># A 决定</span>
<span class="c"># -s 是源头</span>
<span class="c"># -p protocal 类型</span>
<span class="c"># --deport 设置连接类型 22</span>
<span class="c"># -j </span>
</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="远程会话-screen">远程会话 <code class="language-plaintext highlighter-rouge">screen</code></h2>

<p>需求: 系统管理员远程连接服务器. 出现耗时操作, 中间不能间断.</p>

<p>screen 的概念是先创建会话, 会话中可以创建多个窗口. 每个窗口都是一个子会话. 离开窗口或会话后,程序不会断掉.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>yum install -y screen
</pre></td></tr></tbody></table>
</div>
</div>

<ul>
  <li>创建新会话:
    <ul>
      <li>screen -S hello  # 进入新的会话</li>
    </ul>
  </li>
  <li>查看已创建会话:
    <ul>
      <li>screen -ls</li>
    </ul>
  </li>
  <li>暂时离开会话:
    <ul>
      <li>control + a + d</li>
    </ul>
  </li>
  <li>返回一个会话
    <ul>
      <li>screen -r hello # 返回hello 这个会话.</li>
    </ul>
  </li>
  <li>退出并结束一个会话
    <ul>
      <li>exit</li>
    </ul>
  </li>
  <li>在会话外面结束一个会话
    <ul>
      <li>screen -S hello -X quit</li>
    </ul>
  </li>
  <li>在同一个会话中创建多个窗口
    <ul>
      <li>control + a + c</li>
      <li>control + a + w   # 查看所有窗口, 其他中有* 的是当前窗口</li>
    </ul>
  </li>
  <li>在多个窗口中切换
    <ul>
      <li>control + a + a   # 两个窗口来回切换</li>
      <li>control + a + n   # 下一个窗口</li>
      <li>control + a + p   # 上一个窗口</li>
    </ul>
  </li>
  <li>关掉一个窗口
    <ul>
      <li>control + a 松手 k  # 关掉当前窗口</li>
    </ul>
  </li>
</ul>

<h2 id="服务配置软件安装">服务配置/软件安装</h2>

<h3 id="yum-基本命令-list-installedgrep--check-update-update-search-kw-info-包名-install-remove-clean-all-makecache"><code class="language-plaintext highlighter-rouge">yum</code> 基本命令 <code class="language-plaintext highlighter-rouge">list installed|grep , check-update, update, search kw, info 包名, install, remove, clean all, makecache</code></h3>

<blockquote>
  <ul>
    <li>YUM 缩写是 yellowdog updater, modified</li>
    <li>redhat 系列linux 使用 yum 进行软件安装</li>
    <li>yum 是redhat 系列的发行版的软件包管理工具. 可以自动解决包的依赖关系.</li>
    <li>yum 包放在软件仓库中. 可以是redhat 官方的, 可以是阿里,腾讯的.</li>
    <li>yum 的配置文件在 /etc/yum.repos.d/ 目录下</li>
    <li>常用 yum 源.
      <ul>
        <li>网易: mirrors.163.com</li>
        <li>阿里: mirrors.aliyun.com</li>
      </ul>
    </li>
    <li>常用参数:
      <ul>
        <li>-y 安装过程中默认都选yes</li>
        <li>–downloadonly 只下载不安装</li>
        <li>–downloaddir: 指定下载目录</li>
        <li>list installed: 已经安装的软件</li>
        <li>groupinstall: 组件安装</li>
        <li>groupremove: 组件删除</li>
        <li>makecache: 生成缓存, 将源的所有包的信息缓存到本地,可以加快搜索速度</li>
        <li>clean all: 清除缓存,</li>
      </ul>
    </li>
  </ul>
</blockquote>

<p>常用参数和用法:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">yum list installed |grep python</code> 查看已经安装过的包</li>
  <li><code class="language-plaintext highlighter-rouge">yum check-update</code> 检查已安装的包是否有更新</li>
  <li><code class="language-plaintext highlighter-rouge">yum -y update</code> 完整所有软件的更新. -y 是默认同意选项.
    <ul>
      <li>更新完后最好重启一下服务 <code class="language-plaintext highlighter-rouge">reboot</code></li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">yum search keyword</code>  搜索软件名, 可能会列出一大堆</li>
  <li><code class="language-plaintext highlighter-rouge">yum info package_name</code> 查看某个搜出来的包的详细信息</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">yum deplist package_name</code> 查看一个包的依赖关系</p>
  </li>
  <li><code class="language-plaintext highlighter-rouge">yum install 包名</code> 安装软件
    <ul>
      <li><code class="language-plaintext highlighter-rouge">-y</code> 用来默认让所有的问题都回答 yes</li>
      <li><code class="language-plaintext highlighter-rouge">yum install -y 包1 包2 包3</code> 一次安装多个包</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">yum remove 包名</code> 删除安装的包
    <ul>
      <li><code class="language-plaintext highlighter-rouge">yum remove -y 包1 包2 包3</code> 一次删除多个包</li>
      <li><code class="language-plaintext highlighter-rouge">yum remove -y vim*</code> 模糊删除vim 开头的软件包.</li>
    </ul>
  </li>
</ul>

<h3 id="为-yum-添加阿里云镜像">为 yum 添加阿里云镜像</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre>mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup
curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
yum clean all <span class="c"># 清理缓存</span>
yum makecache <span class="c"># 生成缓存</span>
yum -y update <span class="c"># 验证是否已经是aliyun</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="为-yum-添加-网易-镜像">为 yum 添加 网易 镜像</h3>

<p><a href="http://mirrors.163.com/.help/centos.html">网易的帮助</a></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre>mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup
curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.163.com/.help/CentOS7-Base-163.repo
yum clean all <span class="c"># 清理缓存</span>
yum makecache <span class="c"># 生成缓存</span>
yum -y update <span class="c"># 验证是否已经是网易镜像</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="为-yum-添加-epel-源-ius-源">为 <code class="language-plaintext highlighter-rouge">yum</code> 添加 epel 源 IUS 源</h3>

<p>PEL (Extra Packages for Enterprise Linux)是基于Fedora的一个项目，为“红帽系”的操作系统提供额外的软件包，适用于RHEL、CentOS和Scientific Linux.</p>

<p>IUS 源</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>yum install epel-release
yum install https://centos7.iuscommunity.org/ius-release.rpm
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="为-yum-下载加速">为 yum 下载加速</h3>

<p>yum-axelget 是 EPEL 提供的一个 yum 插件。使用该插件后用 yum 安装软件时可以并行下载，大大提高了软件的下载速度，减少了下载的等待时间:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>yum install yum-axelget
yum update
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="用yum-安装基础开发环境">用yum 安装基础开发环境</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10</pre></td><td class="code"><pre>yum install gcc                     <span class="c"># C 编译器</span>
yum install gcc-c++                 <span class="c"># C++ 编译器</span>
yum install gcc-gfortran            <span class="c"># Fortran 编译器</span>
yum install compat-gcc-44           <span class="c"># 兼容 gcc 4.4</span>
yum install compat-gcc-44-c++       <span class="c"># 兼容 gcc-c++ 4.4</span>
yum install make
yum install gdb     <span class="c"># 代码调试器</span>
yum install cmake   <span class="c"># Cmake</span>
yum install git     <span class="c"># 版本控制</span>
yum install ntfs-3g <span class="c"># CentOS 下默认无法挂载 NTFS 格式的硬盘。需安装 nfts-3g 即可实现即插即用</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="rpm-包的安装和使用---ivh--uvh--qlp--qip--ql--qf--qagrep"><code class="language-plaintext highlighter-rouge">RPM</code> 包的安装和使用  <code class="language-plaintext highlighter-rouge">-ivh, -Uvh, -qlp, -qip, -ql, -qf, -qa|grep</code></h3>

<ul>
  <li>说明: RPM 是  redhat package manager 的缩写, 现在是 PRM Package Manager 的缩写.</li>
  <li>也是redhat 系列发行版的软件包.后缀 (.rpm)</li>
  <li>rpm 包通常都依赖其他软件包.</li>
</ul>

<p>命令和参数:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10</pre></td><td class="code"><pre>rpm <span class="c"># 命令</span>
-i: 安装
-e: 卸载
-v: 显示安装信息
-h: 显示安装进度
-U: 更新
-q: 查询
-qa: 查询所有
-ql: 显示rpm软件包的安装目录
-qf: 查询该文件是哪个rpm软件包安装的
</pre></td></tr></tbody></table>
</div>
</div>

<p>常用参数组合 <code class="language-plaintext highlighter-rouge">-ivh, -Uvh, -qlp, -qip, -ql, -qf, -qa|grep</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre>rpm -ivh remi-release-7.rpm : 安装
rpm -Uvh remi-release-7.rpm : 升级
rpm -qlp remi-release-7.rpm : 查看包会安装什么文件
rpm -qip remi-release-7.rpm : 查看包的说明书
rpm -ql vim-enhanced-7.4.160-2.el7.x86_64  :  查看已安装的包装了什么文件
rpm -qf /usr/bin/vim		: 查看一个文件是什么包装的
rpm -qa|grep vim 			: 搜索一个曾经装过的包
</pre></td></tr></tbody></table>
</div>
</div>

<p>实例:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16</pre></td><td class="code"><pre>yum remove -y vim<span class="k">*</span> <span class="c">#删除</span>
yum install -y vim --downloadonly --downloaddir ./  <span class="c"># 下载vim 三个软件包到当前目录</span>
rpm -ivh vim-filesystem-7.4.160-2.el7.x86_64.rpm
rpm -ivh vim-common-7.4.160-2.el7.x86_64.rpm
rpm -ivh vim-enhanced-7.4.160-2.el7.x86_64.rpm

rpm -ql vim-enhanced-7.4.160-2.el7.x86_64 <span class="c"># 查看软件包将把文件安装到哪个目录. 包名不要带后缀</span>
<span class="c">#/etc/profile.d/vim.csh</span>
<span class="c">#/etc/profile.d/vim.sh</span>
<span class="c">#/usr/bin/rvim</span>
<span class="c">#/usr/bin/vim</span>
<span class="c">#/usr/bin/vimdiff</span>
<span class="c">#/usr/bin/vimtutor</span>
rpm -qf /etc/profile.d/vim.sh <span class="c"># 查看某个文件是哪个软件包安装的.</span>
<span class="c">#vim-enhanced-7.4.160-2.el7.x86_64</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="原码安装-configure--make--make-install--php72-python37安装为例子">原码安装 <code class="language-plaintext highlighter-rouge">.configure,  make,  make install</code>  <code class="language-plaintext highlighter-rouge">PHP7.2 Python3.7安装为例子</code></h3>

<p>基本步骤:</p>

<ol>
  <li>下载源码包 wget</li>
  <li>解压: <code class="language-plaintext highlighter-rouge">tar -zxvf 包</code></li>
  <li>进入解压的目录</li>
  <li>准备依赖包和编译工具(gcc) <code class="language-plaintext highlighter-rouge">yum install -y gcc</code></li>
  <li>配置: <code class="language-plaintext highlighter-rouge">configure</code> 一般包中都有一个配置文件</li>
  <li>编译: <code class="language-plaintext highlighter-rouge">make</code> 预编译 =&gt; 编译 =&gt; 汇编 =&gt;</li>
  <li>安装: <code class="language-plaintext highlighter-rouge">make install</code></li>
</ol>

<p>实例演示php7.2:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre></td><td class="code"><pre><span class="nb">cd</span> /root/code/
wget http://cn2.php.net/distributions/php-7.2.0.tar.gz
tar -zxvf php-7.2.0.tar.gz
<span class="nb">cd </span>php-7.2.0
vi ./configure <span class="c"># 可以看配置文件中有哪些参数和内容</span>
./configure --prefix<span class="o">=</span>/usr/local/php7
<span class="c"># 报错 configure: error: no acceptable C compiler found in $PATH</span>
yum install -y gcc
./configure --prefix<span class="o">=</span>/usr/local/php7
<span class="c"># 又报错 configure: error: xml2-config not found. Please check your libxml2 installation.</span>
yum install libxml2
yum install libxml2-devel -y
./configure --prefix<span class="o">=</span>/usr/local/php7
make <span class="o">&amp;&amp;</span> make install
<span class="c"># 为命令创建软链接到 PATH 对应的目录下</span>
ln -s /usr/local/php7/bin/php /root/bin/php
<span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>/usr/local/php7/bin/:<span class="nv">$PATH</span>
<span class="nb">echo</span> <span class="nv">$PATH</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>实例演示Python 3.7</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10</pre></td><td class="code"><pre>wget https://www.python.org/ftp/python/3.7.0/Python-3.7.0a3.tgz
tar -zxvf Python-3.7.0a3.tgz
<span class="nb">cd </span>Python-3.7.0a3
./configure --prefix<span class="o">=</span>/usr/local/python3.7
make <span class="o">&amp;&amp;</span> make install
<span class="c">#报错了提示少了个 _ctype ,网上查说少了个  libffi-devel</span>
yum install libffi-devel
make <span class="o">&amp;&amp;</span> make install
ln -s /usr/local/python3.7/bin/python3.7 /root/bin/python3.7
ln -s /usr/local/python3.7/bin/pip3.7 /root/bin/pip3.7
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="压缩解压缩软件-zip-unzip">压缩解压缩软件 <code class="language-plaintext highlighter-rouge">zip unzip</code></h3>

<p><code class="language-plaintext highlighter-rouge">zip unzip</code></p>

<ul>
  <li>
    <p>使用: linux 下没有自带,需要安装</p>
  </li>
  <li>
    <p>yum install -y zip unzip</p>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre><span class="c"># 压缩解压命令</span>
zip  a.zip ./<span class="k">*</span>.<span class="k">*</span>  <span class="c"># 压缩当前目录所有文件</span>
unzip a.zip
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="压缩解压缩软件gzipgunzip">压缩解压缩软件<code class="language-plaintext highlighter-rouge">gzip/gunzip</code></h3>

<ul>
  <li>说明,只能对文件进行压缩,不能压缩目录, 压缩文件以.gz结尾</li>
  <li>gzip -d 也可以解压缩</li>
  <li>压缩文件不会保留原有文件. 解压缩也不会保留原有压缩包</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>gzip ./<span class="k">*</span>.<span class="k">*</span>  

gunzip ./<span class="k">*</span>.<span class="k">*</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="压缩解压缩软件bzip2bunzip2">压缩解压缩软件<code class="language-plaintext highlighter-rouge">bzip2/bunzip2</code></h3>

<ul>
  <li>yum install bzip2 bunzip2</li>
  <li>说明: 使用方式和gzip/gunzip 一样. 默认后缀为.bz2</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>bzip2 1.html
bunzip2 -k 1.html.bz2  <span class="c"># 加 -k 参数可以保留压缩文件. </span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="打包解包-tar--zxvf--zcvf">打包解包 <code class="language-plaintext highlighter-rouge">tar</code> <code class="language-plaintext highlighter-rouge">-zxvf -zcvf</code></h3>

<ul>
  <li>可以打包,解包, 压缩, 解压, 包后缀是.tar</li>
  <li>选项: (头三个参数互斥) , 最常用的组合 -zcvf -zxvf
    <ul>
      <li>-c 打包, 创建新包</li>
      <li>-x 解包,</li>
      <li>-t 看看包里有什么, 但不打开</li>
      <li>-f 指定文件</li>
      <li>-v 命令输出详细信息</li>
      <li>-z 调用gzip/gunzip 压缩/解压</li>
      <li>-j 调用bzip2/bunzip2 压缩/解压</li>
      <li>-C 大C 指定压缩到的目录</li>
      <li>–exclude: 排除</li>
    </ul>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19</pre></td><td class="code"><pre>
<span class="c"># ==========打包/拆包</span>
tar -cvf city.tar city2.html city3.html   <span class="c"># 将 2个文件达成一个包. 并不压缩</span>
tar -tf city.tar  <span class="c"># 查看包中的文件</span>
tar -xvf city.tar <span class="c"># 拆包</span>

<span class="c"># =========打包压缩/拆包解压缩 gzip</span>
tar -zcvf city.tar.gz city2.html city3.html   <span class="c"># 将 2个文件达成一个包. 并不压缩</span>
tar -tf city.tar.gz  <span class="c"># 查看包中的文件</span>
tar -zxvf city.tar.gz <span class="c"># 拆包</span>

<span class="c"># =========打包压缩/拆包解压缩 bzip2</span>
tar -jcvf city.tar.bz2 city2.html city3.html   <span class="c"># 将 2个文件达成一个包. 并不压缩</span>
tar -tf city.tar.bz2  <span class="c"># 查看包中的文件</span>
tar -jxvf city.tar.bz2 <span class="c"># 拆包</span>

<span class="c"># =========排除一个, 其他进行压缩</span>
tar -zcvf city.tar.gz <span class="k">*</span>.html --exclude city.html  <span class="c"># 排除了city.html , 其他进行压缩.</span>

</pre></td></tr></tbody></table>
</div>
</div>

<p>文件名缩写:</p>

<p>.tar.gz  缩写 tgz</p>

<p>.tar.bz2 缩写 tbz2</p>

<h3 id="安装桌面环境">安装桌面环境</h3>

<p>注释: 提前用virtual box 拍快照, 如果不想要, 还可以恢复回来</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>yum groupinstall -y Desktop  <span class="c"># 安装桌面</span>
yum groupinstall -u chinese-support <span class="c"># 安装中文支持</span>
init 5 <span class="c"># 启动桌面</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="mariadb-安装">MariaDB 安装</h3>

<ul>
  <li>配置 MariaDB 的源, 创建新文件 <code class="language-plaintext highlighter-rouge">vi /etc/yum.repos.d/MariaDB.repo</code></li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre><span class="o">[</span>mariadb]
name <span class="o">=</span> MariaDB
baseurl <span class="o">=</span> http://yum.mariadb.org/10.1/centos7-amd64
<span class="nv">gpgkey</span><span class="o">=</span>https://yum.mariadb.org/RPM-GPG-KEY-MariaDB
<span class="nv">gpgcheck</span><span class="o">=</span>1
</pre></td></tr></tbody></table>
</div>
</div>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>yum install -y MariaDB-server MariaDB-client
systemctl start mariadb
systemctl <span class="nb">enable </span>marriadb
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="mysql-安装--安装了-mariadb-就不需要装-mysql-了">mysql 安装 ( 安装了 MariaDB 就不需要装 mysql 了)</h3>

<ul>
  <li>yum search mysql</li>
  <li>yum install mysql-server mysql</li>
  <li>service mysqld start</li>
  <li>vi /etc/rc.d/rc.local  # 增加一行<code class="language-plaintext highlighter-rouge">service mysqld start</code></li>
</ul>

<h3 id="mongodb-安装">mongodb 安装</h3>

<ul>
  <li>
    <p>vi <code class="language-plaintext highlighter-rouge">/etc/yum.repos.d/mongodb-org-3.4.repo</code>  # 配置MongoDB的yum源</p>
  </li>
  <li>
    <div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6</pre></td><td class="code"><pre><span class="o">[</span>mongodb-org-3.4]  
<span class="nv">name</span><span class="o">=</span>MongoDB Repository  
<span class="nv">baseurl</span><span class="o">=</span>https://repo.mongodb.org/yum/redhat/<span class="nv">$releasever</span>/mongodb-org/3.4/x86_64/  
<span class="nv">gpgcheck</span><span class="o">=</span>1  
<span class="nv">enabled</span><span class="o">=</span>1  
<span class="nv">gpgkey</span><span class="o">=</span>https://www.mongodb.org/static/pgp/server-3.4.asc
</pre></td></tr></tbody></table>
</div>
    </div>
    <div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>yum -y install mongodb-org
systemctl start mongod
systemctl <span class="nb">enable </span>mongod
</pre></td></tr></tbody></table>
</div>
    </div>

    <p>​</p>
  </li>
</ul>

<h3 id="redis-安装">redis 安装</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>yum install -y redis
systemctl start redis
systemctl <span class="nb">enable </span>redis.service
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="python36-和-pip36-安装">python3.6 和 pip3.6 安装</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre>yum install -y python36u
yum install -y python36u-pip
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="apache-服务安装">Apache 服务安装</h3>

<p><a href="http://blog.csdn.net/smstong/article/details/39343543">网上文章</a></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre>yum install -y httpd
systemctl start httpd.service
systemctl <span class="nb">enable </span>httpd.service
firewall-cmd --permanent --add-service<span class="o">=</span>http
</pre></td></tr></tbody></table>
</div>
</div>

<ul>
  <li>
    <p>vim /var/www/html/index.html  # 为apache 创建第一个测试html 程序</p>
  </li>
  <li>
    <p>firewall-cmd –add-service=http  # 打开防火墙的80端口.</p>

    <ul>
      <li>此时, 局域网其他机器打开浏览器访问该主机的ip地址就应该可以看到网页内容了</li>
    </ul>
  </li>
  <li>
    <p>firewall-cmd –permanent –add-service=http  # 写入配置文件</p>

    <ul>
      <li>
        <p>此时，httpd这个服务添加到了<code class="language-plaintext highlighter-rouge">/etc/firewalld/zones/public.xml</code>这个zone配置文件中，所以firewalld才能够据此放行</p>

        <div class="language-xml highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9</pre></td><td class="code"><pre><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;zone&gt;</span>
  <span class="nt">&lt;short&gt;</span>Public<span class="nt">&lt;/short&gt;</span>
  <span class="nt">&lt;description&gt;</span>For use in public areas. You do not trust the other computers on networks to not harm your computer. Only selected incoming connections are accepted.<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;service</span> <span class="na">name=</span><span class="s">"ssh"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;service</span> <span class="na">name=</span><span class="s">"dhcpv6-client"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;service</span> <span class="na">name=</span><span class="s">"http"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/zone&gt;</span>

</pre></td></tr></tbody></table>
</div>
        </div>
      </li>
    </ul>
  </li>
  <li>
    <p>vim /etc/httpd/conf/httpd.conf # 可以对apache 进行配置.</p>
  </li>
</ul>

<h3 id="ntp-网络时间同步-chrony">NTP 网络时间同步 <code class="language-plaintext highlighter-rouge">chrony</code></h3>

<p><code class="language-plaintext highlighter-rouge">Network Time Protocol (NTP)</code> 是 网络时间同步服务</p>

<p><code class="language-plaintext highlighter-rouge">Chrony</code> 是一个开源的自由软件，它能保持系统时钟与时钟服务器（NTP）同步，让时间保持精确。</p>

<p>它由两个程序组成：<code class="language-plaintext highlighter-rouge">chronyd</code> 和 <code class="language-plaintext highlighter-rouge">chronyc</code>。</p>

<p><code class="language-plaintext highlighter-rouge">chronyd</code>是一个后台运行的守护进程，用于调整内核中运行的系统时钟和时钟服务器同步。它确定计算机增减时间的比率，并对此进行补偿。</p>

<p><code class="language-plaintext highlighter-rouge">chronyc</code>提供了一个用户界面，用于监控性能并进行多样化的配置。它可以在chronyd实例控制的计算机上工作，也可以在一台不同的远程计算机上工作。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre>yum install -y chrony
systemctl start chronyd
systemctl status chronyd
systemctl <span class="nb">enable </span>chronyd  <span class="c"># 让chronyd 在开机的时候就自动启动</span>
timedatectl <span class="c"># 查看是否已经同步, yes 就是同步了.</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="dns-服务设置-和自己的host">DNS 服务设置 和自己的host</h3>

<p>vi /etc/resolve.conf # 设置dns 服务商, 可以使用google 的dns 服务.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre># use google for dns
nameserver 8.8.8.8
nameserver 8.8.4.4
</pre></td></tr></tbody></table>
</div>
</div>

<p>设置自己的hosts 名字</p>

<ul>
  <li>
    <p>hostnamectl set-hostname dalongCentOS7</p>
  </li>
  <li>
    <p>hostnamectl status</p>
  </li>
  <li>
    <p>ip addr list</p>
  </li>
  <li>
    <p>vi /etc/hosts # 添加一行</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>127.0.0.1   dalongCentOS7
</pre></td></tr></tbody></table>
</div>
    </div>

    <p>​</p>
  </li>
</ul>

<h3 id="ssh-登录欢迎信息">ssh 登录欢迎信息</h3>

<p><code class="language-plaintext highlighter-rouge">vi /etc/motd</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></td><td class="code"><pre>       
                             ...~OOOOZO....                        
                          .<span class="nv">$OOOOOOOOOOOOOOOO</span>:.                     
                        .OOOZ???IIIIIIIIIIIOOOO.                   
                      .OOZ??..I7777777777II?I7OO.                  
                      ZOZ??.  .7777777777777??7OO.                 
                      OO??7.  .7IIIIIIIIIIII7??OO.                 
                      OO+?IIIIIIIIIIIIIIIIIII??OO.                 
                      OO+??????????????IIIIII??OO.                 
               .OOOOOOOOOOOOOOOOOOOOO??IIIIII?IOO.                 
            .,OOOOOOOOOOOOOOOOOOOOOOO??IIII?<span class="nv">$IIOO</span>..........        
           .,OO++++++++++++++++++++++++?7<span class="nv">$$$$</span>IIOO7777777777..      
           .OO++???????????<span class="nv">$$$$$$$$$$$$$$$$$$</span>IIOO77:::::::<span class="nv">$77</span>.     
          .OO+++????+I7777777<span class="nv">$$$$$$$$$$$$$$$$</span>IIOO77::~~~~::77.     
          .OO+++++77777777777<span class="nv">$$$$$$$$$$$$$$$II$OO77</span>::~~~~~::77.    
         .OO<span class="o">==</span>++7777777777777<span class="nv">$$$$$$$$$$$$$$</span>IIIOO77,,:~~~~~,:<span class="nv">$7</span>.    
         .OO<span class="o">==</span>77777777777<span class="nv">$IIIIIIIIIIIIIIIIIIOOO77I</span>,,:::::::,:77    
          OO?I777777777<span class="nv">$IIIIOOOOOOOOOOOOOOOOOO77</span><span class="o">=</span>,,::::::::,,77.   
         .OOII77777777IIIOOOO?77777777777777777,,,:::::::::,:77.   
         .OOII<span class="nv">$777777IIIOOO777777777777777$:</span>,,,,::::::::::<span class="o">=</span>::77.   
          ~OOII777777IIOO777,,,,,,,,,,,,,,,,,,::::::::~+<span class="o">===</span>:~77    
          .OOII<span class="nv">$7777IIOOI77</span>,,,,,,,,,,,,,:<span class="o">===</span>++++++<span class="o">========</span>~:<span class="o">=</span>77    
          .ZO7II7777IIOO77,,,,,,,,,~+<span class="o">=</span>++++++++++++++++++++~~77.    
           .OOIIIIIIIIZO77,.,,,,<span class="o">=</span>++++++++++++++++++++++++~~I77     
            .OOOIIIIIIZO77..,,++++++++++++++++++++++++++~~~77.     
             ..OOOOOOOOO77..++++++~~~~~~~~~~~~~~~~~~~~~~~~77..     
                 .......77:~++++++~~77777777777777777777777.       
                       .<span class="nv">$7</span>~~++++++~~~~~~~~~~~~~~~7<span class="nv">$.</span>......         
                  ...,,,<span class="nv">$7</span>~~++++++~~~~~~~~~~~~~~~77,...            
                .,,::~~<span class="o">=</span>77~~+++++++++++++++..++~~77~::,,.          
             ..,,:~~<span class="o">==</span>++<span class="nv">$7</span>~~++++++++++++++.  .+~~77<span class="o">==</span>~~:,,..       
            ..,::~<span class="o">==</span>++?I777~~<span class="o">=</span>++++++++++++....~~77?++<span class="o">==</span>~::,..      
            .,,::~<span class="o">=</span>++??I7777~~~~~~++++++<span class="o">=</span>~~~~~7777??+<span class="o">==</span>~::,,.      
            ..,,:~~<span class="o">==</span>+??I7777777~~~~~~~~~~+<span class="nv">$7777I</span>??+<span class="o">==</span>~~:,,.       
              ..,::~~<span class="o">==</span>++??II7777777777777777I??++<span class="o">==</span>~~::,..        
                 ..,,::~~<span class="o">====</span>++++?????????+++<span class="o">==</span>~~~::,,..           
                   . ...,,,:::::~~~~~~~~~:::::,,,... .             
                            .. ........... ..                      
                                                                   
                                                    Dalong.com
</pre></td></tr></tbody></table>
</div>
</div>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></td><td class="code"><pre>
           . ....,~?III7IIIII?~......:<span class="o">=</span>7<span class="nv">$ZZZZZZZZZZZZZ7</span>~....
           ..:+IIIIIIIIIIIII?:...<span class="o">=</span><span class="nv">$ZZZZZZZZZZZZZZZ$$ZZZZZ</span><span class="o">=</span>..
       ....~IIIIIIIIIIIIII+,..~<span class="nv">$ZZZZZZZZZZZZZZZZZ</span>:..~ZZZZO+.
       ..<span class="o">=</span>IIIIIIIIIIIIII+...+ZZZZZZZZZZZZZZZZZZZZ+..?ZZZZZZ.
   ....~IIIIIIIIIIIII7I~..<span class="o">=</span>ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZOZ+
   ...?7IIIIIIIIIIIII+..:ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZI.
   .,?7IIIIIIIIIIIII~..?OZZZZZZZZZZZZZZZZZZZZZZZZ+..........
....?IIIIIIIIIIIIII~..7ZZZZZZZZZZZZZZZZZZZZZZZZZZZZ7+<span class="o">=</span>~<span class="o">=</span>??..
...?IIIIIIIIIIIIII:..<span class="nv">$ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ$~</span>...
..<span class="o">=</span>IIIIIIIIIIIIII?..<span class="nv">$ZZZZZZZZZZZZZZZZZZZZ$7I</span>++++++++<span class="o">=</span>:..    
.,IIIIIIIIIIIIIII..7ZZZZZZZZZZZZZZZOOZ?.................    
.<span class="o">=</span>IIIIIIIIIIIIII:.:ZZZZZZZZZZZZZZZZZ+...:+IIIII?........    
,?IIIIIIIIIIIII?..<span class="nv">$ZZZZZZZZZZZZZZZ$.</span>.,+IIIIIIIII,....       
,IIIIIIIIIIIIII:.,ZZZZZZZZZZZZZZZI..<span class="o">=</span>IIIIIIIIIII:....       
:IIIIIIIIIIII7I..?ZZZZZZZZZZZZZZ<span class="nv">$.</span>.~IIIIIIIIIIII~....       
:IIIIIIIIIIIII?..7ZZZZZZZZZZZZZZ,.,IIIIIIIIIIIII~....       
:IIIIIIIIIIII7I,.<span class="o">=</span>ZZZZZZZZZZZZZ<span class="nv">$.</span>.+IIIIIIIIIIIII~....       
:IIIIIIIIIIIIII+..<span class="nv">$ZZZZZZZZZZZZ</span>,.:IIIIIIIIIIIIII,....       
:IIIIIIIIIIIIIII~..7ZZZZZZZZZZ,..IIIIIIIIIIIIIII.....       
:IIIIIIIIIIIIIIII+...+<span class="nv">$ZZZ$I</span>:..~IIIIIIIIIIIIIII?..          
:IIIIIIIIIIIIIIIIII+,........~IIIIIIIIIIIIIIIII,.           
:IIIIIIIIIIIIIIIIIIIIII?++IIIIIIIIIIIIIIIIIIII<span class="o">=</span>...          
:IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII+...           
:IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII?,....          
:IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII~..              
,IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII,...              
:IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII+,..................
,I7IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII~...<span class="nv">$ZZZZZZZZZZZZI</span>....
,IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII:...+ZZZZZZZZZZZZZZZZ+..
:IIIIIIIIIIIII?,~?IIIIIIIIII7II?<span class="o">=</span>,...:7ZZZZZZZZZZZZZZZZZZOI.
,IIIIIIIIIIIII?.....,,:~~~::,.....,?ZZZZZZZZZZZZZZZZZZZZZZZ.
,IIIIIIIIIIIII?....       ..,<span class="o">=</span>I<span class="nv">$ZZZZZZZZZZZZZZZZZZZZZZZZZZZ</span>+
,IIIIIIIIIIIII?....       .,<span class="nv">$ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ</span>,
,IIIIIIIIIIIII?....       ...,7<span class="nv">$ZZZZZZZZZZZZZZZZZZZZZZZZZZ7</span>.
:IIIIIIIIIIIII?....         . ..:IZZZZZZZZZZZZZZZZZZZZZZZI..
,IIIIIIIIIIII7I....           .....,<span class="o">=</span>7ZZZZZZZZZZZZZZZZZ<span class="nv">$:</span>...
.,,,,,,,,,,,,.,....               ..  .....,,:::,,,,,....   
...................                   ...................   
                                             Dalong.com
</pre></td></tr></tbody></table>
</div>
</div>

<p><code class="language-plaintext highlighter-rouge">vim /etc/profile.d/motd.sh</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>
<span class="nb">echo</span> -e <span class="s2">"
##################################
#
# Welcome to </span><span class="sb">`</span>hostname<span class="sb">`</span><span class="s2">, you are logged in as </span><span class="sb">`</span>whoami<span class="sb">`</span><span class="s2">
# This system is running </span><span class="sb">`</span>cat /etc/redhat-release<span class="sb">`</span><span class="s2">
# kernel is </span><span class="sb">`</span>uname -r<span class="sb">`</span><span class="s2">
# Uptime is </span><span class="sb">`</span>uptime | sed <span class="s1">'s/.*up ([^,]*), .*/1/'</span><span class="sb">`</span><span class="s2">
# Mem total </span><span class="sb">`</span>cat /proc/meminfo | grep MemTotal | awk <span class="o">{</span><span class="s1">'print $2'</span><span class="o">}</span><span class="sb">`</span><span class="s2"> kB
###################################"</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="日志管理及服务-journald">日志管理及服务 journald</h3>

<p>centos7 自带了系统日志功能（journald），取代了syslog后台程序。journald的配置文件位于  <code class="language-plaintext highlighter-rouge">/etc/systemd/journald.conf</code></p>

<p><strong>基本命令</strong></p>

<ul>
  <li>
    <p>journalctl # 查看所有系统日志</p>
  </li>
  <li>
    <p>journalctl –since “2017-12-26 15:00:00” –until “2017-12-26 16:00:00”  # 查看指定时间段的log</p>
  </li>
  <li>
    <p>journalctl -u httpd.service –since “yesterday” # 查看从昨天到现在的所有阿帕奇日志</p>
  </li>
  <li>
    <p>journalctl -p err -b  # 查看所有错误日志</p>
  </li>
  <li>
    <p>journalctl -f 实时最终最新的日志输出</p>
  </li>
  <li>
    <p>journalctl –boot=-1  # 查看刚刚启动的时候的错误信息.</p>

    <p>​</p>
  </li>
</ul>

<p><strong>日志持久化</strong></p>

<blockquote>
  <p>journald 产生的日志会在每次重启后被删除 , 默认存放目录是 /run/log/journal, 所以如果想要把日志持久的保留下来,需要做如下操作.</p>
</blockquote>

<ul>
  <li>mkdir /var/log/journal  # 为journald 创建存放日志的目录</li>
  <li>systemd-tmpfiles –create –prefix /var/log/journal   # 更改日志目录的系统权限</li>
  <li>systemctl restart systemd-journald
    <ul>
      <li>这时应该就可以在新的目录下看到日志文件了.</li>
    </ul>
  </li>
  <li>journalctl –boot=-1  # 查看重启后日志是否正常</li>
</ul>

<h3 id="用户管理-useradd-groupadd">用户管理 useradd groupadd</h3>

<ul>
  <li>cat /etc/passwd # 列出所有系统用户</li>
  <li>id root  # 查看root 用户的 uid, gid 信息</li>
  <li>useradd dalong</li>
  <li>passwd dalong</li>
  <li>groupadd py1702</li>
  <li>usermod -G py1702 dalong</li>
  <li>id dalong</li>
  <li>userdel dalong</li>
  <li>groupdel py1702</li>
</ul>

<h3 id="设置定时任务-cron">设置定时任务 cron</h3>

<ul>
  <li>
    <p>crontab -e  # 编辑当前用户的定时任务</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="k">*</span>/5 <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="nb">echo</span> <span class="sb">`</span>date<span class="sb">`</span> <span class="s2">"Hello world"</span> &gt;&gt;<span class="nv">$HOME</span>/cron-helloworld.txt
</pre></td></tr></tbody></table>
</div>
    </div>

    <p>保存后会输出: crontab: installing new crontab</p>
  </li>
  <li>
    <p>cat ~/cron-helloworld.txt # 可以查看每过5分钟插入一条数据</p>
  </li>
  <li>
    <p>cat /var/log/cron</p>
  </li>
  <li>
    <p>五颗星</p>

    <ul>
      <li>
        <p><code class="language-plaintext highlighter-rouge">&lt;分钟&gt; &lt;小时&gt; &lt;日/月&gt; &lt;月&gt; &lt;日/周&gt; &lt;命令&gt;</code></p>
      </li>
      <li>
        <p>一个或两个空格分割</p>
      </li>
      <li>
        <p>分钟0-59 , 小时0-23, 日1-31, 月1-12, 日1-7.</p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">/</code>每 .</p>

        <ul>
          <li>比如: */5 每5分钟  , */1 每1分钟</li>
        </ul>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">-</code>跨度 .</p>

        <ul>
          <li>比如: 1-5 周一到周五</li>
        </ul>

        <div class="language-shell highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>0 20 <span class="k">*</span> <span class="k">*</span> 1-5 /full/path/to/your/php/script.php <span class="c"># 周一到周五每天晚上8点执行php</span>
</pre></td></tr></tbody></table>
</div>
        </div>
      </li>
    </ul>
  </li>
</ul>

<h3 id="让系统界面支持中文">让系统界面支持中文</h3>

<p>运行以下命令到命令行</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre>yum -y install kde-l10n-Chinese
yum -y reinstall glibc-common
yum clean all
localedef -c -f UTF-8 -i zh_CN zh_CN.utf8
cat /dev/null &gt; /etc/locale.conf <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"LC_ALL=</span><span class="se">\"</span><span class="s2">zh_CN.UTF-8</span><span class="se">\"</span><span class="s2">"</span> &gt; /etc/locale.conf
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="git-服务配置">git 服务配置</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>yum install -y git
</pre></td></tr></tbody></table>
</div>
</div>

<ul>
  <li>git config –global user.email “37016175@qq.com”</li>
  <li>git config –global user.name “dalong”</li>
  <li>cd /etc/</li>
  <li>git init</li>
  <li>git add *</li>
  <li>git commit -a -m “inital commit of the full /etc/ directory”</li>
  <li>vim ./yum.conf</li>
  <li>git status</li>
  <li>git commit -a -m “change yum.conf with a comment line”</li>
  <li>git log –pretty=oneline –abbrev-commit</li>
  <li>git diff a2a108a c6b8e6f</li>
  <li>git checkout c6b8e6f</li>
</ul>

<h3 id="文件同步-rsync">文件同步 rsync</h3>

<p>centos7自带rsync</p>

<p><a href="http://blog.csdn.net/qq_33324608/article/details/55259448">教学文章</a></p>

<p>配置文件: /etc/rsyncd.conf</p>

<h3 id="nginx-安装">Nginx 安装</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>yum install -y nginx
systemctl start nginx.service
systemctl <span class="nb">enable </span>nginx.service
</pre></td></tr></tbody></table>
</div>
</div>

<p>vim /etc/nginx/nginx.conf  # 由于之前安装了 httpd 的阿帕奇服务,已经占用了 80 端口, 所以需要修改端口为一个没用过的端口号.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>         listen       8081 default_server;
         listen       <span class="o">[</span>::]:8081 default_server;

</pre></td></tr></tbody></table>
</div>
</div>
<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">firewall-cmd --zone=public --add-port=8081/tcp --permanent</code> # 为防火墙添加8081端口.</p>
  </li>
  <li>
    <p><em>启动服务 失败了</em>: systemctl start nginx.service</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">systemctl status nginx.service -l</code></p>

    <ul>
      <li>输出如下:</li>
    </ul>

    <div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9</pre></td><td class="code"><pre>12月 28 09:58:18 dalongcentos7 systemd[1]: Starting The nginx HTTP and reverse proxy server...
12月 28 09:58:18 dalongcentos7 nginx[2479]: nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
12月 28 09:58:18 dalongcentos7 nginx[2479]: nginx: <span class="o">[</span>emerg] <span class="nb">bind</span><span class="o">()</span> to 0.0.0.0:8081 failed <span class="o">(</span>13: Permission denied<span class="o">)</span>
12月 28 09:58:18 dalongcentos7 nginx[2479]: nginx: configuration file /etc/nginx/nginx.conf <span class="nb">test </span>failed
12月 28 09:58:18 dalongcentos7 systemd[1]: nginx.service: control process exited, <span class="nv">code</span><span class="o">=</span>exited <span class="nv">status</span><span class="o">=</span>1
12月 28 09:58:18 dalongcentos7 systemd[1]: Failed to start The nginx HTTP and reverse proxy server.
12月 28 09:58:18 dalongcentos7 systemd[1]: Unit nginx.service entered failed state.
12月 28 09:58:18 dalongcentos7 systemd[1]: nginx.service failed.

</pre></td></tr></tbody></table>
</div>
    </div>

    <ul>
      <li>权限拒绝，经检查发现是开启selinux 导致的。 直接关闭</li>
      <li>getenforce   这个命令可以查看当前是否开启了selinux 如果输出 disabled 或 permissive 那就是关闭了</li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">getenforce</code></p>

    <ul>
      <li>如果输出 enforcing 那就是开启了 selinux</li>
      <li>setenforce 0    ##设置SELinux 成为permissive模式</li>
      <li>setenforce 1    ##设置SELinux 成为enforcing模式</li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">setenforce 0</code></p>
  </li>
  <li>
    <p>systemctl start nginx.service  # 开启服务</p>
  </li>
  <li>
    <p>systemctl enable nginx.service  # 设置开启启动</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">vi /etc/selinux/config</code> # 将SELINUX=enforcing改为SELINUX=disabled 永久关闭 selinux</p>
  </li>
  <li>
    <p>访问网址 http://192.168.31.242:8081 ,如果不出错,就是可以看到 nginx首页了</p>
  </li>
  <li>
    <p>如果出错,查看error log</p>

    <ul>
      <li>tail -f /var/log/nginx/error.log</li>
    </ul>
  </li>
</ul>

<h3 id="机器学习环境安装">机器学习环境安装</h3>

<p><a href="http://www.mensk.com/setting-up-deep-learning-environment-on-centos-7-nvidia-cuda-anaconda-ipython-keras-theano-and-tensorflow/">深度学习环境搭建</a></p>

<p><a href="https://zhuanlan.zhihu.com/p/26330963">机器学习环境搭建</a></p>

<p><a href="http://blog.csdn.net/qq_25872739/article/details/70598300">机器学习环境</a></p>

<h2 id="shell-脚本编写">shell 脚本编写</h2>

<p><a href="http://man.linuxde.net/shell-script">shell 脚本文档</a></p>

<ul>
  <li>shell 是外壳, 针对 kurnal 内核</li>
  <li>shell 是一门编程语言, 将终端命令放在文件中进行执行</li>
  <li>不同的shell , sh, bsh, csh, bash(linux 默认), ksh, zsh</li>
  <li>执行命令的方式:
    <ul>
      <li>交互式: 在命令行执行,输入一条,解析器输出一个结果</li>
      <li>脚本式: 多条命令放在一个脚本文件中, 然后运行脚本文件.</li>
    </ul>
  </li>
</ul>

<h3 id="升级-bash44">升级 bash4.4</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9</pre></td><td class="code"><pre><span class="c"># 升级 bash4.4</span>
<span class="nb">cd</span> /root/code
wget http://ftp.gnu.org/gnu/bash/bash-4.4.tar.gz
tar -zxvf bash-4.4.tar.gz
<span class="nb">cd </span>bash-4.4
./configure --prefix<span class="o">=</span>/usr/local/bash4.4
make <span class="o">&amp;&amp;</span> make install
mv /usr/bin/bash /usr/bin/bash.BAK
ln -s /usr/local/bash4.4/bin/bash /usr/bin/bash
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="多个命令写在一行的技巧">多个命令写在一行的技巧</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre>cmd1 ; cmd2 <span class="c"># 执行前一个,执行后一个</span>
cmd1 <span class="o">||</span> cmd2 <span class="c"># 执行前一个, 如果失败,执行第二个. 第一个成功了就结束了.</span>
cmd1 <span class="o">&amp;&amp;</span> cmd2 <span class="c"># 执行前一个, 如果成功了,执行第二个. 第一个失败了就结束了</span>

make <span class="o">&amp;&amp;</span> make install <span class="c"># 一种经常的执行方式, 一条条执行, 直到失败就停住.</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="不要用test-作为文件名">不要用test 作为文件名</h3>

<p>因为已经有一个shell 内置命令叫 <code class="language-plaintext highlighter-rouge">test</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre>whatis <span class="nb">test</span>
<span class="c"># test (1)             - check file types and compare values</span>
<span class="c"># test (1p)            - evaluate expression</span>
<span class="c"># Test (3pm)           - provides a simple framework for writing test scripts</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="-sha-bang-符号"><code class="language-plaintext highlighter-rouge">#!</code> sha-bang 符号</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre><span class="c">#!/bin/bash  </span>
<span class="c">#!/usr/bin/env bash</span>
<span class="c">#!/bin/sh</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="注释-">注释 <code class="language-plaintext highlighter-rouge">#</code></h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre><span class="c"># shell 中的单行注释</span>

:&lt;&lt;!
多行注释
e f g h
a b c d 
!
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="执行-shell-脚本两种方式">执行 Shell 脚本两种方式</h3>

<h4 id="cd到目录中执行">cd到目录中执行</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6</pre></td><td class="code"><pre>bash test.sh
<span class="c">#或者</span>
chmod a+x test.sh
./test.sh
<span class="c">#或者放到 PATH 对应目录中</span>
<span class="c">#或者将脚本目录export 到 PATH 目录中</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="为脚本创建软链接">为脚本创建软链接</h3>

<p>到/root/bin目录下</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>ln -s /usr/local/php7/bin/php /root/bin/php
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="path-将脚本所在目录添加到环境变量中"><code class="language-plaintext highlighter-rouge">$PATH</code> 将脚本所在目录添加到环境变量中</h3>

<pre><code class="language-bahs">export PATH=/usr/local/php7/bin/:$PATH
echo $PATH
</code></pre>

<h2 id="变量">变量</h2>

<p>在 bash 中所有的变量值都是以<em>字符串</em>形式保存的. 不管你给变量赋值时有没有使用引号, 都以字符串形式存储.</p>

<h3 id="预定义变量-------0-n">预定义变量 <code class="language-plaintext highlighter-rouge">$#, $*, $@, $?, $$, $!, $0, $N</code></h3>

<ul>
  <li>$# ：命令行中位置参数的个数</li>
  <li>$* , $@ ：所有位置参数的内容</li>
  <li>$? ：上一条命令执行后返回的状态，当返回状态值为0时表示执行正常，非0表示执行异常或出错</li>
  <li>$$ ：当前所在进程的进程号</li>
  <li>$! ：后台运行的最后一个进程号</li>
  <li>$0 ：当前执行的进程/程序名</li>
  <li>$N : N 是大于0的数字, 表示第几个参数.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>
<span class="nb">echo</span> <span class="s1">'参数个数为'</span> <span class="nv">$#</span>
<span class="nb">echo</span> <span class="s1">'参数内容为'</span> <span class="nv">$*</span>
<span class="nb">echo</span> <span class="s1">'上一条命令返回的状态是: '</span> <span class="nv">$?</span>
<span class="nb">echo</span> <span class="s1">'当前进程号是: '</span> <span class="nv">$$</span>
<span class="nb">echo</span> <span class="s1">'当前运行的最后一个进程号'</span> <span class="nv">$!</span>
<span class="nb">echo</span> <span class="s1">'当前执行的进程/程序名'</span> <span class="nv">$0</span>
<span class="c"># 输出如下</span>
<span class="c">#参数个数为 3</span>
<span class="c">#参数内容为 a b c</span>
<span class="c">#上一条命令返回的状态是:  0</span>
<span class="c">#当前进程号是:  2010</span>
<span class="c">#当前运行的最后一个进程号</span>
<span class="c">#当前执行的进程/程序名 ./my.sh</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="位置变量">位置变量</h3>

<p>表示为 $n (n 为 1-9之间的数字)</p>

<p>$0 表示当前文件</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>
<span class="nb">echo</span> <span class="s1">'当前文件名: '</span> <span class="nv">$0</span>
<span class="nb">echo</span> <span class="s1">'第一个变量是: '</span> <span class="nv">$1</span>
<span class="nb">echo</span> <span class="s1">'第二个变量是: '</span> <span class="nv">$2</span>
<span class="nb">echo</span> <span class="s1">'第三个变量是: '</span> <span class="nv">$3</span>
<span class="c">#当前文件名:  ./my.sh</span>
<span class="c">#第一个变量是:  a</span>
<span class="c">#第二个变量是:  b</span>
<span class="c">#第三个变量是:  c</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="环境变量">环境变量</h3>

<p>环境变量配置文件</p>

<ul>
  <li>全局配置文件：/etc/profile</li>
  <li>用户配置文件：~/.bash_profile</li>
</ul>

<p>查看环境变量</p>

<p><code class="language-plaintext highlighter-rouge">set</code>, <code class="language-plaintext highlighter-rouge">env</code>命令可以查看所有的shell变量，其中包括环境变量</p>

<p>常见的环境变量</p>

<ul>
  <li>$USER 查看当前用户名</li>
  <li>$UID 当前用户UID</li>
  <li>$SHELL 当前用户使用的shell</li>
  <li>$HOME 当前用户家目录</li>
  <li>$PWD 当前目录</li>
  <li>$PATH 用户所输入的命令是在哪些目录中查找</li>
  <li>$PS1 就是用户平时的提示符。</li>
  <li>$PS2 第一行没输完，等待第二行输入的提示符。</li>
  <li>$RANDOM 随机数</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">PS1</code> 中的特殊符号所代表的意义</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></td><td class="code"><pre>　　<span class="se">\d</span> ：代表日期，格式为weekday month date，例如：<span class="s2">"Mon Aug 1"</span>
 
　　<span class="se">\H</span> ：完整的主机名称。例如：我的机器名称为：fc4.linux，则这个名称就是fc4.linux
 
　　<span class="se">\h</span> ：仅取主机的第一个名字，如上例，则为fc4，.linux则被省略
 
　　<span class="se">\t</span> ：显示时间为24小时格式，如：HH：MM：SS
 
　　<span class="se">\T</span> ：显示时间为12小时格式
 
　　<span class="se">\A</span> ：显示时间为24小时格式：HH：MM
 
　　<span class="se">\u</span> ：当前用户的账号名称
 
　　<span class="se">\v</span> ：BASH的版本信息
 
　　<span class="se">\w</span> ：完整的工作目录名称。家目录会以 ~代替
 
　　<span class="se">\W</span> ：利用basename取得工作目录名称，所以只会列出最后一个目录
 
<span class="gp">　　\# </span>：下达的第几个命令
 
<span class="gp">　　\$ </span>：提示字符，如果是root时，提示符为：# ，普通用户则为：<span class="err">$</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><em><code class="language-plaintext highlighter-rouge">pgrep</code> 查看某个进程(mysqld)在运行中所用到的环境变量</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>pgrep mysqld  <span class="c"># 获取mysqld 的进程号</span>
cat /proc/911/environ  <span class="c"># 获取mysql 用到的所有环境变量</span>
<span class="c"># LANG=zh_CN.UTF-8PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin_WSREP_START_POSITION=NOTIFY_SOCKET=/run/systemd/notifyHOME=/var/lib/mysqlLOGNAME=mysqlUSER=mysqlSHELL=/sbin/nologin[root@MiWiFi-R2D-srv code]#</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="引号对变量的作用">引号对变量的作用</h3>

<p>结合不同的引导为变量赋值</p>

<ul>
  <li>双引号 “” ：允许通过$符号引用其他变量值</li>
  <li>单引号 ‘’ ：禁止引用其他变量值，$视为普通字符</li>
  <li>反撇号 `` ：将命令执行的结果输出给变量</li>
</ul>

<h3 id="用户自定义变量">用户自定义变量</h3>

<ul>
  <li>变量名只能是字母数字下划线, 不能以数字开头</li>
  <li>等号两边不能有空格.</li>
  <li>值如果没有空格, 可以不用引号括起来</li>
  <li>值有空格, 必须用引号括起来</li>
</ul>

<p><em>单行变量定义</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>

<span class="c"># 变量名只能是字母数字下划线, 不能以数字开头</span>
<span class="nv">a</span><span class="o">=</span>abc  <span class="c"># 等号两边不能有空格. 值如果没有空格, 可以不用引号括起来</span>
<span class="nb">echo</span> <span class="nv">$a</span>
<span class="nb">echo</span> <span class="k">${</span><span class="nv">a</span><span class="k">}</span>

<span class="nv">b</span><span class="o">=</span><span class="s2">"ab c"</span> <span class="c"># 值有空格, 必须用引号括起来</span>
<span class="nb">echo</span> <span class="nv">$b</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>多行文本变量定义</em>  <a href="http://www.woola.net/detail/2016-09-05-bash-multi-line-text.html">更多方法</a></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9</pre></td><td class="code"><pre><span class="nv">c</span><span class="o">=</span><span class="sb">`</span>cat <span class="sh">&lt;&lt;EOF
&lt;?xml version="1.0" encoding='UTF-8'?&gt;
&lt;report&gt;
  &lt;img src="a-vs-b.jpg"/&gt;
&lt;/report&gt;
EOF`
echo $c
#&lt;?xml version="1.0" encoding='UTF-8'?&gt; &lt;report&gt; &lt;img src="a-vs-b.jpg"/&gt; &lt;caption&gt;Thus is a future post on Multi Line Strings in bash &lt;date&gt;1511&lt;/date&gt;-&lt;date&gt;1512&lt;/date&gt;.&lt;/caption&gt; &lt;/report&gt;

</span></pre></td></tr></tbody></table>
</div>
</div>

<h3 id="unset-删除一个变量"><code class="language-plaintext highlighter-rouge">unset</code> 删除一个变量</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre><span class="nv">c</span><span class="o">=(</span>1 2 3 4<span class="o">)</span>
<span class="nb">unset </span>c
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="read-命令获取用户输入变量值"><code class="language-plaintext highlighter-rouge">read</code> 命令获取用户输入变量值</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>
<span class="nb">read </span>yourname age
<span class="nb">echo</span> <span class="s2">"你输入的名字是: "</span> <span class="nv">$yourname</span>
<span class="nb">echo</span> <span class="s2">"你年龄是: "</span> <span class="nv">$age</span>
<span class="c">#/bin/bash /Users/dalong/code/python1702/centos7/my.sh</span>
<span class="c">#大龙 41</span>
<span class="c">#你输入的名字是:  大龙</span>
<span class="c">#你年龄是:  41</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>参数:</p>

<ul>
  <li>-a: 数组 read -a arrayname</li>
  <li>-p: 输入提示 read -p “text”</li>
  <li>-r: 允许反斜线 read -r line</li>
  <li>-t: 等待读取数值的时间(秒)</li>
  <li>-s: 输入的内容不显示在终端上, 输入密码的时候用.</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">$REPLY</code> 是默认的输入值保存变量, 如果不定义其他的保存变量, 就找REPLY</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre><span class="c">#!/usr/bin/env bash</span>
<span class="nb">read</span> -p <span class="s1">'请输入你的姓名:'</span>
<span class="nb">echo</span> <span class="nv">$REPLY</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><code class="language-plaintext highlighter-rouge">-a</code> 获取数组</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre><span class="c">#!/usr/bin/env bash</span>
<span class="nb">read</span> -a friends
<span class="nb">echo echo</span> <span class="s2">"They are </span><span class="k">${</span><span class="nv">friends</span><span class="p">[0]</span><span class="k">}</span><span class="s2">, </span><span class="k">${</span><span class="nv">friends</span><span class="p">[1]</span><span class="k">}</span><span class="s2"> and </span><span class="k">${</span><span class="nv">friends</span><span class="p">[2]</span><span class="k">}</span><span class="s2">."</span>
<span class="nb">echo</span> <span class="nv">$REPLY</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>获取密码,但不显示密码的方法 <code class="language-plaintext highlighter-rouge">stty -echo , stty echo</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre></td><td class="code"><pre><span class="c"># 方法一</span>
<span class="c">#!/usr/bin/env bash</span>
<span class="nb">read</span> -p <span class="s2">"输入密码: "</span> -s <span class="nb">pwd
echo
echo</span> <span class="s2">"password is : "</span> <span class="nv">$pwd</span>

<span class="c"># 方法二</span>

<span class="c">#!/usr/bin/env bash</span>
stty -echo  <span class="c"># 让终端输入的内容不可见</span>
<span class="nb">read</span> -p <span class="s2">"请输入密码: "</span> <span class="nb">pwd
</span>stty <span class="nb">echo</span>   <span class="c"># 让终端输入的内容可见</span>
<span class="nb">echo</span> <span class="nv">$pwd</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="alias-定义别名变量"><code class="language-plaintext highlighter-rouge">alias</code> 定义别名变量</h3>

<p><strong>别名</strong>就是提供一种便捷的方式来完成某些长串命令的操作。省去不必要的麻烦，提高效率。</p>

<ul>
  <li>一般是会把别名定义表达式放到  ~/.bashrc 文件中.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="nb">echo</span> <span class="s1">'alias nginxrestart="/usr/local/webserver/nginx/sbin/nginx -s reload"'</span> &gt;&gt; ~/.bashrc 
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>查看系统已经定义的别名就直接用命令  <code class="language-plaintext highlighter-rouge">alias</code></em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8</pre></td><td class="code"><pre><span class="nb">alias </span><span class="nv">cp</span><span class="o">=</span><span class="s1">'cp -i'</span>
<span class="nb">alias </span>l.<span class="o">=</span><span class="s1">'ls -d .* --color=tty'</span>
<span class="nb">alias </span><span class="nv">ll</span><span class="o">=</span><span class="s1">'ls -l --color=tty'</span>
<span class="nb">alias </span><span class="nv">ls</span><span class="o">=</span><span class="s1">'ls --color=tty'</span>
<span class="nb">alias </span><span class="nv">mv</span><span class="o">=</span><span class="s1">'mv -i'</span>
<span class="nb">alias </span><span class="nv">rm</span><span class="o">=</span><span class="s1">'rm -i'</span>
<span class="nb">alias </span><span class="nv">vi</span><span class="o">=</span><span class="s1">'vim'</span>
<span class="nb">alias </span><span class="nv">which</span><span class="o">=</span><span class="s1">'alias | /usr/bin/which --tty-only --read-alias --show-dot --show-tilde'</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="文件的描述符和重定向---2--tee">文件的描述符和重定向 <code class="language-plaintext highlighter-rouge">&gt;, &gt;&gt;, 2&gt;, &amp;&gt;, tee</code></h2>

<h3 id="文件描述符">文件描述符</h3>

<blockquote>
  <p>常见的文件描述符是<strong>stdin</strong>、<strong>stdout</strong>和<strong>stderr</strong></p>

  <p>系统预留文件描述符</p>

  <ul>
    <li><strong>0</strong> —— stdin（标准输入）</li>
    <li><strong>1</strong> —— stdout（标准输出）</li>
    <li><strong>2</strong> —— stderr（错误输出）</li>
  </ul>
</blockquote>

<h3 id="输出重定向--">输出重定向 <code class="language-plaintext highlighter-rouge">&gt;</code> <code class="language-plaintext highlighter-rouge">&gt;&gt;</code></h3>

<blockquote>
  <p>重定向将输入文本<strong>通过截取模式</strong>保存到文件</p>
</blockquote>

<p><em>重定向和追加重定向</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre><span class="nb">echo</span> <span class="s2">"this is a text line one"</span> &gt; test.txt  <span class="c">#写入到文件之前，文件内容首先会被清空。</span>
<span class="nb">echo</span> <span class="s2">"this is a text line one"</span> &gt;&gt; test.txt <span class="c">#写入到文件之后，会追加到文件结尾。</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>将标准输出和错误输出重定向到文件中/黑洞中</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre>cat linuxde.net 2&gt; out.txt <span class="c"># 只将错误信息重定向到文件中</span>
cat linuxde.net &amp;&gt; out.txt <span class="c"># 正确和错误信息都重定向</span>
cat linuxde.net 2&gt; /dev/null <span class="c"># 将错误信息重定向到黑洞</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="tee-命令-和重定向">tee 命令 和重定向</h3>

<p>tee命令可以将数据重定向到文件，另一方面还可以提供一份重定向数据的副本作为后续命令的stdin</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8</pre></td><td class="code"><pre>ls | tee out.txt | cat -n  <span class="c"># ls 结果通过 tee 放入 out.txt 中, 又将结果再次转给 cat 显示行号. </span>
<span class="c"># 输出</span>
<span class="c">#  	  1  a.repo</span>
<span class="c">#     2  b.repo</span>
<span class="c">#     3  c.repo</span>
<span class="c">#     4  d.txt</span>
<span class="c">#     5  out.txt</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="多行文本重定向-cat-eof-文件名">多行文本重定向 <code class="language-plaintext highlighter-rouge">cat &lt;&lt;EOF&gt; 文件名</code></h3>

<p><em>在<code class="language-plaintext highlighter-rouge">cat &lt;&lt;EOF&gt;text.log</code>与下一个<code class="language-plaintext highlighter-rouge">EOF</code>行之间的所有文本都会当作stdin数据输入到text.log中</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>
cat <span class="sh">&lt;&lt;EOF&gt;text.log
this is a text line1
this is a text line2
this is a text line3
EOF
</span></pre></td></tr></tbody></table>
</div>
</div>

<h2 id="下标数组关联数组">下标数组,关联数组</h2>

<p><a href="http://blog.csdn.net/baoendemao/article/details/51638784">更全面的数组介绍</a></p>

<p><strong>数组</strong>作为一种特殊的数据结构在任何一种编程语言中都有它的一席之地，数组在Shell脚本中也是非常重要的组成部分，它借助索引将多个独立的数据存储为一个集合</p>

<ul>
  <li>
    <p>bash支持一维数组（不支持多维数组），并且没有限定数组的大小。</p>

    <p>​</p>
  </li>
</ul>

<h3 id="下标数组">下标数组:</h3>

<p>下标数组元素的下标由0开始编号。获取数组中的元素要利用下标，下标可以是整数或算术表达式，其值应大于或等于0。</p>

<p><em>定义数组和读取和删除</em> 等号两边不能有空格</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre></td><td class="code"><pre>
a[0]<span class="o">=</span><span class="s1">'a'</span>
a[1]<span class="o">=</span><span class="s2">"b"</span>
<span class="nb">echo</span> <span class="k">${</span><span class="nv">a</span><span class="p">[0]</span><span class="k">}</span>
<span class="nb">echo</span> <span class="k">${</span><span class="nv">a</span><span class="p">[1]</span><span class="k">}</span>
<span class="nb">echo</span> <span class="k">${</span><span class="nv">a</span><span class="p">[@]</span><span class="k">}</span> <span class="c"># 输出所有数组元素</span>

<span class="nv">b</span><span class="o">=(</span>1 2 3 4 5<span class="o">)</span>
<span class="nb">echo</span> <span class="k">${</span><span class="nv">b</span><span class="p">[@]</span><span class="k">}</span>  <span class="c"># 输出所有元素</span>
<span class="nb">echo</span> <span class="k">${</span><span class="nv">b</span><span class="p">[*]</span><span class="k">}</span>  <span class="c"># 输出所有元素</span>
<span class="nb">echo</span> <span class="k">${#</span><span class="nv">b</span><span class="p">[@]</span><span class="k">}</span> <span class="c"># 输出数组长度</span>

<span class="nb">unset </span>a[0] <span class="c"># 删除一个元素</span>
<span class="nb">unset </span>b    <span class="c"># 删除整个数组</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>数组的分片</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre><span class="nv">array</span><span class="o">=(</span> <span class="o">[</span>0]<span class="o">=</span>one <span class="o">[</span>1]<span class="o">=</span>two <span class="o">[</span>2]<span class="o">=</span>three <span class="o">[</span>3]<span class="o">=</span>four <span class="o">)</span>
<span class="nb">echo</span> <span class="k">${</span><span class="nv">array</span><span class="p">[@]</span>:0:2<span class="k">}</span>  <span class="c"># one two</span>
<span class="nb">echo</span> <span class="k">${</span><span class="nv">array</span><span class="p">[@]</span>:1:2<span class="k">}</span>  <span class="c"># two three</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="关联数组">关联数组:</h3>

<p>shell 提供了另外一种数组，其可以使用任意的字符串作为下标（不必是整数）来访问数组元素。这种数组叫做关联数组（associative array）。</p>

<ul>
  <li>关联数组的下标和值称为键值对，它们是一一对应的关系。</li>
  <li>在关联数组中，键是唯一的，值可以不唯一。</li>
</ul>

<p><em>关联数组定义和使用</em></p>

<p>定义关联数组</p>

<ul>
  <li>shell 的关联数组和 shell 的下标数组在定义和使用上完全一样，只是在索引上有区别。</li>
  <li>需要注意的是，在使用关联数组之前，需要使用命令 <code class="language-plaintext highlighter-rouge">declare -A array</code> 进行显示声明。</li>
</ul>

<table>
  <thead>
    <tr>
      <th>语法</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>${!array[*]}</td>
      <td>取关联数组所有键</td>
    </tr>
    <tr>
      <td>${!array[@]}</td>
      <td>取关联数组所有键</td>
    </tr>
    <tr>
      <td>${array[*]}</td>
      <td>取关联数组所有值</td>
    </tr>
    <tr>
      <td>${array[@]}</td>
      <td>取关联数组所有值</td>
    </tr>
    <tr>
      <td>${#array[*]}</td>
      <td>关联数组的长度</td>
    </tr>
    <tr>
      <td>${#array[@]}</td>
      <td>关联数组的长度</td>
    </tr>
  </tbody>
</table>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16</pre></td><td class="code"><pre><span class="c">#!/usr/bin/bash</span>
<span class="nb">declare</span> -A phone                            <span class="c"># 定义关联数组</span>

<span class="nv">phone</span><span class="o">=([</span>jim]<span class="o">=</span>135 <span class="o">[</span>tom]<span class="o">=</span>136 <span class="o">[</span>lucy]<span class="o">=</span>158<span class="o">)</span>      <span class="c"># 为关联数组添加元素</span>
<span class="c"># 或者单独赋值</span>
<span class="c"># phone[jim]=135</span>
<span class="c"># phone[tom]=136</span>
<span class="k">for </span>key <span class="k">in</span> <span class="k">${</span><span class="p">!phone[*]</span><span class="k">}</span>
<span class="k">do
    </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$key</span><span class="s2"> -&gt; </span><span class="k">${</span><span class="nv">phone</span><span class="p">[</span><span class="nv">$key</span><span class="p">]</span><span class="k">}</span><span class="s2">"</span>
<span class="k">done</span>

<span class="c">#输出如下:</span>
<span class="c">#tom -&gt; 136</span>
<span class="c">#jim -&gt; 135</span>
<span class="c">#lucy -&gt; 158</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="函数定义执行传参数">函数定义,执行,传参数</h2>

<p>Bash（Bourne Again shell）也跟其他编程语言一样也支持函数，一般在编写大型脚本中需要用到，它可以将shell脚本程序划分成一个个功能相对独立的代码块，使代码的模块化更好，结构更加清晰，并可以有效地减少程序的代码量。但是bash作为一种解释性语言，bash 在编程能力方面提供的支持并不像其他编译性的语言（例如 C 语言）那样完善，执行效率也会低很多。</p>

<h3 id="定义和调用函数"><em>定义和调用函数</em></h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6</pre></td><td class="code"><pre><span class="c">#!/usr/bin/bash</span>
<span class="k">function </span>sayhello<span class="o">(){</span>  <span class="c"># function 关键字可以忽略</span>
    <span class="nb">echo</span> <span class="s2">"hello"</span>
<span class="o">}</span>

sayhello  <span class="c"># 调用函数时不要加小括号</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="定义全局变量-局部变量-并获得返回值"><em>定义全局变量, 局部变量, 并获得返回值</em></h3>

<ul>
  <li>bash中定义局部变量要用关键字 local</li>
  <li>return 只能返回0~257之间的整数</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13</pre></td><td class="code"><pre><span class="c">#!/usr/bin/bash</span>
<span class="nv">aa</span><span class="o">=</span><span class="s2">"this is aa"</span>
<span class="nv">bb</span><span class="o">=</span><span class="s2">"this is bb"</span>
<span class="k">function </span>name<span class="o">()</span> <span class="o">{</span>                  <span class="c">#定义函数name</span>
        <span class="nb">local </span><span class="nv">cc</span><span class="o">=</span><span class="s2">"this is cc"</span>      <span class="c">#定义局部变量$cc</span>
        <span class="nb">local </span><span class="nv">dd</span><span class="o">=</span><span class="s2">"this is dd"</span>      <span class="c">#定义局部变量$dd</span>
        <span class="nb">echo</span> <span class="nv">$aa</span>, <span class="nv">$bb</span>              <span class="c">#访问参数1和参数2</span>
        <span class="nb">echo</span> <span class="nv">$cc</span>                   <span class="c">#打印局部变量</span>
        <span class="k">return </span>0                   <span class="c">#shell函数返回值是整形，并且在0~257之间。</span>
<span class="o">}</span>

<span class="nb">echo</span> <span class="nv">$dd</span>                           <span class="c">#这里将会打印不生效，因为dd是局部变量。</span>
name                               <span class="c">#使用函数name</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="为函数传递参数"><em>为函数传递参数</em></h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre></td><td class="code"><pre><span class="c">#!/usr/bin/bash</span>
<span class="nv">str</span><span class="o">=</span><span class="s2">"This is a test!"</span>
fun1<span class="o">(){</span>
    <span class="nb">echo</span> <span class="nv">$str</span>;
    <span class="nb">echo</span> <span class="nv">$1</span>;
    <span class="nb">echo</span> <span class="nv">$2</span>;
<span class="o">}</span>
<span class="c">#调用fun1</span>
fun1  <span class="s2">"aa"</span> <span class="s2">"bb"</span>   <span class="c"># 参数不要放在括号中</span>
fun1  <span class="s2">"cc"</span> <span class="s2">"dd"</span>

<span class="c">#输出如下</span>
<span class="c">#This is a test!</span>
<span class="c">#aa</span>
<span class="c">#bb</span>
<span class="c">#This is a test!</span>
<span class="c">#cc</span>
<span class="c">#dd</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="条件测试-test-与-流程控制-if-else">条件测试 <code class="language-plaintext highlighter-rouge">test</code> 与 流程控制 <code class="language-plaintext highlighter-rouge">if else</code></h2>

<p>在编写Shell脚本时候，经常需要判断两个字符串是否相等，检查文件状态或者是数字的测试等。Shell提供了对字符串、文件、数值等内容的条件测试以及逻辑流程控制。</p>

<h3 id="关于真值-true-false">关于真值 <code class="language-plaintext highlighter-rouge">true false</code></h3>

<p>与其他语言不同，Bash（包括其他Shell）中，是用<code class="language-plaintext highlighter-rouge">0表示真</code>，<code class="language-plaintext highlighter-rouge">非0表示假</code>的。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre><span class="nb">true
echo</span> <span class="nv">$?</span> <span class="c"># 输出 0</span>
<span class="nb">false
echo</span> <span class="nv">$?</span> <span class="c"># 输出 1</span>

<span class="c"># if [ 0 ];then echo "真"; else echo "假"; fi</span>
<span class="c"># 输出为 "真"</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="常用测试操作-test--条件表达式-">常用测试操作 <code class="language-plaintext highlighter-rouge">test</code> <code class="language-plaintext highlighter-rouge">[ 条件表达式 ]</code></h3>

<p><code class="language-plaintext highlighter-rouge">test</code>命令，测试特定的表达式是否成立，当条件成立时，命令执行后的返回值为<code class="language-plaintext highlighter-rouge">0</code>，否则为其他数值。</p>

<blockquote>
  <p>格式1</p>

  <ul>
    <li><code class="language-plaintext highlighter-rouge">test 条件表达式</code></li>
  </ul>

  <p>格式2</p>

  <ul>
    <li><code class="language-plaintext highlighter-rouge">[ 条件表达式 ]</code></li>
    <li>使用方括号时，要注意在条件两边加上<em>空格</em>。</li>
    <li>如果条件中有 <code class="language-plaintext highlighter-rouge">=</code> 号, 注意在<code class="language-plaintext highlighter-rouge">=</code>前后各有一个空格，如果没有空格就是赋值的关系，不是比较的关系。</li>
    <li>在<code class="language-plaintext highlighter-rouge">[]</code>中使用<code class="language-plaintext highlighter-rouge">=</code>，（尽管<code class="language-plaintext highlighter-rouge">==</code>也可以可以用的）</li>
    <li>字符串的<code class="language-plaintext highlighter-rouge">&gt; &lt;</code>比较运算符，一般放在<code class="language-plaintext highlighter-rouge">[[ ]]</code>之中，而不是<code class="language-plaintext highlighter-rouge">test ("[]")</code></li>
    <li>字符串的<code class="language-plaintext highlighter-rouge">&gt; &lt;</code>比较的结果，与本地的locale有关，是按照其字典序列进行比较的</li>
    <li>[] 中的变量都要加上双引号括起来, 比如 <code class="language-plaintext highlighter-rouge">[ "$str" = "hello" ]</code></li>
  </ul>
</blockquote>

<p>常见测试种类</p>

<ul>
  <li>测试文件状态</li>
  <li>字符串的比较</li>
  <li>整数值的比较</li>
  <li>逻辑测试</li>
</ul>

<p>测试目录是否存在</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12</pre></td><td class="code"><pre><span class="c">#!/usr/bin/bash</span>
<span class="o">[</span> -d /Users/dalong/code/python1702/centos7 <span class="o">]</span>
<span class="nb">echo</span> <span class="nv">$?</span>
<span class="o">[</span> -d /Users/dalong/code/python1702/centos7/test.log <span class="o">]</span>
<span class="nb">echo</span> <span class="nv">$?</span>
<span class="o">[</span> -d /Users/dalong/code/python1702/centos7/abc <span class="o">]</span>
<span class="nb">echo</span> <span class="nv">$?</span>

<span class="c">#输出如下:</span>
<span class="c">#1   是目录</span>
<span class="c">#0   不是目录,是文件</span>
<span class="c">#0   目录不存在</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="测试文件状态">测试文件状态</h3>

<blockquote>
  <p>格式
[ 操作符 文件或目录 ]</p>
</blockquote>

<p>操作符：</p>

<ul>
  <li>-d：测试是否为目录，是则为真（Directory）</li>
  <li>-e：测试目录或文件是否存在，存在则为真（Exist）</li>
  <li>-f：测试是否为文件，是则为真（file)</li>
  <li>-r：测试当前用户是否有权限读取，是则为真（read）</li>
  <li>-w：测试当前用户是否有权限写入，是这为真（write])</li>
  <li>-x：测试当前用户是否可执行该文件，可执行则为真（Excute）</li>
  <li>-L：测试是否为符号链接文件，是则为真（Link）</li>
  <li>-nt：file1 -nt file2 如果 file1 比 file2 新（修改时间），则为真</li>
  <li>-ot：file1 -ot file2 如果 file1 比 file2 旧（修改时间），则为真</li>
</ul>

<p><em>判断文件或目录是否存在</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre><span class="k">if</span> <span class="o">[</span> -d /root/code <span class="o">]</span>;<span class="k">then </span><span class="nb">echo</span> <span class="s2">"是目录"</span>; <span class="k">else  </span><span class="nb">echo</span> <span class="s2">"不是目录"</span>; <span class="k">fi</span>  <span class="c"># 判断目录是否存在</span>
<span class="c"># 输出为 "是目录"</span>
<span class="k">if</span> <span class="o">[</span> -e /root/code/my.sh <span class="o">]</span>;<span class="k">then </span><span class="nb">echo</span> <span class="s2">"文件或目录存在"</span>; <span class="k">else  </span><span class="nb">echo</span> <span class="s2">"文件或目录不存在"</span>; <span class="k">fi</span>  <span class="c"># 判断文件或目录是否存在</span>
<span class="c"># 输出为 "文件或目录存在"</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>判断两个文件的新旧</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre><span class="nb">test </span>test.txt -ot test2.txt
<span class="nb">echo</span> <span class="nv">$?</span>
<span class="c">#输出为0</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>判断两个文件是否相同</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>

<span class="nv">str1</span><span class="o">=</span><span class="sb">`</span>md5sum /root/code/test.txt|cut -f1 -d<span class="s2">" "</span><span class="sb">`</span>  <span class="c"># 将文件md5之后,取第一个字段</span>
<span class="nv">str2</span><span class="o">=</span><span class="sb">`</span>md5sum /root/code/test2.txt|cut -f1 -d<span class="s2">" "</span><span class="sb">`</span>

<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$str1</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"</span><span class="nv">$str2</span><span class="s2">"</span> <span class="o">]</span>; <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"Files have the same content"</span> <span class="nv">$str1</span>, <span class="nv">$str2</span>
<span class="k">else
    </span><span class="nb">echo</span> <span class="s2">"Files have NOT the same content"</span>  <span class="nv">$str1</span>, <span class="nv">$str2</span>
<span class="k">fi</span>
<span class="c"># 输出如下:</span>
<span class="c"># Files have the same content 22eac1e6209922a4a62863644b833950, 22eac1e6209922a4a62863644b833950</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="字符串的比较">字符串的比较</h3>

<blockquote>
  <p>格式
[ 字符串1 = 字符串2 ]
[ 字符串1 != 字符串2 ]
[ -z 字符串 ]  判断字符串长度是否为0. the length of STRING is zero</p>
</blockquote>

<p>操作符：</p>

<ul>
  <li>=：字符串内容相同则为真，就是说包含的文本一摸一样。</li>
  <li>!=：字符串内容不同，则为真（!号表示相反的意思）</li>
  <li>-z：字符串内容为空（长度为零）则为真</li>
  <li>-n：字符串内容非空（长度非零）则为真</li>
  <li>&lt;：string1 &lt; string2 如果string1在本地的字典序列中排在string2之前，则为真</li>
  <li>&gt;：string2 如果string1在本地的字典序列中排在string2之后，则为真</li>
</ul>

<p>注意点：</p>

<ol>
  <li>字符串的 “等于” 比较，为了与<a href="http://zh.wikipedia.org/wiki/POSIX">POSIX</a>一致，在<code class="language-plaintext highlighter-rouge">[]</code>中使用<code class="language-plaintext highlighter-rouge">=</code>，（尽管<code class="language-plaintext highlighter-rouge">==</code>也可以）</li>
  <li>注意在<code class="language-plaintext highlighter-rouge">=</code>前后各有一个空格，如果没有空格就是赋值的关系，不是比较的关系。</li>
  <li>字符串的<code class="language-plaintext highlighter-rouge">&gt; &lt;</code>比较运算符，一般放在<code class="language-plaintext highlighter-rouge">[[ ]]</code>之中，而不是<code class="language-plaintext highlighter-rouge">test ("[]")</code></li>
  <li>字符串的<code class="language-plaintext highlighter-rouge">&gt; &lt;</code>比较的结果，与本地的locale有关，是按照其字典序列进行比较的</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18</pre></td><td class="code"><pre><span class="c"># 比较字符串</span>

<span class="nv">str</span><span class="o">=</span><span class="s2">"Hello"</span>
<span class="o">[</span> <span class="s2">"</span><span class="nv">$str</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"Hello"</span> <span class="o">]</span>
<span class="nb">echo</span> <span class="nv">$?</span>  <span class="c"># 输出0</span>
<span class="o">[</span> <span class="s2">"</span><span class="nv">$str</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"hello"</span> <span class="o">]</span>
<span class="nb">echo</span> <span class="nv">$?</span>  <span class="c"># 输出1</span>

<span class="c"># 判断是否为空</span>
<span class="nv">str</span><span class="o">=</span><span class="s2">""</span>
<span class="o">[</span> -z <span class="s2">"</span><span class="nv">$str</span><span class="s2">"</span> <span class="o">]</span>
<span class="nb">echo</span> <span class="nv">$?</span>  <span class="c"># 输出0</span>

<span class="o">[[</span> <span class="s2">"a"</span> &lt; <span class="s2">"b"</span> <span class="o">]]</span>
<span class="nb">echo</span> <span class="nv">$?</span>  <span class="c"># 输出0</span>
<span class="o">[[</span> <span class="s2">"a"</span> &gt; <span class="s2">"b"</span> <span class="o">]]</span>
<span class="nb">echo</span> <span class="nv">$?</span>  <span class="c"># 输出1</span>

</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="整数值的比较">整数值的比较</h3>

<blockquote>
  <p>格式
[ 整数1 操作符 整数2 ]</p>
</blockquote>

<p>操作符</p>

<ul>
  <li>-eq：等于（equal）</li>
  <li>-ne：不等于（not equal）</li>
  <li>-gt：大于（Greater than）</li>
  <li>-lt：小于（lesser than）</li>
  <li>-le：小于等于（lesser or equal）</li>
  <li>-ge：大于等于（Greater or equal）</li>
</ul>

<p>注意:</p>

<ul>
  <li>整数的test就是大小关系的比较，与其他语言不同，Bash中没有使用&lt;,&gt;来做大于等于号，而是使用了减号开头的选项来比较。</li>
  <li>整数值的定义可以用引号,也可以不用</li>
  <li>使用以上操作符，那么操作符两边一定要是整数。</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre><span class="nv">num</span><span class="o">=</span><span class="s2">"15"</span>  <span class="c">#  num=15 结果一样</span>
<span class="o">[</span> <span class="s2">"</span><span class="nv">$num</span><span class="s2">"</span> -eq 15 <span class="o">]</span>
<span class="nb">echo</span> <span class="nv">$?</span>  <span class="c"># 输出0</span>
<span class="o">[</span> <span class="s2">"</span><span class="nv">$num</span><span class="s2">"</span> -eq 20 <span class="o">]</span>
<span class="nb">echo</span> <span class="nv">$?</span>  <span class="c"># 输出1</span>
</pre></td></tr></tbody></table>
</div>
</div>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre><span class="nv">a</span><span class="o">=</span>15
<span class="nv">b</span><span class="o">=</span>14
<span class="nb">test</span> <span class="nv">$a</span> -gt <span class="nv">$b</span> <span class="o">&amp;&amp;</span> <span class="nb">echo </span>Yes
<span class="c">#输出 Yes</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="逻辑运算符--a---o--">逻辑运算符 <code class="language-plaintext highlighter-rouge">-a, &amp;&amp;, -o, ||, !</code></h2>

<blockquote>
  <p>格式
[ 表达式1 ] 操作符 [ 表达式2 ] …</p>
</blockquote>

<p>操作符</p>

<ul>
  <li>-a 或 &amp;&amp; ：逻辑与，“而且”的意思，前后两个表达式都成立时整个测试结果才为真，否则为假</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>-o 或</td>
          <td> </td>
          <td>： 逻辑或，“或者”的意思，操作符两边至少一个为真时，结果为真，否为为假</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>! ：逻辑否，当制定条件不成立时，返回结果为真</li>
</ul>

<h3 id="if-条件语句">if 条件语句</h3>

<p><strong>if 单分支</strong>：</p>

<blockquote>
  <p>[语法]</p>

  <p>if [ 条件语句 ]; then</p>

  <p>​	代码</p>

  <p>fi</p>
</blockquote>

<p><em>当/boot分区的空间使用超过80%，就输出报警信息。</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>
<span class="c">#当/boot分区的空间使用超过80%，就输出报警信息。</span>
<span class="nv">use</span><span class="o">=</span><span class="sb">`</span>df -hT | grep <span class="s2">"/boot"</span> | awk <span class="s1">'{print $6}'</span> | cut -d <span class="s2">"%"</span> -f1<span class="sb">`</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$use</span> -gt 80 <span class="o">]</span>; <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"Warning!!/boot disk is full"</span>
<span class="k">fi</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><strong>if 双分支</strong>：</p>

<blockquote>
  <p>[语法]</p>

  <p>if [ 条件语句 ]; then</p>

  <p>​	代码</p>

  <p>else</p>

  <p>​	代码</p>

  <p>fi</p>
</blockquote>

<p><em>判断防火墙 firewalld 是否在运行，如果已经在运行提示信息，没就有开启它。</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>
<span class="c">#判断iptables是否在运行，如果已经在运行提示信息，如果没有开启它。</span>
systemctl status firewalld &amp;&gt; /dev/null 
<span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -eq 0 <span class="o">]</span>;
  <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"防火墙服务正在运行..."</span>
  <span class="k">else
    </span>systemctl start firewalld  
<span class="k">fi</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><strong>if 多分支</strong></p>

<blockquote>
  <p>[语法]</p>

  <p>if [ 条件语句1 ]; then</p>

  <p>​	代码</p>

  <p>elif [ 条件语句2 ]; then</p>

  <p>​	代码</p>

  <p>else</p>

  <p>​	代码</p>

  <p>fi</p>
</blockquote>

<h3 id="for-循环">for 循环</h3>

<blockquote>
  <p>[语法]</p>

  <p>for 变量名 in 取值列表
do
 	命令序列
done</p>
</blockquote>

<p><code class="language-plaintext highlighter-rouge">for</code>循环总是接收<code class="language-plaintext highlighter-rouge">in</code>语句之后的某种类型的字列表。在本例中，指定了四个英语单词，但是字列表也可以引用磁盘上的文件，甚至文件通配符。</p>

<p><em>for循环中用<code class="language-plaintext highlighter-rouge">seq</code>产生循环次数</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="k">for </span>x <span class="k">in</span> <span class="k">$(</span>seq 1 5<span class="k">)</span>; <span class="k">do </span><span class="nb">echo</span> <span class="nv">$x</span> ; <span class="k">done</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>传统方式: <code class="language-plaintext highlighter-rouge">i=1;i&lt;5;i++</code></em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="k">for</span> <span class="o">((</span> <span class="nv">i</span><span class="o">=</span>1; i&lt;<span class="o">=</span>5; i++ <span class="o">))</span>; <span class="k">do </span><span class="nb">echo</span> <span class="nv">$i</span>; <span class="k">done</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>for in 循环一堆空格分割的单词</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6</pre></td><td class="code"><pre><span class="k">for </span>y <span class="k">in </span>one two three four; <span class="k">do </span><span class="nb">echo </span>number <span class="nv">$y</span>; <span class="k">done</span>
<span class="c">#输出如下:</span>
<span class="c">#number one</span>
<span class="c">#number two</span>
<span class="c">#number three</span>
<span class="c">#number four</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>对目录中的文件做for循环</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre><span class="c"># for x in /var/log/*; do echo `basename $x` ; done # 不带绝对路径的文件名</span>
<span class="k">for </span>x <span class="k">in</span> /var/log/<span class="k">*</span>; <span class="k">do </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$x</span><span class="s2">"</span> ; <span class="k">done</span>  <span class="c"># 带绝对路径的文件名</span>
<span class="c">#输出目录下每个文件</span>
<span class="c">#/var/log/anaconda</span>
<span class="c">#/var/log/audit</span>
<span class="c">#/var/log/boot.log</span>
<span class="c">#...</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>循环获得执行脚本的所有参数</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>

<span class="k">for </span>attr <span class="k">in</span> <span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span>
<span class="k">do
   </span><span class="nb">echo </span>you typed <span class="k">${</span><span class="nv">attr</span><span class="k">}</span>.
<span class="k">done</span> 
<span class="c"># 命令执行: ./my.sh a b c d</span>
<span class="c">#输出</span>
<span class="c">#you typed a.</span>
<span class="c">#you typed b.</span>
<span class="c">#you typed c.</span>
<span class="c">#you typed d.</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="while-循环">while 循环</h3>

<p>重复测试指令的条件，只要条件为真则反复执行对应的命令操作，直到条件为假。如果使用<code class="language-plaintext highlighter-rouge">true</code>作为循环条件能够产生无限循环。</p>

<blockquote>
  <p>[语法]</p>

  <p>while 命令表达式
do
  命令列表
done</p>
</blockquote>

<p><em>批量添加20个系统账户用户名依次为user1~20</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>

<span class="nv">i</span><span class="o">=</span>1
<span class="k">while</span> <span class="o">[</span> <span class="nv">$i</span> -le 20 <span class="o">]</span>
<span class="k">do
    </span>useradd user<span class="nv">$i</span>
    <span class="nb">echo</span> <span class="s2">"123456"</span> | passwd --stdin user<span class="nv">$i</span> &amp;&gt; /dev/null 
    <span class="c"># --stdin从标准输入读取令牌(只有根用户才能进行此操作)</span>
    <span class="nv">i</span><span class="o">=</span><span class="sb">`</span>expr <span class="nv">$i</span> + 1<span class="sb">`</span>
<span class="k">done</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="until循环语句">until循环语句</h3>

<p>根据条件执行重复操作，直到条件成立为止。<code class="language-plaintext highlighter-rouge">Until</code>语句提供了与<code class="language-plaintext highlighter-rouge">while</code>语句相反的功能：只要特定条件为假，它们就重复循环，直到条件为真。</p>

<blockquote>
  <p>[语法]</p>

  <p>until 条件测试命令
do
​	 命令序列
done</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>
<span class="nv">myvar</span><span class="o">=</span>1
<span class="k">until</span> <span class="o">[</span> <span class="nv">$myvar</span> -gt 10 <span class="o">]</span>
<span class="k">do
	</span><span class="nb">echo</span> <span class="nv">$myvar</span>
	<span class="nv">myvar</span><span class="o">=</span><span class="k">$((</span> <span class="nv">$myvar</span> <span class="o">+</span> <span class="m">1</span> <span class="k">))</span>
	<span class="c"># myvar=`expr $myvar + 1` 也可以</span>
<span class="k">done</span> 
<span class="c"># 输出:</span>
<span class="c">#1</span>
<span class="c">#2</span>
<span class="c">#...</span>
<span class="c">#10</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="循环控制语句--break-continue">循环控制语句  <code class="language-plaintext highlighter-rouge">break, continue</code></h3>

<p><em>break语句</em>：在<code class="language-plaintext highlighter-rouge">for、while、until</code>等循环语句中，用于<em>跳出</em>当前所在的循环体, 循环体内剩下的操作不再执行.</p>

<p><em>continue语句</em>：在<code class="language-plaintext highlighter-rouge">for、while、until</code>等循环语句中，用于<em>跳过本次循环</em>体内<em>余下</em>的语句，重新判断条件以便执行下一次循环。</p>

<h3 id="case-多重分支">case 多重分支</h3>

<p>根据变量的不通取值，分别执行不同的命令操作</p>

<blockquote>
  <p>[语法]</p>

  <p>case 变量值 in
模式1)
​	 命令序列1
;;
模式2)
​	 命令序列2
;;
 ……
*)
​	 默认执行的命令序列
;;
esac</p>
</blockquote>

<p><em>通过用户输入的参数判断如何执行MySQL 的命令</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>

<span class="k">case</span> <span class="nv">$1</span> <span class="k">in
</span>start<span class="p">)</span>
    <span class="nb">echo</span> <span class="s2">"start mysql"</span>
<span class="p">;;</span>
stop<span class="p">)</span>
    <span class="nb">echo</span> <span class="s2">"stop mysql"</span>
<span class="p">;;</span>
<span class="k">*</span><span class="p">)</span>
    <span class="nb">echo</span> <span class="s2">"usage: </span><span class="nv">$0</span><span class="s2"> start|stop"</span>
<span class="p">;;</span>
<span class="k">esac</span>
<span class="c"># 执行 ./my.sh start</span>
<span class="c"># 输出: start mysql</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="shift-命令弹出第一个脚本参数"><code class="language-plaintext highlighter-rouge">shift</code> 命令弹出第一个脚本参数</h3>

<p>脚本获得多个参数, shift 将第一个参数弹出,其他前移</p>

<p>例如：若当前脚本程序获得的位置变量如下：</p>

<ul>
  <li>$1=file1、$2=file2、$3=file3、$4=file4</li>
  <li>shift # 执行shift 命令后, 参数变成如下</li>
  <li>$1=file2、$2=file3、$3=file4</li>
  <li>shift # 执行shift 命令后, 参数变成如下</li>
  <li>$1=file3、$2=file4</li>
</ul>

<p><em>对多个参数做加法</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>

<span class="nv">res</span><span class="o">=</span>0
<span class="k">while</span> <span class="o">[</span> <span class="nv">$# </span>-gt 0 <span class="o">]</span>
<span class="k">do
    </span><span class="nv">res</span><span class="o">=</span><span class="sb">`</span>expr <span class="nv">$res</span> + <span class="nv">$1</span><span class="sb">`</span>
    <span class="nb">shift
</span><span class="k">done
</span><span class="nb">echo</span> <span class="s2">"the sum is:</span><span class="nv">$res</span><span class="s2">"</span>
<span class="c">#执行: ./my.sh 1 2 3 4 5</span>
<span class="c">#输出: the sum is:15</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="exit-无条件终止退出脚本">exit 无条件终止(退出)脚本</h3>

<p>用于无条件终止当前脚本的执行. 若用在交互式shell中, 它将logout当前shell.</p>

<p>exit后经常带有一个数值参数, 表征退出状态: <code class="language-plaintext highlighter-rouge">exit n</code></p>

<ul>
  <li>n == 0            脚本执行成功</li>
  <li>n == 1~125   出错, 这些对应的错误值由用户在脚本中定义.</li>
  <li>n == 126        文件不可执行</li>
  <li>n == 127        不存在该命令</li>
  <li>n &gt;= 128        产生信号</li>
</ul>

<p>注意n处于1到125的情况, 这些错误值可以由用户自定义, 这就不需要使用类似C中errno这样的全局变量.
如果不给定n的值, 而直接使用exit, 那么返回exit之前最后一条语句的状态. 等效于”exit $?”.</p>

<p><em>检查本机是否可以连接外网(百度)</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10</pre></td><td class="code"><pre><span class="c">#!/usr/bin/env bash</span>
<span class="c"># 检查是否可以连接外网</span>
<span class="nv">pingres</span><span class="o">=</span><span class="sb">`</span>ping -c 1 baidu.com | sed -n <span class="s1">'/64 bytes from/p'</span><span class="sb">`</span>
<span class="k">if</span> <span class="o">[</span> -z <span class="s2">"</span><span class="nv">$pingres</span><span class="s2">"</span> <span class="o">]</span>;<span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"网络连接失败"</span>
    <span class="nb">exit </span>1
<span class="k">else
    </span><span class="nb">echo</span> <span class="s2">"网络连接成功"</span>
<span class="k">fi
</span><span class="nb">exit </span>0
</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="初始化-centos7-的shell-脚本实例20">初始化 Centos7 的SHELL 脚本实例2.0</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291</pre></td><td class="code"><pre><span class="c">#!/usr/bin/env bash</span>

<span class="c"># ===========================</span>
<span class="c"># = 作者: dalong</span>
<span class="c"># = 用途: 用于初始化 centos7 系统</span>
<span class="c"># = centos 版本: CentOS-7-x86_64-Minimal-1708.iso</span>
<span class="c"># = 脚本版本: v2.0</span>
<span class="c"># = 使用方法: 将本文件拷贝到 服务器的/root/code/目录下以root 身份执行.</span>
<span class="c"># = 安装内容包括</span>
<span class="c"># = 1.</span>
<span class="c"># ===========================</span>

<span class="c">#define EXIT_SUCCESS    0       /* Successful exit status.  */</span>
<span class="c">#define EXIT_FAILURE    1       /* Failing exit status.  */</span>
<span class="c">#define EX_NETWORKERR   64      /* 外网连接错误 */</span>


<span class="c">#define EX__MAX 78      /* maximum listed value */</span>


<span class="k">function </span>createDir<span class="o">(){</span>
    <span class="nb">local </span><span class="nv">flag</span><span class="o">=</span>1
    <span class="k">if</span> ! <span class="o">[</span> -d <span class="nv">$1</span> <span class="o">]</span>;<span class="k">then
        </span>mkdir /var/log/install
        <span class="nb">local </span><span class="nv">flag</span><span class="o">=</span>1
    <span class="k">fi
    return</span> <span class="nv">$flag</span>
<span class="o">}</span>

<span class="k">function </span>createFile<span class="o">(){</span>
    <span class="nb">local </span><span class="nv">flag</span><span class="o">=</span>1
    <span class="k">if</span> ! <span class="o">[</span> -f <span class="nv">$1$2</span> <span class="o">]</span>;<span class="k">then
        </span>touch <span class="nv">$1$2</span>
        <span class="nb">local </span><span class="nv">flag</span><span class="o">=</span>0
    <span class="k">fi
    return</span> <span class="nv">$flag</span>
<span class="o">}</span>

<span class="k">function </span>writeLog<span class="o">(){</span>
    <span class="nb">local </span><span class="nv">flag</span><span class="o">=</span>1
    <span class="k">if</span> <span class="o">[</span> -f <span class="nv">$1$2</span> <span class="o">]</span>;<span class="k">then
        </span><span class="nb">echo</span> <span class="nv">$3</span> &gt;&gt; <span class="nv">$1$2</span>
        <span class="nb">local </span><span class="nv">flag</span><span class="o">=</span>0
    <span class="k">fi
    return</span> <span class="nv">$flag</span>
<span class="o">}</span>



<span class="c"># 文件按照日期为文件名存放在 /var/log/install/目录下</span>
<span class="c"># 先判断目录是否存在, 不存在就创建</span>
<span class="c"># 判断log 文件是否存在,不存在就创建</span>

<span class="nv">logDir</span><span class="o">=</span>/var/log/install/
createDir <span class="nv">$logDir</span>

<span class="nv">filename</span><span class="o">=</span><span class="sb">`</span>date +<span class="s2">"%Y%m%d%H%I"</span><span class="sb">`</span>
createFile <span class="nv">$logDir</span> <span class="nv">$filename</span>


<span class="c"># 配置网卡配置文件并启动网络服务</span>
sed -i <span class="s1">'s/ONBOOT=no/ONBOOT=yes/g'</span> /etc/sysconfig/network-scripts/ifcfg-enp0s3
systemctl restart network.service
<span class="k">if</span> <span class="o">[</span> <span class="sb">`</span><span class="nb">echo</span> <span class="nv">$?</span><span class="sb">`</span> <span class="o">=</span> 0 <span class="o">]</span>;<span class="k">then
    </span>writeLog <span class="nv">$logDir</span> <span class="nv">$filename</span> <span class="s2">"网络重启成功"</span>
<span class="k">fi</span>

<span class="c"># 检查是否可以连接外网</span>
<span class="nv">pingres</span><span class="o">=</span><span class="sb">`</span>ping -c 1 baidu.com | sed -n <span class="s1">'/64 bytes from/p'</span><span class="sb">`</span>
<span class="k">if</span> <span class="o">[</span> -z <span class="s2">"</span><span class="nv">$pingres</span><span class="s2">"</span> <span class="o">]</span>;<span class="k">then
    </span>writeLog <span class="nv">$logDir</span> <span class="nv">$filename</span> <span class="s2">"外网连接失败"</span>
    <span class="nb">exit </span>64
<span class="k">else
    </span>writeLog <span class="nv">$logDir</span> <span class="nv">$filename</span> <span class="s2">"外网连接成功"</span>
<span class="k">fi</span>



<span class="c"># 更换 yum 源</span>
mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup
curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
yum clean all <span class="c"># 清理缓存</span>
yum makecache <span class="c"># 生成缓存</span>
yum -y update <span class="c"># 验证是否已经是aliyun</span>

<span class="c"># 为 yum 添加 epel 源 IUS 源</span>
yum install -y epel-release
yum install -y https://centos7.iuscommunity.org/ius-release.rpm
<span class="c"># 为 yum 下载加速</span>
yum install -y yum-axelget
<span class="c"># 为 centos 安装基础开发环境</span>
yum install -y gcc                     <span class="c"># C 编译器</span>
yum install -y gcc-c++                 <span class="c"># C++ 编译器</span>
yum install -y gcc-gfortran            <span class="c"># Fortran 编译器</span>
yum install -y compat-gcc-44           <span class="c"># 兼容 gcc 4.4</span>
yum install -y compat-gcc-44-c++       <span class="c"># 兼容 gcc-c++ 4.4</span>
yum install -y make
yum install -y gdb                     <span class="c"># 代码调试器</span>
yum install -y cmake                   <span class="c"># Cmake</span>
yum install -y git                     <span class="c"># 版本控制</span>
yum install -y ntfs-3g                 <span class="c"># CentOS 下默认无法挂载 NTFS 格式的硬盘。需安装 nfts-3g 即可实现即插即用</span>
yum install -y libxml2
yum install -y libxml2-devel -y
yum install -y libffi-devel

yum install -y man-pages
yum install -y vim-enhanced
yum install -y tree
yum install -y dosfstools  <span class="c"># 支持vfat 格式的格式化</span>
yum install -y wget
yum install -y mlocate
updatedb
locate inittab
yum install -y screen


<span class="c"># 设置登录欢迎信息</span>
<span class="o">(</span>
cat <span class="sh">&lt;&lt;'EOF'

                             ...~OOOOZO....
                          .$OOOOOOOOOOOOOOOO:.
                        .OOOZ???IIIIIIIIIIIOOOO.
                      .OOZ??..I7777777777II?I7OO.
                      ZOZ??.  .7777777777777??7OO.
                      OO??7.  .7IIIIIIIIIIII7??OO.
                      OO+?IIIIIIIIIIIIIIIIIII??OO.
                      OO+??????????????IIIIII??OO.
               .OOOOOOOOOOOOOOOOOOOOO??IIIIII?IOO.
            .,OOOOOOOOOOOOOOOOOOOOOOO??IIII?$IIOO..........
           .,OO++++++++++++++++++++++++?7$$$$IIOO7777777777..
           .OO++???????????$$$$$$$$$$$$$$$$$$IIOO77:::::::$77.
          .OO+++????+I7777777$$$$$$$$$$$$$$$$IIOO77::~~~~::77.
          .OO+++++77777777777$$$$$$$$$$$$$$$II$OO77::~~~~~::77.
         .OO==++7777777777777$$$$$$$$$$$$$$IIIOO77,,:~~~~~,:$7.
         .OO==77777777777$IIIIIIIIIIIIIIIIIIOOO77I,,:::::::,:77
          OO?I777777777$IIIIOOOOOOOOOOOOOOOOOO77=,,::::::::,,77.
         .OOII77777777IIIOOOO?77777777777777777,,,:::::::::,:77.
         .OOII$777777IIIOOO777777777777777$:,,,,::::::::::=::77.
          ~OOII777777IIOO777,,,,,,,,,,,,,,,,,,::::::::~+===:~77
          .OOII$7777IIOOI77,,,,,,,,,,,,,:===++++++========~:=77
          .ZO7II7777IIOO77,,,,,,,,,~+=++++++++++++++++++++~~77.
           .OOIIIIIIIIZO77,.,,,,=++++++++++++++++++++++++~~I77
            .OOOIIIIIIZO77..,,++++++++++++++++++++++++++~~~77.
             ..OOOOOOOOO77..++++++~~~~~~~~~~~~~~~~~~~~~~~~77..
                 .......77:~++++++~~77777777777777777777777.
                       .$7~~++++++~~~~~~~~~~~~~~~7$.......
                  ...,,,$7~~++++++~~~~~~~~~~~~~~~77,...
                .,,::~~=77~~+++++++++++++++..++~~77~::,,.
             ..,,:~~==++$7~~++++++++++++++.  .+~~77==~~:,,..
            ..,::~==++?I777~~=++++++++++++....~~77?++==~::,..
            .,,::~=++??I7777~~~~~~++++++=~~~~~7777??+==~::,,.
            ..,,:~~==+??I7777777~~~~~~~~~~+$7777I??+==~~:,,.
              ..,::~~==++??II7777777777777777I??++==~~::,..
                 ..,,::~~====++++?????????+++==~~~::,,..
                   . ...,,,:::::~~~~~~~~~:::::,,,... .
                            .. ........... ..

                                                    Dalong.com
EOF
</span><span class="o">)</span> &gt; /etc/motd

<span class="o">(</span>
cat <span class="sh">&lt;&lt;'EOF'
#!/bin/bash
echo -e "
##################################
#
# Welcome to `hostname`, you are logged in as `whoami`
# This system is running `cat /etc/redhat-release`
# kernel is `uname -r`
# Uptime is `uptime | sed 's/.*up ([^,]*), .*/1/'`
# Mem total `cat /proc/meminfo | grep MemTotal | awk {'print $2'}` kB
###################################"


EOF
</span><span class="o">)</span> &gt; /etc/profile.d/motd.sh



<span class="c"># MariaDB 安装</span>
<span class="o">(</span>
cat <span class="sh">&lt;&lt;'EOF'
[mariadb]
name = MariaDB
baseurl = http://yum.mariadb.org/10.1/centos7-amd64
gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB
gpgcheck=1
EOF
</span><span class="o">)</span> &gt; /etc/yum.repos.d/MariaDB.repo
yum install -y MariaDB-server MariaDB-client
systemctl start mysql.service
systemctl <span class="nb">enable </span>mysql.service

<span class="c"># mongodb 安装</span>
<span class="o">(</span>
cat <span class="sh">&lt;&lt;'EOF'
[mongodb-org-3.4]
name=MongoDB Repository
baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.4/x86_64/
gpgcheck=1
enabled=1
gpgkey=https://www.mongodb.org/static/pgp/server-3.4.asc
EOF
</span><span class="o">)</span> &gt; /etc/yum.repos.d/mongodb-org-3.4.repo
yum -y install mongodb-org
systemctl start mongod
systemctl <span class="nb">enable </span>mongod

<span class="c"># 安装redis</span>
yum install -y redis
systemctl start redis
systemctl <span class="nb">enable </span>redis.service

<span class="c"># 安装python</span>
yum install -y python36u
yum install -y python36u-pip

<span class="c"># Apache 服务安装</span>
yum install -y httpd
systemctl start httpd.service
systemctl <span class="nb">enable </span>httpd.service
firewall-cmd --permanent --add-service<span class="o">=</span>http

<span class="c"># 安装NTP 时间同步服务</span>
yum install -y chrony
systemctl start chronyd
systemctl status chronyd
systemctl <span class="nb">enable </span>chronyd  <span class="c"># 让chronyd 在开机的时候就自动启动</span>
timedatectl <span class="c"># 查看是否已经同步, yes 就是同步了.</span>

<span class="c"># 安装git</span>
yum install -y git

<span class="c"># Nginx 安装</span>
yum install -y nginx
sed -i <span class="s1">'s/listen       80 default_server/listen       8081 default_server/g'</span> /etc/nginx/nginx.conf
sed -i <span class="s1">'s/listen       \[::\]:80 default_server/listen       \[::\]:8081 default_server/g'</span> /etc/nginx/nginx.conf
systemctl start nginx.service
systemctl <span class="nb">enable </span>nginx.service



<span class="c"># 源码安装php7.2</span>
mkdir /root/code
mkdir /root/bin
<span class="nb">cd</span> /root/code
wget http://cn2.php.net/distributions/php-7.2.0.tar.gz
tar -zxvf php-7.2.0.tar.gz
<span class="nb">cd </span>php-7.2.0
./configure --prefix<span class="o">=</span>/usr/local/php7
make <span class="o">&amp;&amp;</span> make install
<span class="c"># 为命令创建软链接到 PATH 对应的目录下</span>
ln -s /usr/local/php7/bin/php /root/bin/php

<span class="c"># 安装python3.7</span>
<span class="nb">cd</span> /root/code
wget https://www.python.org/ftp/python/3.7.0/Python-3.7.0a3.tgz
tar -zxvf Python-3.7.0a3.tgz
<span class="nb">cd </span>Python-3.7.0a3
./configure --prefix<span class="o">=</span>/usr/local/python3.7
make <span class="o">&amp;&amp;</span> make install
ln -s /usr/local/python3.7/bin/python3.7 /root/bin/python3.7
ln -s /usr/local/python3.7/bin/pip3.7 /root/bin/pip3.7

<span class="c"># 升级 bash4.4</span>
<span class="nb">cd</span> /root/code
wget http://ftp.gnu.org/gnu/bash/bash-4.4.tar.gz
tar -zxvf bash-4.4.tar.gz
<span class="nb">cd </span>bash-4.4
./configure --prefix<span class="o">=</span>/usr/local/bash4.4
make <span class="o">&amp;&amp;</span> make install
mv /usr/bin/bash /usr/bin/bash.BAK
ln -s /usr/local/bash4.4/bin/bash /usr/bin/bash

<span class="c"># 让系统支持中文</span>
yum -y install kde-l10n-Chinese
yum -y reinstall glibc-common
yum clean all
localedef -c -f UTF-8 -i zh_CN zh_CN.utf8
cat /dev/null &gt; /etc/locale.conf <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"LC_ALL=</span><span class="se">\"</span><span class="s2">zh_CN.UTF-8</span><span class="se">\"</span><span class="s2">"</span> &gt; /etc/locale.conf

<span class="c"># 关闭安全设置</span>
setenforce 0
sed -i <span class="s1">'s/SELINUX=enforcing/SELINUX=disabled/g'</span> /etc/selinux/config
systemctl stop firewalld
systemctl disable firewalld


<span class="nb">exit </span>0
</pre></td></tr></tbody></table>
</div>
</div>

<p><em>初始化 Centos7 的SHELL 脚本实例1.0</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227</pre></td><td class="code"><pre><span class="c">#!/usr/bin/env bash</span>

<span class="c"># ===========================</span>
<span class="c"># = 作者: dalong</span>
<span class="c"># = 用途: 用于初始化 centos7 系统</span>
<span class="c"># = centos 版本: CentOS-7-x86_64-Minimal-1708.iso</span>
<span class="c"># = 脚本版本: v1.0</span>
<span class="c"># = 使用方法: 将本文件拷贝到 服务器的/root/code/目录下以root 身份执行.</span>
<span class="c"># = 安装内容包括</span>
<span class="c"># = 1.</span>
<span class="c"># ===========================</span>


<span class="c"># 配置网卡,能上网</span>
sed -i <span class="s1">'s/ONBOOT=no/ONBOOT=yes/g'</span> /etc/sysconfig/network-scripts/ifcfg-enp0s3
systemctl restart network.service

<span class="c"># 更换 yum 源</span>
mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup
curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
yum clean all <span class="c"># 清理缓存</span>
yum makecache <span class="c"># 生成缓存</span>
yum -y update <span class="c"># 验证是否已经是aliyun</span>

<span class="c"># 为 yum 添加 epel 源 IUS 源</span>
yum install -y epel-release
yum install -y https://centos7.iuscommunity.org/ius-release.rpm
<span class="c"># 为 yum 下载加速</span>
yum install -y yum-axelget
<span class="c"># 为 centos 安装基础开发环境</span>
yum install -y gcc                     <span class="c"># C 编译器</span>
yum install -y gcc-c++                 <span class="c"># C++ 编译器</span>
yum install -y gcc-gfortran            <span class="c"># Fortran 编译器</span>
yum install -y compat-gcc-44           <span class="c"># 兼容 gcc 4.4</span>
yum install -y compat-gcc-44-c++       <span class="c"># 兼容 gcc-c++ 4.4</span>
yum install -y make
yum install -y gdb                     <span class="c"># 代码调试器</span>
yum install -y cmake                   <span class="c"># Cmake</span>
yum install -y git                     <span class="c"># 版本控制</span>
yum install -y ntfs-3g                 <span class="c"># CentOS 下默认无法挂载 NTFS 格式的硬盘。需安装 nfts-3g 即可实现即插即用</span>
yum install -y libxml2
yum install -y libxml2-devel -y
yum install -y libffi-devel

yum install -y man-pages
yum install -y vim-enhanced
yum install -y tree
yum install -y dosfstools  <span class="c"># 支持vfat 格式的格式化</span>
yum install -y wget
yum install -y mlocate
updatedb
locate inittab
yum install -y screen


<span class="c"># 设置登录欢迎信息</span>
<span class="o">(</span>
cat <span class="sh">&lt;&lt;'EOF'

                             ...~OOOOZO....
                          .$OOOOOOOOOOOOOOOO:.
                        .OOOZ???IIIIIIIIIIIOOOO.
                      .OOZ??..I7777777777II?I7OO.
                      ZOZ??.  .7777777777777??7OO.
                      OO??7.  .7IIIIIIIIIIII7??OO.
                      OO+?IIIIIIIIIIIIIIIIIII??OO.
                      OO+??????????????IIIIII??OO.
               .OOOOOOOOOOOOOOOOOOOOO??IIIIII?IOO.
            .,OOOOOOOOOOOOOOOOOOOOOOO??IIII?$IIOO..........
           .,OO++++++++++++++++++++++++?7$$$$IIOO7777777777..
           .OO++???????????$$$$$$$$$$$$$$$$$$IIOO77:::::::$77.
          .OO+++????+I7777777$$$$$$$$$$$$$$$$IIOO77::~~~~::77.
          .OO+++++77777777777$$$$$$$$$$$$$$$II$OO77::~~~~~::77.
         .OO==++7777777777777$$$$$$$$$$$$$$IIIOO77,,:~~~~~,:$7.
         .OO==77777777777$IIIIIIIIIIIIIIIIIIOOO77I,,:::::::,:77
          OO?I777777777$IIIIOOOOOOOOOOOOOOOOOO77=,,::::::::,,77.
         .OOII77777777IIIOOOO?77777777777777777,,,:::::::::,:77.
         .OOII$777777IIIOOO777777777777777$:,,,,::::::::::=::77.
          ~OOII777777IIOO777,,,,,,,,,,,,,,,,,,::::::::~+===:~77
          .OOII$7777IIOOI77,,,,,,,,,,,,,:===++++++========~:=77
          .ZO7II7777IIOO77,,,,,,,,,~+=++++++++++++++++++++~~77.
           .OOIIIIIIIIZO77,.,,,,=++++++++++++++++++++++++~~I77
            .OOOIIIIIIZO77..,,++++++++++++++++++++++++++~~~77.
             ..OOOOOOOOO77..++++++~~~~~~~~~~~~~~~~~~~~~~~~77..
                 .......77:~++++++~~77777777777777777777777.
                       .$7~~++++++~~~~~~~~~~~~~~~7$.......
                  ...,,,$7~~++++++~~~~~~~~~~~~~~~77,...
                .,,::~~=77~~+++++++++++++++..++~~77~::,,.
             ..,,:~~==++$7~~++++++++++++++.  .+~~77==~~:,,..
            ..,::~==++?I777~~=++++++++++++....~~77?++==~::,..
            .,,::~=++??I7777~~~~~~++++++=~~~~~7777??+==~::,,.
            ..,,:~~==+??I7777777~~~~~~~~~~+$7777I??+==~~:,,.
              ..,::~~==++??II7777777777777777I??++==~~::,..
                 ..,,::~~====++++?????????+++==~~~::,,..
                   . ...,,,:::::~~~~~~~~~:::::,,,... .
                            .. ........... ..

                                                    Dalong.com
EOF
</span><span class="o">)</span> &gt; /etc/motd

<span class="o">(</span>
cat <span class="sh">&lt;&lt;'EOF'
#!/bin/bash
echo -e "
##################################
#
# Welcome to `hostname`, you are logged in as `whoami`
# This system is running `cat /etc/redhat-release`
# kernel is `uname -r`
# Uptime is `uptime | sed 's/.*up ([^,]*), .*/1/'`
# Mem total `cat /proc/meminfo | grep MemTotal | awk {'print $2'}` kB
###################################"


EOF
</span><span class="o">)</span> &gt; /etc/profile.d/motd.sh



<span class="c"># MariaDB 安装</span>
<span class="o">(</span>
cat <span class="sh">&lt;&lt;'EOF'
[mariadb]
name = MariaDB
baseurl = http://yum.mariadb.org/10.1/centos7-amd64
gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB
gpgcheck=1
EOF
</span><span class="o">)</span> &gt; /etc/yum.repos.d/MariaDB.repo
yum install -y MariaDB-server MariaDB-client
systemctl start mysql.service
systemctl <span class="nb">enable </span>mysql.service

<span class="c"># mongodb 安装</span>
<span class="o">(</span>
cat <span class="sh">&lt;&lt;'EOF'
[mongodb-org-3.4]
name=MongoDB Repository
baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.4/x86_64/
gpgcheck=1
enabled=1
gpgkey=https://www.mongodb.org/static/pgp/server-3.4.asc
EOF
</span><span class="o">)</span> &gt; /etc/yum.repos.d/mongodb-org-3.4.repo
yum -y install mongodb-org
systemctl start mongod
systemctl <span class="nb">enable </span>mongod

<span class="c"># 安装redis</span>
yum install -y redis
systemctl start redis
systemctl <span class="nb">enable </span>redis.service

<span class="c"># 安装python</span>
yum install -y python36u
yum install -y python36u-pip

<span class="c"># Apache 服务安装</span>
yum install -y httpd
systemctl start httpd.service
systemctl <span class="nb">enable </span>httpd.service
firewall-cmd --permanent --add-service<span class="o">=</span>http

<span class="c"># 安装NTP 时间同步服务</span>
yum install -y chrony
systemctl start chronyd
systemctl status chronyd
systemctl <span class="nb">enable </span>chronyd  <span class="c"># 让chronyd 在开机的时候就自动启动</span>
timedatectl <span class="c"># 查看是否已经同步, yes 就是同步了.</span>

<span class="c"># 安装git</span>
yum install -y git

<span class="c"># Nginx 安装</span>
yum install -y nginx
sed -i <span class="s1">'s/listen       80 default_server/listen       8081 default_server/g'</span> /etc/nginx/nginx.conf
sed -i <span class="s1">'s/listen       \[::\]:80 default_server/listen       \[::\]:8081 default_server/g'</span> /etc/nginx/nginx.conf
systemctl start nginx.service
systemctl <span class="nb">enable </span>nginx.service



<span class="c"># 源码安装php7.2</span>
mkdir /root/code
mkdir /root/bin
<span class="nb">cd</span> /root/code
wget http://cn2.php.net/distributions/php-7.2.0.tar.gz
tar -zxvf php-7.2.0.tar.gz
<span class="nb">cd </span>php-7.2.0
./configure --prefix<span class="o">=</span>/usr/local/php7
make <span class="o">&amp;&amp;</span> make install
<span class="c"># 为命令创建软链接到 PATH 对应的目录下</span>
ln -s /usr/local/php7/bin/php /root/bin/php

<span class="c"># 安装python3.7</span>
<span class="nb">cd</span> /root/code
wget https://www.python.org/ftp/python/3.7.0/Python-3.7.0a3.tgz
tar -zxvf Python-3.7.0a3.tgz
<span class="nb">cd </span>Python-3.7.0a3
./configure --prefix<span class="o">=</span>/usr/local/python3.7
make <span class="o">&amp;&amp;</span> make install
ln -s /usr/local/python3.7/bin/python3.7 /root/bin/python3.7
ln -s /usr/local/python3.7/bin/pip3.7 /root/bin/pip3.7

<span class="c"># 升级 bash4.4</span>
<span class="nb">cd</span> /root/code
wget http://ftp.gnu.org/gnu/bash/bash-4.4.tar.gz
tar -zxvf bash-4.4.tar.gz
<span class="nb">cd </span>bash-4.4
./configure --prefix<span class="o">=</span>/usr/local/bash4.4
make <span class="o">&amp;&amp;</span> make install
mv /usr/bin/bash /usr/bin/bash.BAK
ln -s /usr/local/bash4.4/bin/bash /usr/bin/bash

<span class="c"># 让系统支持中文</span>
yum -y install kde-l10n-Chinese
yum -y reinstall glibc-common
yum clean all
localedef -c -f UTF-8 -i zh_CN zh_CN.utf8
cat /dev/null &gt; /etc/locale.conf <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"LC_ALL=</span><span class="se">\"</span><span class="s2">zh_CN.UTF-8</span><span class="se">\"</span><span class="s2">"</span> &gt; /etc/locale.conf

<span class="c"># 关闭安全设置</span>
setenforce 0
sed -i <span class="s1">'s/SELINUX=enforcing/SELINUX=disabled/g'</span> /etc/selinux/config
systemctl stop firewalld
systemctl disable firewalld
</pre></td></tr></tbody></table>
</div>
</div>


            </div>

            <!-- Rating -->
            
            <div class="rating mb-4 d-flex align-items-center">
                <strong class="mr-1">Rating:</strong> <div class="rating-holder">
<div class="c-rating c-rating--regular" data-rating-value="4.5">
  <button>1</button>
  <button>2</button>
  <button>3</button>
  <button>4</button>
  <button>5</button>
</div>
</div>
            </div>
            

            <!-- Post Date -->
            <p>
            <small>
                <span class="post-date"><time class="post-date" datetime="2015-06-20">20 Jun 2015</time></span>           
                
                </small>
            </p>

            <!-- Post Categories -->
            <div class="after-post-cats">
                <ul class="tags mb-4">
                    
                    
                    <li>
                        <a class="smoothscroll" href="/categories#Linux">Linux</a>
                    </li>
                    
                </ul>
            </div>
            <!-- End Categories -->

            <!-- Post Tags -->
            <div class="after-post-tags">
                <ul class="tags">
                    
                    
                </ul>
            </div>
            <!-- End Tags -->

            <!-- Prev/Next -->
            <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
            
            
            <a class="next d-block col-md-6 text-lg-right" href="//Beginning-Python-From-Novice-to-Professional-Part-1/">Learning Python From Scratch (Part1) &raquo; </a>
            
            <div class="clearfix"></div>
            </div>
            <!-- End Categories -->

        </div>
        <!-- End Post -->

    </div>
</div>
<!-- End Article
================================================== -->

<!-- Begin Comments
================================================== -->

    <div class="container">
        <div id="comments" class="row justify-content-center mb-5">
            <div class="col-md-8">
                <section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'demowebsite'; 
        var disqus_developer = 0;
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = window.location.protocol + '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>

            </div>
        </div>
    </div>

<!--End Comments
================================================== -->

<!-- Review with LD-JSON, adapt it for your needs if you like, but make sure you test the generated HTML source code first: 
https://search.google.com/structured-data/testing-tool/u/0/
================================================== -->

<script type="application/ld+json">
{
  "@context": "http://schema.org/",
  "@type": "Review",
  "itemReviewed": {
    "@type": "Thing",
    "name": "Linux Command Basic"
  },
  "author": {
    "@type": "Person",
    "name": "Dalong"
  },
  "datePublished": "2015-06-20",
  "reviewRating": {
    "@type": "Rating",
    "ratingValue": "4.5",
    "bestRating": "5"
  }
}
</script>

</div>


    
</div>

<!-- Categories Jumbotron
================================================== -->
<div class="jumbotron fortags">
	<div class="d-md-flex h-100">
		<div class="col-md-4 transpdark align-self-center text-center h-100">
            <div class="d-md-flex align-items-center justify-content-center h-100">
                <h2 class="d-md-block align-self-center py-1 font-weight-light">Explore <span class="d-none d-md-inline">→</span></h2>
            </div>
		</div>
		<div class="col-md-8 p-5 align-self-center text-center">
            
            
                
                    <a class="mt-1 mb-1" href="/categories#Linux">Linux (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Python">Python (16)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Mysql">Mysql (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Redis">Redis (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#MongoDB">MongoDB (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Flask">Flask (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Django">Django (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#DjangoRest">DjangoRest (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Web-development">Web development (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Numpy">Numpy (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Panda">Panda (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Sklearn">Sklearn (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Jupyter">Jupyter (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#OpenCV">OpenCV (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#AI">AI (4)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Data-Science">Data Science (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Tensorflow">Tensorflow (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#ML">ML (3)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Microservice">Microservice (4)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Docker">Docker (4)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Rest-API">Rest API (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Container">Container (3)</a>
                
                    <a class="mt-1 mb-1" href="/categories#NLP">NLP (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#AWS">AWS (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Architecture">Architecture (3)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Database">Database (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Storage">Storage (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#DevOps">DevOps (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#IAM">IAM (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Cloud">Cloud (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#API">API (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Data-Migration">Data Migration (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Network">Network (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#YAML">YAML (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Security">Security (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#kubernetes">kubernetes (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Serverless">Serverless (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#CICD">CICD (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Agile">Agile (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Scrum">Scrum (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Design-Thinking">Design Thinking (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#GCP">GCP (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Google-Cloud-Platform">Google Cloud Platform (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#MLPS">MLPS (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#PIPL">PIPL (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#PII">PII (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#GDPR">GDPR (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Metaverse">Metaverse (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#VR">VR (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#AR">AR (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#XR">XR (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Togaf">Togaf (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Architecture-Thinking">Architecture Thinking (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#ChatGPT">ChatGPT (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#OpenAI">OpenAI (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#LLM">LLM (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Prompt">Prompt (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#DALL-E">DALL-E (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Azure">Azure (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#OCR">OCR (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Face-API">Face API (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Chat-Bot">Chat Bot (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Speech-Service">Speech Service (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Computer-Vision">Computer Vision (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Custom-Vision">Custom Vision (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Video-indexer">Video indexer (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Translator">Translator (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Cognitive-Search">Cognitive Search (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Knowledge-Base">Knowledge Base (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#ITIL">ITIL (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#IT">IT (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Jekyll">Jekyll (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Github">Github (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Liquid">Liquid (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Markdown">Markdown (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Node.js">Node.js (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Yarn">Yarn (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Nest.JS">Nest.JS (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Typescript">Typescript (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#javascript">javascript (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Restful-API">Restful API (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Postman">Postman (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Postgresql">Postgresql (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#TypeORM">TypeORM (1)</a>
                
            
            
		</div>
	</div>
</div>

<!-- Begin Footer
================================================== -->
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                Copyright © 2023 Dalong's personal blog 
            </div>
            <div class="col-md-6 col-sm-6 text-center text-lg-right">    
                <a target="_blank" href="#">Designed</a> by Dalong.work
            </div>
        </div>
    </div>
</footer>
<!-- End Footer
================================================== -->

</div> <!-- /.site-content -->

<!-- Scripts
================================================== -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

<script src="/assets/js/mediumish.js"></script>



<script src="/assets/js/ie10-viewport-bug-workaround.js"></script> 


<script id="dsq-count-scr" src="//demowebsite.disqus.com/count.js"></script>


</body>
</html>
